/* Copyright 2007-2017 by James Shelby, shelby (at:) dtsol.com; All rights reserved. */
var m=function e(t,n){var r="[object Object]",i="[object Array]",l="[object String]",a="function";var o={}.toString;var s=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,f=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/;var d=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;var c=function(){};var u,h,v,g;function m(e){u=e.document;h=e.location;g=e.cancelAnimationFrame||e.clearTimeout;v=e.requestAnimationFrame||e.setTimeout}m(t);function p(){var e=[].slice.call(arguments);var t=e[1]!=null&&o.call(e[1])===r&&!("tag"in e[1]||"view"in e[1])&&!("subtree"in e[1]);var n=t?e[1]:{};var a="class"in n?"class":"className";var d={tag:"div",attrs:{}};var c,u=[];if(o.call(e[0])!=l)throw new Error("selector in m(selector, attrs, children) should be a string");while(c=s.exec(e[0])){if(c[1]===""&&c[2])d.tag=c[2];else if(c[1]==="#")d.attrs.id=c[2];else if(c[1]===".")u.push(c[2]);else if(c[3][0]==="["){var h=f.exec(c[3]);d.attrs[h[1]]=h[3]||(h[2]?"":true)}}var v=t?e.slice(2):e.slice(1);if(v.length===1&&o.call(v[0])===i){d.children=v[0]}else{d.children=v}for(var g in n){if(n.hasOwnProperty(g)){if(g===a&&n[g]!=null&&n[g]!==""){u.push(n[g]);d.attrs[g]=""}else d.attrs[g]=n[g]}}if(u.length>0)d.attrs[a]=u.join(" ");return d}function y(e,t,s,f,h,v,g,m,C,E,k){try{if(h==null||h.toString()==null)h=""}catch(A){h=""}if(h.subtree==="retain")return v;var O=o.call(v),M=o.call(h);if(v==null||O!==M){if(v!=null){if(s&&s.nodes){var T=m-f;var j=T+(M===i?h:v.nodes).length;N(s.nodes.slice(T,j),s.slice(T,j))}else if(v.nodes)N(v.nodes,v)}v=new h.constructor;if(v.tag)v={};v.nodes=[]}if(M===i){for(var B=0,S=h.length;B<S;B++){if(o.call(h[B])===i){h=h.concat.apply([],h);B--;S=h.length}}var $=[],L=v.length===h.length,R=0;var D=1,H=2,I=3;var _={},F=false;for(var B=0;B<v.length;B++){if(v[B]&&v[B].attrs&&v[B].attrs.key!=null){F=true;_[v[B].attrs.key]={action:D,index:B}}}var G=0;for(var B=0,S=h.length;B<S;B++){if(h[B]&&h[B].attrs&&h[B].attrs.key!=null){for(var U=0,S=h.length;U<S;U++){if(h[U]&&h[U].attrs&&h[U].attrs.key==null)h[U].attrs.key="__mithril__"+G++}break}}if(F){var q=false;if(h.length!=v.length)q=true;else for(var B=0,J,V;J=v[B],V=h[B];B++){if(J.attrs&&V.attrs&&J.attrs.key!=V.attrs.key){q=true;break}}if(q){for(var B=0,S=h.length;B<S;B++){if(h[B]&&h[B].attrs){if(h[B].attrs.key!=null){var W=h[B].attrs.key;if(!_[W])_[W]={action:H,index:B};else _[W]={action:I,index:B,from:_[W].index,element:v.nodes[_[W].index]||u.createElement("div")}}}}var Y=[];for(var z in _)Y.push(_[z]);var Q=Y.sort(w);var X=new Array(v.length);X.nodes=v.nodes.slice();for(var B=0,Z;Z=Q[B];B++){if(Z.action===D){N(v[Z.index].nodes,v[Z.index]);X.splice(Z.index,1)}if(Z.action===H){var ee=u.createElement("div");ee.key=h[Z.index].attrs.key;e.insertBefore(ee,e.childNodes[Z.index]||null);X.splice(Z.index,0,{attrs:{key:h[Z.index].attrs.key},nodes:[ee]});X.nodes[Z.index]=ee}if(Z.action===I){if(e.childNodes[Z.index]!==Z.element&&Z.element!==null){e.insertBefore(Z.element,e.childNodes[Z.index]||null)}X[Z.index]=v[Z.from];X.nodes[Z.index]=Z.element}}v=X}}for(var B=0,te=0,S=h.length;B<S;B++){var ne=y(e,t,v,m,h[B],v[te],g,m+R||R,C,E,k);if(ne===n)continue;if(!ne.nodes.intact)L=false;if(ne.$trusted){R+=(ne.match(/<[^\/]|\>\s*[^<]/g)||[0]).length}else R+=o.call(ne)===i?ne.length:1;v[te++]=ne}if(!L){for(var B=0,S=h.length;B<S;B++){if(v[B]!=null)$.push.apply($,v[B].nodes)}for(var B=0,re;re=v.nodes[B];B++){if(re.parentNode!=null&&$.indexOf(re)<0)N([re],[v[B]])}if(h.length<v.length)v.length=h.length;v.nodes=$}}else if(h!=null&&M===r){var ie=[],le=[];while(h.view){var ae=h.view.$original||h.view;var oe=p.redraw.strategy()=="diff"&&v.views?v.views.indexOf(ae):-1;var se=oe>-1?v.controllers[oe]:new(h.controller||c);var W=h&&h.attrs&&h.attrs.key;h=P==0||v&&v.controllers&&v.controllers.indexOf(se)>-1?h.view(se):{tag:"placeholder"};if(h.subtree==="retain")return v;if(W){if(!h.attrs)h.attrs={};h.attrs.key=W}if(se.onunload)K.push({controller:se,handler:se.onunload});ie.push(ae);le.push(se)}if(!h.tag&&le.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");if(!h.attrs)h.attrs={};if(!v.attrs)v.attrs={};var fe=Object.keys(h.attrs);var de=fe.length>("key"in h.attrs?1:0);if(h.tag!=v.tag||fe.sort().join()!=Object.keys(v.attrs).sort().join()||h.attrs.id!=v.attrs.id||h.attrs.key!=v.attrs.key||p.redraw.strategy()=="all"&&(!v.configContext||v.configContext.retain!==true)||p.redraw.strategy()=="diff"&&v.configContext&&v.configContext.retain===false){if(v.nodes.length)N(v.nodes);if(v.configContext&&typeof v.configContext.onunload===a)v.configContext.onunload();if(v.controllers){for(var B=0,se;se=v.controllers[B];B++){if(typeof se.onunload===a)se.onunload({preventDefault:c})}}}if(o.call(h.tag)!=l)return;var re,ce=v.nodes.length===0;if(h.attrs.xmlns)E=h.attrs.xmlns;else if(h.tag==="svg")E="http://www.w3.org/2000/svg";else if(h.tag==="math")E="http://www.w3.org/1998/Math/MathML";if(ce){if(h.attrs.is)re=E===n?u.createElement(h.tag,h.attrs.is):u.createElementNS(E,h.tag,h.attrs.is);else re=E===n?u.createElement(h.tag):u.createElementNS(E,h.tag);v={tag:h.tag,attrs:de?x(re,h.tag,h.attrs,{},E):h.attrs,children:h.children!=null&&h.children.length>0?y(re,h.tag,n,n,h.children,v.children,true,0,h.attrs.contenteditable?re:C,E,k):h.children,nodes:[re]};if(le.length){v.views=ie;v.controllers=le;for(var B=0,se;se=le[B];B++){if(se.onunload&&se.onunload.$old)se.onunload=se.onunload.$old;if(P&&se.onunload){var ue=se.onunload;se.onunload=c;se.onunload.$old=ue}}}if(v.children&&!v.children.nodes)v.children.nodes=[];if(h.tag==="select"&&"value"in h.attrs)x(re,h.tag,{value:h.attrs.value},{},E);e.insertBefore(re,e.childNodes[m]||null)}else{re=v.nodes[0];if(de)x(re,h.tag,h.attrs,v.attrs,E);v.children=y(re,h.tag,n,n,h.children,v.children,false,0,h.attrs.contenteditable?re:C,E,k);v.nodes.intact=true;if(le.length){v.views=ie;v.controllers=le}if(g===true&&re!=null)e.insertBefore(re,e.childNodes[m]||null)}if(typeof h.attrs["config"]===a){var he=v.configContext=v.configContext||{};var ve=function(e,t){return function(){return e.attrs["config"].apply(e,t)}};k.push(ve(h,[re,!ce,he,v]))}}else if(typeof h!=a){var $;if(v.nodes.length===0){if(h.$trusted){$=b(e,m,h)}else{$=[u.createTextNode(h)];if(!e.nodeName.match(d))e.insertBefore($[0],e.childNodes[m]||null)}v="string number boolean".indexOf(typeof h)>-1?new h.constructor(h):h;v.nodes=$}else if(v.valueOf()!==h.valueOf()||g===true){$=v.nodes;if(!C||C!==u.activeElement){if(h.$trusted){N($,v);$=b(e,m,h)}else{if(t==="textarea")e.value=h;else if(C)C.innerHTML=h;else{if($[0].nodeType===1||$.length>1){N(v.nodes,v);$=[u.createTextNode(h)]}e.insertBefore($[0],e.childNodes[m]||null);$[0].nodeValue=h}}}v=new h.constructor(h);v.nodes=$}else v.nodes.intact=true}return v}function w(e,t){return e.action-t.action||e.index-t.index}function x(e,t,n,i,l){for(var s in n){var f=n[s];var d=i[s];if(!(s in i)||d!==f){i[s]=f;try{if(s==="config"||s=="key")continue;else if(typeof f===a&&s.indexOf("on")===0){e[s]=E(f,e)}else if(s==="style"&&f!=null&&o.call(f)===r){for(var c in f){if(d==null||d[c]!==f[c])e.style[c]=f[c]}for(var c in d){if(!(c in f))e.style[c]=""}}else if(l!=null){if(s==="href")e.setAttributeNS("http://www.w3.org/1999/xlink","href",f);else if(s==="className")e.setAttribute("class",f);else e.setAttribute(s,f)}else if(s in e&&!(s==="list"||s==="style"||s==="form"||s==="type"||s==="width"||s==="height")){if(t!=="input"||e[s]!==f)e[s]=f}else e.setAttribute(s,f)}catch(u){if(u.message.indexOf("Invalid argument")<0)throw u}}else if(s==="value"&&t==="input"&&e.value!=f){e.value=f}}return i}function N(e,t){for(var n=e.length-1;n>-1;n--){if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(r){}t=[].concat(t);if(t[n])C(t[n])}}if(e.length!=0)e.length=0}function C(e){if(e.configContext&&typeof e.configContext.onunload===a){e.configContext.onunload();e.configContext.onunload=null}if(e.controllers){for(var t=0,n;n=e.controllers[t];t++){if(typeof n.onunload===a)n.onunload({preventDefault:c})}}if(e.children){if(o.call(e.children)===i){for(var t=0,r;r=e.children[t];t++)C(r)}else if(e.children.tag)C(e.children)}}function b(e,t,n){var r=e.childNodes[t];if(r){var i=r.nodeType!=1;var l=u.createElement("span");if(i){e.insertBefore(l,r||null);l.insertAdjacentHTML("beforebegin",n);e.removeChild(l)}else r.insertAdjacentHTML("beforebegin",n)}else e.insertAdjacentHTML("beforeend",n);var a=[];while(e.childNodes[t]!==r){a.push(e.childNodes[t]);t++}return a}function E(e,t){return function(n){n=n||event;p.redraw.strategy("diff");p.startComputation();try{return e.call(t,n)}finally{F()}}}var k;var A={appendChild:function(e){if(k===n)k=u.createElement("html");if(u.documentElement&&u.documentElement!==e){u.replaceChild(e,u.documentElement)}else u.appendChild(e);this.childNodes=u.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]};var O=[],M={};p.render=function(e,t,r){var i=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var l=T(e);var a=e===u;var o=a||e===u.documentElement?A:e;if(a&&t.tag!="html")t={tag:"html",attrs:{},children:t};if(M[l]===n)N(o.childNodes);if(r===true)G(e);M[l]=y(o,null,n,n,t,M[l],false,0,null,n,i);for(var s=0,f=i.length;s<f;s++)i[s]()};p.trust=function(e){e=new String(e);e.$trusted=true;return e};function T(e){var t=O.indexOf(e);return t<0?O.push(e)-1:t}function j(e){var t=function(){if(arguments.length)e=arguments[0];return e};t.toJSON=function(){return e};return t}p.prop=j;var B=[],S=[],$=[],L=null,R=0,D=null,H=null,I=false,_,K=[];p.redraw=function(e){};p.redraw.strategy=p.prop();var P=0;p.startComputation=function(){P++};p.endComputation=function(){P=Math.max(P-1,0);if(P===0)p.redraw()};var F=function(){if(p.redraw.strategy()=="none"){P--;p.redraw.strategy("diff")}else p.endComputation()};function G(e){var t=T(e);N(e.childNodes,M[t]);M[t]=n}return p}(typeof window!="undefined"?window:{});if(typeof module!="undefined"&&module!==null&&module.exports)module.exports=m;else if(typeof define==="function"&&define.amd)define(function(){return m});
/*EpicCore*/(function(){"use strict";var t,n,e,r,i,u,o,l=[].slice,f=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e=function(n,r){var i,u,o,f,s,a,c,p,h,d,v,S,g,T,w,_,A,b,E,y,C,M,k,O,R,I,P,x,K,L,F,D,j,J,G,N,$,U,V,W,B,q,z,H,Q,X,Y,Z;J=!1,x=0,o={},u={},B={},V={},P=[],z={event:function(){},loadDirs:{}},i={},i.nextCounter=function(){return++x},i.opt=function(t){return U(z,t)},i.camelCase=function(t,n){return null==n&&(n="-"),t.toLowerCase().replace(new RegExp(n+"(.)","g"),function(t,n){return n.toUpperCase()})},X=function(t){return{}.toString.call(t)[8]},U=function(){var t,n,e,i,u,o,f,s,a,c,p,h;e=arguments[0],c=2<=arguments.length?l.call(arguments,1):[],s="O",t="A",h="U",p="S",n=0,u={},u[s]=function(t,n){var e,u;if(X(n)!==s)return r;for(u in n)e=i(t[u],n[u]),e!==r&&(t[u]=e);return r},u[t]=function(n,e){var u,o,l,f,s;if(X(e)!==t)return r;for(o=l=0,f=e.length;f>l;o=++l)s=e[o],u=i(n[o],s),u!==r&&(n[o]=u);return r},u[h]=function(n,e){var r;switch(X(e)){case s:r={},u[s](r,e);break;case t:r=[],u[t](r,e);break;default:r=e}return r},u[p]=function(t,n){return X(n)!==h?n:t},i=function(t,e){var r,i;return n++,i=X(t),i in u||(i=p),r=u[i](t,e),n--,r};for(o=0,f=c.length;f>o;o++)a=c[o],i(e,a);return e},i.login=function(){var t,n,e;e=[];for(t in B)n=B[t],e.push("function"==typeof n.eventLogin?n.eventLogin():void 0);return e},i.logout=function(t,n){return J!==!1?void setTimeout(function(){return function(){return i.logout(t,n)}}(this),100):t?v(t,n).then(function(){return L()}):L()},L=function(){var t,n,e;e=[];for(t in B)n=B[t],("function"==typeof n.eventLogout?n.eventLogout():void 0)&&(delete V[t],e.push(delete B[t]));return e},i.run=function(t,n,e){var r;P=t,U(z,n),i.oLoader=new u[z.loader](P),r=i.oLoader.D_loadAsync(),r.then(function(){return C(),U(z,n),$(),D(),Z(),G(),"function"==typeof e&&e(),i.App().go(d.go),i.oRender=new u[z.render]})},Q=function(t){var n,e,r;null!=t&&(V=t),r=[];for(e in B)r.push("function"==typeof(n=B[e]).restoreState?n.restoreState(V[e]):void 0);return r},j=function(){var t,n,e;V={};for(t in B)n=B[t],null!=n.saveState&&(e=n.saveState())&&(V[t]=e);return V},d={frames:{},modals:{},layout:"default",go:"default//"},p={},s={},c={"default":{start:"default",TRACKS:{"default":{start:"default",STEPS:{"default":{}}}}}},h={},a={},M=function(){},C=function(){var t,n,r,u,o,l,f,v,S,g,T,w;for(r=0,o=P.length;o>r;r++){f=P[r],e=null!=(g=i["app$"+f])?g:{},e.STEPS&&U(c["default"].TRACKS["default"].STEPS,e.STEPS),e.TRACKS&&U(c["default"].TRACKS,e.TRACKS),n={SETTINGS:d,MACROS:p,ACTIONS:s,FLOWS:c,MODELS:h,OPTIONS:z};for(f in n)S=n[f],U(S,e[f])}for(w in h)if(v=h[w],v.fists)for(T=v.fists,u=0,l=T.length;l>u;u++)t=T[u],a[t]=w},k=function(t,n){return h[t][n]},w=function(t){return a[t]},T=function(t,n,e,r,i){var u,o,l,f,s,a,p,h,d;if(o=c[t]){if(n&&null!=(f=null!=(s=o.TRACKS)?s[n]:void 0)){if(e&&null!=(l=null!=(a=f.STEPS)?a[e]:void 0)&&null!=(u=null!=(p=l[r])?p[i]:void 0))return u;if(null!=(u=null!=(h=f[r])?h[i]:void 0))return u}if(null!=(u=null!=(d=o[r])?d[i]:void 0))return u}return null},g=function(t,n,e,r){var i,u,o,l,f,s;if(u=c[t]){if(n&&null!=(l=null!=(f=u.TRACKS)?f[n]:void 0)){if(e&&null!=(o=null!=(s=l.STEPS)?s[e]:void 0)&&null!=(i=o[r]))return i;if(null!=(i=l[r]))return i}if(null!=(i=u[r]))return i}return null},_=function(t){return c[t]},E=function(t,n){return c[t].TRACKS[n]},A=function(t,n,e){return c[t].TRACKS[n].STEPS[e]},I=function(t){return _(t).start},R=function(t,n){return E(t,n).start},S=function(t,n){var e;return null!=(e=T(t[0],t[1],t[2],"ACTIONS",n))?e:s[n]},b=function(t,n,e,r){var i;return n&&null!=(i=g(n,e,null!=r?r:!1,t))?i:d[t]},y=function(t,n,e){var r;return r=U({},c[t].v,c[t].TRACKS[n].v,c[t].TRACKS[n].STEPS[e].v)},O=function(t,n){var e,r,i,u,o,l,f,s;for(r in c){e=c[r],i=e.TRACKS;for(s in i){f=i[s],u=f.STEPS;for(l in u)if(o=u[l],o[t]===n)return[r,s,l];if(f[t]===n)return[r,s,f.start]}if(e[t]===n)return[r,e.start,c[e.start].start]}return!1},$=function(){var t,n,e;n=[];for(e in h)t=h[e],n.push(function(t,n){return i[t]=function(e,u,o){var l,f;return l=n.inst,l in B||(B[l]=new i.Model[n["class"]](t,n.options),l in V&&B[l].restoreState(V[l])),f=B[l],e===r?f:u===r?f.getTable(e):f.action(e,u,o)}}(e,t));return n},v=function(t,n){var e,r,u;J=t,m.startComputation(),r=function(){return m.endComputation()},u=function(t){return i.App().setIssues(t[0]),i.App().setMessages(t[1]),J=!1};try{e=f(t,n,i.App().getStepPath())}finally{null!=(null!=e?e.then:void 0)?e.then(u).then(r,function(t){throw r(),t}):(setTimeout(r,0),null!=e&&u(e))}},f=function(n,e,r){var u,o,l,f,s,a,c,h,d,v;return d=new t("App"),v=new t("App"),h=U({},e),u=S(r,n),null==u?[d,v]:(f=function(t){var e,r,u,o,f,s,a,c,S,g,T,w,_,m,A,b,E,y,C,M,k,O,R,I,P,x,K,L;for(M=["fist","clear"],g=0,w=M.length;w>g;g++)if(L=M[g],L in t)if(f=t[L],s=null!=(k=i.fistDef[f].event)?k:"Fist","clear"===L)i[s]().fistClear(f,h.row);else if(i[s]().fistValidate(C={},f,h.row),i.merge(h,C),"SUCCESS"!==C.fist$success)return;for(E=function(){switch(X(t.pass)){case"A":return t.pass;case"S":return t.pass.split(",");default:return[]}}(),S=T=0,_=E.length;_>T;S=++T)b=E[S],b.indexOf(":")>-1&&(O=b.split(":"),A=O[0],r=O[1],h[r]=h[A],E[S]=A);R=t.set;for(b in R)P=R[b],h[b]=P;return null!=t["do"]?(c=t["do"].indexOf(".")<0)?l(p[t["do"]]):(I=t["do"].split("."),K=I[0],x=I[1],x=x?x:n,y=Promise.resolve(),C={},a=new i.Issue(K,x),m=new i.Issue(K,x),u={p:y,r:C,i:a,m:m},e=i[K](u,x,h),o=function(){var t;t=u.r;for(b in t)P=t[b],h[b]=P;return d.addObj(u.i),v.addObj(u.m)},null!=(null!=e?e.then:void 0)?e.then(o):o(e)):void 0},s=function(t){var n,e,r,u,o,f,s,a,c,p;for(null!=t.go&&i.App().go(t.go),f=null,null==t.next&&(t.next=[]),"A"!==X(t.next)&&(t.next=[t.next]),s=t.next,e=0,u=s.length;u>e;e++){if(n=s[e],!("when"in n)){f=n;break}if("default"===n.when){f=n;break}if("string"==typeof n.when&&n.when===(null!=(a=h.success)?a:h.ok)){f=n;break}o=!0,c=n.when;for(r in c)if(p=c[r],h[r]!==p){o=!1;break}if(o){f=n;break}}return f?l(f):void 0},l=function(t){var n,e;return n=f(t),e=function(){return s(t)},null!=(null!=n?n.then:void 0)?n.then(e):e(n)},o=l(u),a=function(){return[d,v]},c=function(t){throw new Error("BLOWUP:"+t.message)},null!=(null!=o?o.then:void 0)?o.then(a,c):a(o))},K={},F={},D=function(){var t,n,e,r,u,o,l;for(n=0,e=P.length;e>n;n++)r=P[n],t=null!=(o=i["fist$"+r])?o:{},t.FIELDS&&U(K,t.FIELDS),t.FISTS&&U(F,t.FISTS);for(r in F)u=F[r],u.fistNm=r;l=[];for(r in K)u=K[r],l.push(u.fieldNm=r);return l},N={},G=function(){var t,n,e,r,u,o;for(o=[],n=0,e=P.length;e>n;n++)r=P[n],t=null!=(u=i["issues$"+r])?u:{},o.push(U(N,t));return o},Y={},Z=function(){var t,n,e,r,u,o;for(u=[],t=0,n=P.length;n>t;t++)e=P[t],o=null!=(r=i["wist$"+e])?r:{},u.push(U(Y,o));return u},H={type_oau:X,Model:o,Extra:u,option:z,action:v,merge:U,getModelState:j,setModelState:Q,appGetF:_,appGetT:E,appGetS:A,appStartT:I,appStartS:R,appFindAction:S,appGetSetting:b,appGetVars:y,appFist:w,appFindAttr:g,appSearchAttr:O,fieldDef:K,fistDef:F,issueMap:N,wistDef:Y};for(W in H)q=H[W],i[W]=q;return i},t=function(){function t(t,n){this.t_view=t,this.t_action=n,this.issue_list=[]}return t.Make=function(n,e,r){var i;return i=new t(n),i.add(e,r),i},t.prototype.add=function(t,n){switch(typeof n){case"undefined":n=[];break;case"string":n=[n]}return this.issue_list.push({token:t,more:n,t_view:this.t_view,t_action:this.t_action})},t.prototype.addObj=function(t){var n,e,r,i,u;if("object"==typeof t&&"issue_list"in t)for(u=t.issue_list,e=0,r=u.length;r>e;e++)n=u[e],i=E.merge({},n),null==i.t_view&&(i.t_view=this.t_view),null==i.t_action&&(i.t_action=this.t_action),this.issue_list.push(i)},t.prototype.count=function(){return this.issue_list.length},t.prototype.asTable=function(){var t,n,e,r,i;for(t=[],i=this.issue_list,e=0,r=i.length;r>e;e++)n=i[e],t.push({view:n.t_view,action:n.t_action,token:n.token,title:n.t_view+"#"+n.t_action+"#"+n.token+"#"+n.more.join(","),issue:this.map(n.t_view,n.t_action,n.token,n.more)});return t},t.prototype.map=function(t,n,e,r){var i,u,o,l,f,s,a,c,p;if(f=E.issueMap,"object"!=typeof f)return"(no map) "+t+"#"+n+"#"+e+"#"+r.join(",");s=[],t in f&&(n in f[t]&&s.push(f[t][n]),"default"in f[t]&&s.push(f[t]["default"])),"default"in f&&(n in f["default"]&&s.push(f["default"][n]),"default"in f["default"]&&s.push(f["default"]["default"]));for(i=0,o=s.length;o>i;i++)for(p=s[i],a=p||[],u=0,l=a.length;l>u;u++)if(c=a[u],e.match(c[0]))return this.doMap(e,c[1],r,e);return"(no match)"+t+"#"+n+"#"+e+"#"+r.join(",")},t.prototype.doMap=function(t,n,e){var r;return r=n.replace(/%([0-9])(?::([0-9]))?%/g,function(n,r,i){return"0"===r?t:i?e[r-1]||e[i-1]||"":e[r-1]||""})},t}(),n=function(){function t(t,n,e){this.view_nm=t,this.options=n,this._ModelJS={ss:e||!1},this.restoreState(!1)}return t.prototype.getTable=function(t){return this.loadTableIf(t),this.Table[t]},t.prototype.loadTableIf=function(t){return t in this.Table?void 0:this.loadTable(t)},t.prototype.restoreState=function(t){var n;if(null!=this._ModelJS.ss)for(n in this._ModelJS.ss)delete this[n];return null!=this._ModelJS.ss&&E.merge(this,this._ModelJS.ss),t&&E.merge(this,t),this.Table={}},t.prototype.saveState=function(){var t,n,e;if(n=this._ModelJS.ss,!n)return!1;e={};for(t in n)this[t]!==n[t]&&(e[t]=this[t]);return E.merge({},e)},t.prototype.invalidateTables=function(t,n){var e,r,i,u;for(null==n&&(n=[]),t===!0&&(t=function(){var t;t=[];for(u in this.Table)f.call(n,u)>=0||t.push(u);return t}.call(this)),e=[],r=0,i=t.length;i>r;r++)u=t[r],u in this.Table&&(e.push(u),delete this.Table[u]);return E.View().invalidateTables(this.view_nm,t,e)},t}(),o="undefined"!=typeof window?window:{},o.EpicMvc=o.E=new e(o),u={Issue:t,ModelJS:n};for(i in u)r=u[i],o.E[i]=r;o._log2=function(){}}).call(this);
/*Base/app.coffee*/(function(){"use strict";var s;s=function(s,e,a,t){if(s==="click"||s==="enter"||s==="keyup"&&e.keyCode===27){if(!/event:Tab:Drop:/.test(t)){return E.Tab().event("Tab",s,"Drop","_CLEARED",{})}}};E.app$Base={OPTIONS:{render:"RenderStrategy$Base",dataAction:"dataAction$Base",event:s},MODELS:{App:{"class":"App$Base",inst:"iBaseApp"},View:{"class":"View$Base",inst:"iBaseView"},Fist:{"class":"Fist$Base",inst:"iBaseFist"},Tab:{"class":"Tab$Base",inst:"iBaseTab"},Wist:{"class":"Wist$Base",inst:"iBaseWist"}}}}).call(this);
/*Base/Model/App.coffee*/(function(){"use strict";var t,s=function(t,s){for(var i in s){if(e.call(s,i))t[i]=s[i]}function r(){this.constructor=t}r.prototype=s.prototype;t.prototype=new r;t.__super__=s.prototype;return t},e={}.hasOwnProperty;t=function(t){s(e,t);function e(t,s){var i;i={f:null,t:null,s:null,sp:[]};e.__super__.constructor.call(this,t,s,i);this.clear()}e.prototype.clear=function(){var t,s;if(((t=this.issues)!=null?t.count:void 0)!==0){this.issues=new E.Issue(this.view_nm);this.invalidateTables(["Issue"])}if(((s=this.messages)!=null?s.count:void 0)!==0){this.messages=new E.Issue(this.view_nm);return this.invalidateTables(["Message"])}};e.prototype.goTo=function(t,s,e){var i;i=this.f+"/"+this.t+"/"+this.s;this.f=t;this.t=s;this.s=e;if(i!==this.f+"/"+this.t+"/"+this.s){return this.invalidateTables(["V"])}};e.prototype.go=function(t){var s,e,i,r;e=t.split("/"),s=e[0],r=e[1],i=e[2];if(!s){s=this.f;if(!r){r=this.t}}if(!r){r=E.appStartT(s)}if(!i){i=E.appStartS(s,r)}return this.goTo(s,r,i)};e.prototype.appGet=function(t){return E.appGetSetting(t,this.f,this.t,this.s)};e.prototype.getStepPath=function(){return[this.f,this.t,this.s]};e.prototype.action=function(t,s,i){var r,a,u,n,o,p,h,l;p=t.r,a=t.i,u=t.m;switch(s){case"path":return this.go(i.path);case"push":return this.sp.push([this.f,this.t,this.s]);case"pop":if(this.sp.length){o=this.sp.pop();return this.goTo(o[0],o[1],o[2])}break;case"add_message":return u.add(i.type,i.msgs);case"add_issue":return a.add(i.type,i.msgs);case"clear":return this.clear();case"route":n=E.appSearchAttr("route",i.route);if(n===false){return p.success="FAIL"}else{this.goTo(n[0],n[1],n[2]);return p.success="SUCCESS"}break;case"parse_hash":h=i.hash.split("~"),l=h[0],r=h[1];if(r!=null){return E.merge(p,{type:"code",route:l,code:r})}else{n=E.appSearchAttr("route",l);if(n===false){p.success="FAIL";return E.merge(p,{type:"route",route:l})}else{return E.merge(p,{type:"path",route:l,path:n.join("/")})}}break;default:return e.__super__.action.call(this,t,s,i)}};e.prototype.setIssues=function(t){if((t!=null?t.count():void 0)!==0){this.issues.addObj(t)}return this.invalidateTables(["Issue"])};e.prototype.setMessages=function(t){if((t!=null?t.count():void 0)!==0){this.messages.addObj(t)}return this.invalidateTables(["Message"])};e.prototype.loadTable=function(t){var s;s=E["issues$"+this.appGet("group")];this.Table[t]=function(){switch(t){case"Message":return this.messages.asTable(s);case"Issue":return this.issues.asTable(s);case"V":return[E.appGetVars(this.f,this.t,this.s)];default:return e.__super__.loadTable.call(this,t)}}.call(this)};return e}(E.ModelJS);E.Model.App$Base=t}).call(this);
/*Base/Model/Fist.coffee*/(function(){"use strict";var e,t=function(e,t){for(var i in t){if(s.call(t,i))e[i]=t[i]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},s={}.hasOwnProperty;e=function(e){t(s,e);function s(e,t){this.fist={};s.__super__.constructor.call(this,e,t)}s.prototype.eventLogout=function(){return true};s.prototype.event=function(e,t,i,r,n){var f,l,u,a,o,h,c,p;if(e!=="Fist"){BLOWUP()}l=this._getFist(i,n.row,true);if(l===false){return}if(r){f=l.ht[r]}switch(t){case"keyup":case"change":if(f.type==="yesno"){if(n.val===false){n.val=f.cdata[1]}else{n.val=f.cdata[0]}}if(f.hval!==n.val){u=f.issue;f.hval=n.val;h=E.fistH2H(f,f.hval);E.fistVAL(f,h);if(t==="change"||u!==f.issue){a=true}}break;case"blur":p=f.hval;c=f.issue;f.hval=E.fistH2H(f,f.hval);E.fistVAL(f,f.hval);if(p!==f.hval||c!==f.issue){a=true}break;case"focus":if(l.fnm!==r){l.fnm=r}break;default:return s.__super__.event.call(this,e,t,i,r,n)}o=this.confirm(l,f,t);if(a||o){if(n.async!==true){this.invalidateTables([l.rnm])}else{delete this.Table[l.rnm]}}};s.prototype.confirm=function(e,t,s){var i,r,n,f,l,u,a;if(!(t.confirm!=null||t.confirm_src!=null)){return false}n=t.confirm_src!=null?t:e.ht[t.confirm];r=e.ht[n.confirm_src];if(n.issue!=null){if(r.issue!=null){delete r.issue;return true}return false}a=r.hval;if(a===""&&r.fieldNm!==t.fieldNm){return false}u=r.issue;l=E.fistH2H(n,a);f=E.fistH2H(n,n.hval);if(l===f){delete r.issue}else{i="FIELD_ISSUE"+(r.issue_text?"_TEXT":"");this._makeIssue(i,r)}return u!==r.issue};s.prototype._makeIssue=function(e,t){var s,i;i=e;if("A"!==E.type_oau(i)){i=[i,t.nm,(s=t.label)!=null?s:t.nm,t.issue_text]}t.issue=new E.Issue(t.fistNm,t.nm);return t.issue.add(i[0],i.slice(1))};s.prototype.fistClear=function(e,t){var s;s=e+(t?":"+t:"");if(s in this.fist){delete this.fist[s];return this.invalidateTables([s])}};s.prototype.fistValidate=function(e,t,s){var i,r,n,f,l,u,a,o,h,c,p,v;h=e;l=this._getFist(t,s);r=0;c=l.ht;for(f in c){n=c[f];u=E.fistH2H(n,n.hval);if(u!==n.hval){n.hval=u;a=true}if(true!==E.fistVAL(n,n.hval)){r++}}p=l.ht;for(f in p){n=p[f];if(n.confirm!=null){if(true===this.confirm(l,n,"fistValidate")){r++}}}if(r){a=true;h.fist$success="FAIL";h.fist$errors=r}else{h.fist$success="SUCCESS";i=h[l.nm]={};v=l.db;for(o in v){n=v[o];i[o]=E.fistH2D(n,n.hval)}}if(a===true){this.invalidateTables([l.rnm])}};s.prototype.loadTable=function(e){var t,s,i,r,n,f,l,u,a,o,h,c,p;h=e.split(":"),r=h[0],p=h[1];l=this._getFist(r,p);s={};t=[];i=false;c=l.sp.FIELDS;for(a=u=0,o=c.length;u<o;a=++u){f=c[a];n=l.ht[f];p=this._makeField(l,n,a,p);if(p.req){i=true}s[f]=[p];t.push(p)}return this.Table[e]=[{Field:[s],Control:t,any_req:i}]};s.prototype._makeField=function(e,t,s,i){var r,n,f,l,u,a,o,h,c;f={is_first:s===0,focus:e.fnm===t.nm,yes_val:"X",req:false,"default":"",width:"",size:"",issue:"",value:"",selected:false,name:t.nm};l=E.merge(f,t);a=l.type.split(":"),l.type=a[0],r=a[1];l.id="U"+E.nextCounter();l.value=t.hval;if(l.type==="yesno"){if(l.cdata==null){l.cdata=["1","0"]}l.yes_val=String(l.cdata[0]);if(l.value===l.yes_val){l.selected=true}else{l.value=l.cdata[1]}}if(t.issue){l.issue=t.issue.asTable()[0].issue}if(l.type==="radio"||l.type==="pulldown"){n=this._getChoices(r,e,t,i);h=[];c="";for(s=u=0,o=n.options.length;0<=o?u<o:u>o;s=0<=o?++u:--u){c=n.values[s]===String(l.value);h.push({option:n.options[s],value:n.values[s],selected:c});l.Choice=h}}return l};s.prototype._getFist=function(e,t,s){var i,r,n,f,l,u,a,o,h,c,p,v,d;d=e+(t?":"+t:"");if(!(d in this.fist)){if(s===true){return false}f={rnm:d,nm:e,row:t,ht:{},db:{},st:"new",sp:E.fistDef[e]};h=f.sp.FIELDS;for(l=0,u=h.length;l<u;l++){n=h[l];r=E.merge({},E.fieldDef[n],{nm:n,fistNm:e,row:t});r.h2h=function(){switch(E.type_oau(r.h2h)){case"S":return r.h2h.split(/[:,]/);case"A":return r.h2h;default:return[]}}();f.ht[n]=f.db[r.db_nm]=r}c=f.ht;for(n in c){o=c[n];if(o.confirm!=null){f.ht[o.confirm].confirm_src=n}}this.fist[d]=f}else{f=this.fist[d]}if(f.st==="new"){i=(p=E[E.appFist(e)]().fistGetValues(e,t))!=null?p:{};v=f.db;for(a in v){r=v[a];r.hval=E.fistD2H(r,i[a])}f.st="loaded"}return f};s.prototype._getChoices=function(e,t,s){var i,r,n,f,l,u,a,o,h,c,p,v,d,m;u=[];d=[];switch(e){case"array":o=s.cdata;for(i=0,n=o.length;i<n;i++){a=o[i];if(typeof a==="object"){u.push(String(a[1]));d.push(String(a[0]))}else{u.push(String(a));d.push(String(a))}}return{options:u,values:d};case"wist":h=s.cdata.split(":"),m=h[0],v=h[1],l=h[2];c=E.Wist(m);for(r=0,f=c.length;r<f;r++){p=c[r];u.push(p[l]);d.push(p[v])}return{options:u,values:d};case"custom":return E[E.appFist(t.nm)]().fistGetChoices(t.nm,s.nm,t.row)}};return s}(E.ModelJS);E.fistH2H=function(e,t){var s,i,r,n;t=E.fistH2H$pre(e,t);r=e.h2h;for(s=0,i=r.length;s<i;s++){n=r[s];t=E["fistH2H$"+n](e,t)}return t};E.fistH2H$pre=function(e,t){return t};E.fistH2D=function(e,t){if(e.h2d){return E["fistH2D$"+e.h2d](e,t)}else{return t}};E.fistD2H=function(e,t){var s;if(e.d2h){return E["fistD2H$"+e.d2h](e,t)}else{return(s=t!=null?t:e["default"])!=null?s:""}};E.fistVAL=function(e,t){var s,i,r,n,f;delete e.issue;s=true;if(t.length===0){if(e.req===true){s=e.req_text?["FIELD_EMPTY_TEXT",e.nm,(i=e.label)!=null?i:e.nm,e.req_text]:["FIELD_EMPTY",e.nm,(r=e.label)!=null?r:e.nm]}}else{if(e.validate){s=E["fistVAL$"+e.validate](e,t);if(s===false){s="FIELD_ISSUE"+(e.issue_text?"_TEXT":"")}}}if(s!==true){f=s;if("A"!==E.type_oau(f)){f=[f,e.nm,(n=e.label)!=null?n:e.nm,e.issue_text]}e.issue=new E.Issue(e.fistNm,e.nm);e.issue.add(f[0],f.slice(1))}return s===true};E.fistVAL$test=function(e,t){var s;s=e.validate_expr;if(typeof s==="string"){s=new RegExp(s)}return s.test(t)};E.Model.Fist$Base=e}).call(this);
/*Base/Model/Tab.coffee*/(function(){"use strict";var t,e=function(t,e){for(var a in e){if(r.call(e,a))t[a]=e[a]}function o(){this.constructor=t}o.prototype=e.prototype;t.prototype=new o;t.__super__=e.prototype;return t},r={}.hasOwnProperty;t=function(t){e(r,t);function r(t,e){r.__super__.constructor.call(this,t,e);this.tabs=E.merge({Modal:{backdrop:false}},e)}r.prototype.event=function(t,e,r,a,o){var i,s,l;s=this._getTab(r,a);e=(l=s.TYPE)!=null?l:r;switch(e.toUpperCase()){case"MODAL":i=this._toggleModal(s,a);break;case"DROP":case"COLLAPSE":i=this._toggleDrop(s,a);break;default:i=this._setTab(s,a)}if(i){return this.invalidateTables([r])}};r.prototype.action=function(t,e,a){var o,i,s,l;switch(e){case"toggle":this.event("Tab","click",a.group,a.item,a);break;case"clear_modal":s="Modal";i=this._getTab(s);o=false;for(l in i){if(l!=="backdrop"&&i[l]===true){i.backdrop=i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear_drop":s="Drop";i=this._getTab(s);o=false;for(l in i){if(i[l]===true){i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear":this.event("Tab","click",a.group,"_CLEARED",a);break;default:return r.__super__.action.call(this,t,e,a)}};r.prototype.loadTable=function(t){var e;e=this._getTab(t);return this.Table[t]=[e]};r.prototype._getTab=function(t,e){var r,a;if((r=this.tabs)[t]==null){r[t]={}}if(e!=null){if((a=this.tabs[t])[e]==null){a[e]=false}}return this.tabs[t]};r.prototype._toggleModal=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(a!=="backdrop"&&a!==e&&t[a]===true){r=true;t.backdrop=t[a]=false}}}else if(t[e]!==true){r=true;o=t.backdrop=t[e]=true;for(a in t){if(a!=="backdrop"&&a!==e&&t[a]===true){t[a]=false}}}return r};r.prototype._toggleDrop=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(a!==e&&t[a]===true){r=true;t[a]=false}}}else{r=true;o=t[e]=!t[e];if(o===true){for(a in t){if(a!==e&&t[a]===true){t[a]=false}}}}return r};r.prototype._setTab=function(t,e){var r;if(t[e]===true){return false}for(r in t){t[r]=false}t[e]=true;return true};return r}(E.ModelJS);E.Model.Tab$Base=t;E.ex$collapse=function(t,e,r,a,o,i){var s,l,n,u;u=a.split(":"),s=u[0],n=u[1];l=E.Tab(s)[0][n]?t.scrollHeight:0;return t.style.height=String(l)+"px"}}).call(this);
/*Base/Model/View.coffee*/(function(){"use strict";var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){for(var i in e){if(n.call(e,i))t[i]=e[i]}function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r;t.__super__=e.prototype;return t},n={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++){if(e in this&&this[e]===t)return e}return-1};t=function(t){i(n,t);function n(t,i){this.ex=e(this.ex,this);this.T_if=e(this.T_if,this);this.T_page=e(this.T_page,this);this.handleIt=e(this.handleIt,this);var r,s,o;n.__super__.constructor.call(this,t,i);r=E.appGetSetting("frames");this.frames=function(){var t,e,i,n;i=function(){var t;t=[];for(o in r){t.push(o)}return t}().sort();n=[];for(t=0,e=i.length;t<e;t++){s=i[t];n.push(r[s])}return n}();this.frames.push("X");this.did_run=false;this.in_run=false;window.oE=this;this.defer_it_cnt=0;this.start=false}n.prototype.nest_up=function(t){if(this.defer_it_cnt===0){if(this.in_run){BLOWUP()}this.in_run=true;this.defer_it={promise:null,resolve:null};this.defer_it.promise=new Promise(function(t){return function(e,i){return t.defer_it.resolve=e}}(this))}return this.defer_it_cnt++};n.prototype.nest_dn=function(t){if(this.defer_it_cnt>0){this.defer_it_cnt--}if(this.defer_it_cnt===0){this.in_run=false;return this.defer_it.resolve([this.modal,this.defer_content])}};n.prototype.run=function(){var t,e,i,n,r,s,o,a,l;l="R";n=E.App().getStepPath(),t=n[0],a=n[1],o=n[2];if(i=E.appFindAttr(t,a,o,"modal")){i=(r=E.appGetSetting("modals")[i])!=null?r:i}e=i!=null?i:E.appGetSetting("layout",t,a,o);this.N={};this.modal=i?true:false;this.page_name=(s=E.appGetS(t,a,o).page)!=null?s:o;this.did_run=true;this.frames[this.frames.length-1]=e;this.frame_inx=0;this.resetInfo();this.nest_up(l);this.defer_content=this.kids([["page",{}]]);this.nest_dn(l);return this.defer_it.promise};n.prototype.resetInfo=function(){this.R={};this.I={};this.P=[{}]};n.prototype.saveInfo=function(){var t;t=E.merge({},{I:this.I,P:this.P});return t};n.prototype.restoreInfo=function(t){var e,i;this.resetInfo();this.P=t.P;this.I=t.I;i=[];for(e in this.I){if(!(e in this.R)){i.push(this.R[e]=this._getMyRow(this.I[e]))}}return i};n.prototype._getMyRow=function(t){if(t.m!=null){return E[t.m](t.o)[t.c]}if(!(t.p in this.R)){this.R[t.p]=this._getMyRow(this.I[t.p])}if(t.p&&t.p in this.R){return this.R[t.p][t.o][t.c]}};n.prototype.getTable=function(t){var e,i,n,r,s;switch(t){case"If":return[this.N];case"Part":r={};s=this.P;for(e=0,i=s.length;e<i;e++){n=s[e];E.merge(r,n)}return[r];default:return[]}};n.prototype.invalidateTables=function(t,e,i){if(!(this.did_run&&i.length)){return}m.startComputation();m.endComputation()};n.prototype.handleIt=function(t){if(typeof t==="function"){t=t()}return t};n.prototype.formatFromSpec=function(t,e,i){var n,r,s,o;switch(e){case"":if(i){return E.custom_filter(t,i)}else{return t}break;case"count":return t!=null?t.length:void 0;case"bool":if(t){return true}else{return false}case"bytes":return window.bytesToSize(Number(t));case"uriencode":return encodeURIComponent(t);case"quo":return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"');case"1":return String(t)[0];case"lc":return String(t).toLowerCase();case"ucFirst":o=String(o).toLowerCase();return o.slice(0,1).toUpperCase()+o.slice(1);default:if(e[0]==="?"){r=e.slice(1).split("?"),n=r[0],s=r[1];return(t?n:s!=null?s:"").replace(new RegExp("[%]","g"),t)}}};n.prototype.v3=function(t,e,i,n,r){var s,o;s=E[t](e)[0];o=s[i];if(n!=null){return this.formatFromSpec(o,n,r)}else{return o}};n.prototype.v2=function(t,e,i,n){var r;if(e[0]==="_"){r=this.R[t]._[e.slice(1).toLowerCase()]}else{r=this.R[t][e]}if(i!=null){return this.formatFromSpec(r,i,n)}else{return r}};n.prototype.weed=function(t){var e,i,n;e={};for(i in t){n=t[i];if(i[0]!=="?"){e[i]=n}else{if(n){e[i.slice(1)]=n}}}return e};n.prototype.kids=function(t){var e,i,n,r,s,o,a;a="K";o=[];for(n=i=0,s=t.length;i<s;n=++i){r=t[n];if("A"===E.type_oau(r)){o.push(n);e=this["T_"+r[0]](r[1],r[2]);if(e!=null?e.then:void 0){this.nest_up(a);(function(t){return function(i){return e.then(function(e){o[i]=e;return t.nest_dn(a)},function(e){console.error("kids",e);o[i]=e.message;return t.nest_dn(a)})}})(this)(n)}else{o[n]=e}}else{o.push(r)}}return o};n.prototype.loadPartAttrs=function(t,e){var i,n,r;n={};for(i in t){r=t[i];if("data-e-"!==i.slice(0,7)){continue}n[e?i:i.slice(7)]=r}return n};n.prototype.T_page=function(t){var e,i,n;if(this.frame_inx<this.frames.length){e=E.oLoader.d_layout(i=this.frames[this.frame_inx++]);n=(this.frame_inx<this.frames.length?"Frame":"Layout")+"/"+i}else{e=E.oLoader.d_page(i=this.page_name);n="Page/"+i}return this.piece_handle(n,t!=null?t:{},e)};n.prototype.T_part=function(t){var e,i;i=t.part;e=E.oLoader.d_part(i);return this.piece_handle("Part/"+i,t,e,true)};n.prototype.piece_handle=function(t,e,i,n){var r,s,o;if(i!=null?i.then:void 0){return this.D_piece(t,e,i,n)}s=i.content,r=i.can_componentize;o=this.saveInfo();this.P.push(this.loadPartAttrs(e));s=this.handleIt(s);this.restoreInfo(o);return s};n.prototype.D_piece=function(t,e,i,n){var r,s,o;o="P";this.nest_up(o+t);s=this.saveInfo();r=i.then(function(i){return function(r){var a;try{if(r!=null?r.then:void 0){BLOWUP()}i.restoreInfo(s);a=i.piece_handle(t,e,r,n);return a}finally{i.nest_dn(o+t)}}}(this),function(i){return function(n){console.error("D_piece",n);i.nest_dn(o+t+" IN-ERROR");return typeof i._Err==="function"?i._Err("tag","page/part",e,n):void 0;throw n}}(this));return r};n.prototype.T_if_true=function(t,e){if(this.N[t.name]){return this.handleIt(e())}else{return""}};n.prototype.T_if_false=function(t,e){if(this.N[t.name]){return""}else{return this.handleIt(e)}};n.prototype.T_if=function(t,e){var i,n,s,o,a;n=false;i=false;if("val"in t){if("eq"in t){if(t.val===t.eq){i=true}}else if("ne"in t){if(t.val!==t.ne){i=true}}else if("gt"in t){if(t.val>t.gt){i=true}}else if("in_list"in t){if(s=t.val,r.call(t.in_list.split(","),s)>=0){i=true}}else if("not_in_list"in t){if(o=t.val,r.call(t.not_in_list.split(","),o)<0){i=true}}else{n=true}}else if("set"in t){i=t.set?true:false}else if("not_set"in t){i=t.not_set?false:true}else if("table_is_empty"in t){a=this._accessModelTable(t.table_is_empty,false);if(!a.length){i=true}}else if("table_is_not_empty"in t){a=this._accessModelTable(t.table_is_not_empty,false);if(a.length){i=true}}else{n=true}if(n){console.log("ISSUE T_if",t)}if("name"in t){this.N[t.name]=i}if(i&&e){return this.handleIt(e)}else{return""}};n.prototype._accessModelTable=function(t,e){var i,n,r,s,o,a;n=t.split("/"),i=n[0],r=n[1];if(i in this.R){a=this.R[i][r];o={p:i}}else{a=E[i](r);o={m:i}}if(e===false){return a}s=e!=null?e:r;if(a.length===0){return[a,s]}o.o=r;this.I[s]=o;return[a,s]};n.prototype.T_foreach=function(t,e){var i,n,r,s,o,a,l,u,f;o=this._accessModelTable(t.table,t.alias),f=o[0],l=o[1];if(f.length===0){return""}a=[];s="limit"in t?Number(t.limit)-1:f.length;for(i=n=0,r=f.length;n<r;i=++n){u=f[i];u=f[i];u._={count:i,first:i===0,last:i===s-1,"break":false};this.R[l]=u;this.I[l].c=i;a.push(this.handleIt(e))}delete this.I[l];delete this.R[l];return a};n.prototype.T_fist=function(t,e){var i,n,r,s,o,a,l,u,f,h,p,c,_,d,m,g,v,y,I;r=E.fistDef[t.fist];a=(u=r.event)!=null?u:"Fist";y=t.fist+(t.row!=null?":"+t.row:"");v=(f=(h=t.via)!=null?h:r.via)!=null?f:"Control";o="Fist";p=this._accessModelTable(a+"/"+y,o),I=p[0],g=p[1];this.R[g]=I[0];this.I[g].c=0;m=g;n=e?e:(l=(c=(_=t.part)!=null?_:r.part)!=null?c:"fist_default",t.part!=null?t.part:t.part=(d=r.part)!=null?d:"fist_default",function(e){return function(){return e.kids([["part",E.merge({part:l},e.loadPartAttrs(t,true))]])}}(this));s={table:o+"/"+v};if(t.alias!=null){s.alias=t.alias}i=this.T_foreach(s,n);delete this.R[m];delete this.I[m];return i};n.prototype.ex=function(t,e,i){var n,r,s,o,a,l,u,f,h,p,c,_;n=t.attributes;c=[];for(a=o=0,h=n.length;0<=h?o<h:o>h;a=0<=h?++o:--o){if(!("data-ex-"===n[a].name.slice(0,8))){continue}p=n[a].name.split("-"),r=p[0],s=p[1],l=p[2],u=p[3],f=p[4];_=n[a].value;c.push(E["ex$"+l](t,e,i,_,u,f))}return c};return n}(E.ModelJS);E.Model.View$Base=t}).call(this);
/*Base/Model/Wist.coffee*/(function(){"use strict";var t,i=function(t,i){for(var r in i){if(o.call(i,r))t[r]=i[r]}function n(){this.constructor=t}n.prototype=i.prototype;t.prototype=new n;t.__super__=i.prototype;return t},o={}.hasOwnProperty;t=function(t){i(o,t);function o(t,i){o.__super__.constructor.call(this,t,i);this.wist={}}o.prototype.loadTable=function(t){return this.Table[t]=this._getWist(t).table};o.prototype._getWist=function(t){var i,o,r,n;if(!(t in this.wist)){i=E.wistDef[t];n=[];for(o in i){r=i[o];r.token=String(o);n.push(r)}this.wist[t]={hash:i,table:n}}return this.wist[t]};return o}(E.ModelJS);E.Model.Wist$Base=t}).call(this);
/*Base/Extra/dataAction.coffee*/(function(){"use strict";var t,i=[].indexOf||function(t){for(var i=0,n=this.length;i<n;i++){if(i in this&&this[i]===t)return i}return-1};t=function(t,i,n){var e,f,r,c,l,a,s,u,o,v,h,p,k;if(typeof(f=E.option).activity==="function"){f.activity(t)}e=i.split(",");r=true;v=false;for(l=0,u=e.length;l<u;l++){o=e[l];h=o.split(":"),k=h[0],p=h[1],c=h[2],s=h[3],a=h[4];if(!p){p=k;k="click"}if(k==="event"){E.event(p,t,c,s,a,n)}if(r&&k===t){if(k==="click"||k==="rclick"){v=true}r=false;E.action(p,n)}}return v};E.Extra.dataAction$Base=t;E.event=function(t,n,e,f,r,c){var l,a;if(r!=="all"){l=r.split("-");if(i.call(l,n)<0){return}}if(t==="Fist"){t=(a=E.fistDef[e].event)!=null?a:t}return E[t]().event(t,n,e,f,c)}}).call(this);
/*Base/Extra/LoadStrategy.coffee*/(function(){"use strict";var t;t=function(){function t(t){var e;this.reverse_packages=function(){var r,o,a;a=[];for(e=r=o=t.length-1;o<=0?r<=0:r>=0;e=o<=0?++r:--r){a.push(t[e])}return a}()}t.prototype.getArtifact=function(t,e){var r,o,a,n,i,s,u,f;f=false;n=this.reverse_packages;for(r=0,o=n.length;r<o;r++){a=n[r];f=(i=(s=E["view$"+a])!=null?(u=s[e])!=null?u[t]:void 0:void 0)!=null?i:false;if(f!==false){break}}if(f===false){console.log("NO FILE FOUND! "+t)}return f};t.prototype.D_loadAsync=function(){return Promise.resolve()};t.prototype.d_layout=function(t){return this.getArtifact(t,"Layout")};t.prototype.d_page=function(t){return this.getArtifact(t,"Page")};t.prototype.d_part=function(t){return this.getArtifact(t,"Part")};return t}();E.Extra.LoadStrategy$Base=t;E.opt({loader:"LoadStrategy$Base"})}).call(this);
/*Base/Extra/RenderStrategy.coffee*/(function(){"use strict";var t,e,n,i=function(t,e){return function(){return t.apply(e,arguments)}};t=13;e=27;n=function(){function n(){this.m_redraw=i(this.m_redraw,this);this.onPopState=i(this.onPopState,this);this.handleEvent=i(this.handleEvent,this);var t,e,n;this.very_first=true;this.was_popped=false;this.was_modal=false;this.touchEndIsClick=false;this.touchBoundary=10;this.last_path="not_set";this.unloadMsgs={};this.baseUrl=window.document.location.pathname;this.baseId="epic-new-page";this.modalId="epic-new-modal";t=document.createElement("div");t.id=this.baseId;document.body.appendChild(t);e=document.createElement("div");e.id=this.modalId;document.body.appendChild(e);setTimeout(function(t){return function(){return t.onPopState(true)}}(this),0);window.onpopstate=this.onPopState;this.redraw_guard=0;n=m.redraw.strategy;m.redraw=this.m_redraw;m.redraw.strategy=n;this.init();true}n.prototype.handleEvent=function(n){var i,a,r,s,o,u,h,d,c,l,f,p,m,w,g,y,_,v,b,k,I,S;if(n==null){n=window.event}b=n.type;if(b==="input"){b="change"}if(b==="mousedown"){if(n.which===1||n.button===1){b="click"}else if(n.which===3||n.button===2){b="rclick"}else{return}}if(b==="keyup"&&n.keyCode===9){return}switch(b){case"keyup":switch(n.keyCode){case t:b="enter";break;case e:b="escape"}break;case"touchstart":v=event.targetTouches[0];this.touchEndIsClick=[v.pageX,v.pageY];return true;case"touchmove":if(this.touchEndIsClick!==false){m=this.touchEndIsClick,I=m[0],S=m[1];v=event.targetTouches[0];if(Math.abs(v.pageX-I)>this.touchBoundary||Math.abs(v.pageY-S)>this.touchBoundary){this.touchEndIsClick=false}}return true;case"touchend":if(this.touchEndIsClick!==false){b="click"}this.touchEndIsClick=false}_=n.target;if(_===window){return false}while(_.tagName!=="BODY"&&!(a=_.getAttribute("data-e-action"))){_=_.parentElement}E.option.event(b,n,_,a);if(!a){return false}r={};i=_.attributes;for(u=o=0,w=i.length;0<=w?o<w:o>w;u=0<=w?++o:--o){if(!("data-e-"===i[u].name.slice(0,7))){continue}if("action"===(c=i[u].name.slice(7))){continue}r[c]=i[u].value}k=_.value;if(_.type==="checkbox"&&_.checked===false){k=false}s=_.files;r.val=k;r._files=s;g=["touches","changedTouches","targetTouches"];for(h=0,d=g.length;h<d;h++){c=g[h];if(c in n){r[c]=n[c]}}l=_.getAttribute("data-params");if(l){y=JSON.parse(l);for(c in y){p=y[c];r[c]=p}}f=E.Extra[E.option.dataAction](b,a,r);if(f){n.preventDefault()}return false};n.prototype.init=function(){var t,e,n,i,a;n=["mousedown","dblclick","keyup","blur","focus","change","input","touchstart","touchmove","touchend"];a=[];for(e=0,i=n.length;e<i;e++){t=n[e];a.push(document.body.addEventListener(t,this.handleEvent,true))}return a};n.prototype.UnloadMessage=function(t,e){var n,i,a;if(e){this.unloadMsgs[t]=e}else{delete this.unloadMsgs[t]}n=function(){var t,e;t=this.unloadMsgs;e=[];for(i in t){a=t[i];e.push(a)}return e}.call(this);n=n.length?n.join("\n"):null;return window.onbeforeunload=function(){return n}};n.prototype.onPopState=function(t){if(t===true||!t.state){if(this.was_popped||!this.very_first){E.action("browser_rehash",{hash:location.hash.substr(1)});return}}this.was_popped=true;if(this.very_first){E.action("browser_hash",{hash:location.hash.substr(1)})}else{if(t.state){E.setModelState(t.state)}m.startComputation();m.endComputation();E.action("browser_navhash",{hash:location.hash.substr(1)})}};n.prototype.m_redraw=function(){this.redraw_guard++;if(this.redraw_guard!==1){return}return E.View().run().then(function(t){return function(e){var n,i;i=e[0],n=e[1];t.render(i,n);t.redraw_guard--;if(t.redraw_guard!==0){t.redraw_guard=0;return setTimeout(function(){return t.m_redraw()},16)}}}(this)).then(null,function(t){return function(t){return console.error("RenderStrategy$Base m_redraw",t)}}(this))};n.prototype.render=function(t,e){var n;if(t){m.render(n=document.getElementById(this.modalId),e)}else{if(this.was_modal){m.render(document.getElementById(this.modalId),[])}m.render(n=document.getElementById(this.baseId),m("div",{},e))}if(!t){this.handleRenderState()}this.was_modal=t;this.was_popped=false;this.very_first=false};n.prototype.handleRenderState=function(){var t,e,n,i,a,r,s,o,u;s=E.App().getStepPath();u=s.join("/");i=u===this.last_path?"replace":true;if(!i){return}n="";r=false;o=E.appFindAttr(s[0],s[1],s[2],"route");if(E.type_oau(o)==="O"&&"model"in o){r=E[o.model]().route(o)}if(typeof o==="string"){r=o}if(r!==false){n=r}a=E.getModelState();if(window.location.protocol!=="file:"){if(this.very_first||i==="replace"){if(typeof(t=window.history).replaceState==="function"){t.replaceState(a,n,"#"+n)}}else if(!this.was_popped&&i===true){if(typeof(e=window.history).pushState==="function"){e.pushState(a,n,"#"+n)}window.document.title=n}}this.last_path=u};return n}();E.Extra.RenderStrategy$Base=n}).call(this);
/*Base/Extra/RestAPI.coffee*/(function(){"use strict";var t;t=function(){function t(t){var e,o,r,n,s;this.opts={port:"",prefix:"",version:"",proto:"//",app_headers:{}};for(e in t){n=t[e];this.opts[e]=n}o=String(this.opts.port);if(o.length){o=":"+o}if(this.opts.prefix.length){r="/"+this.opts.prefix}if(this.opts.version.length){s="/"+this.opts.version}this.route_prefix=""+this.opts.proto+this.opts.host+(o!=null?o:"")+(r!=null?r:"")+(s!=null?s:"")+"/";this.SetToken(false)}t.prototype.GetPrefix=function(){return this.route_prefix};t.prototype.GetToken=function(){return this.token};t.prototype.SetToken=function(t){this.token=t};t.prototype.D_Request=function(t,e,o,r){var n,s,u;n=E.merge({},this.opts.app_headers,r!=null?r:{});u={code:false,text:false,ok:false};s=new Promise(function(r){return function(s,i){var p,a,f,h;h=new XMLHttpRequest;h.onloadend=function(t){var e,o;u.code=h.status;u.text=h.statusText;u.xhr=h;if(h.status===200){u.ok=true}if(!h.responseText.length){u.text="NetworkError";o='{"error":"NETWORK_ERROR"}'}else{o=h.responseText}e=JSON.parse(o);return s({status:u,data:e})};h.open(t,r.route_prefix+e);for(a in n){f=n[a];h.setRequestHeader(a,f)}p=new FormData;for(a in o){f=o[a];p.append(a,f)}return h.send(p)}}(this));return s.then(function(t){console.log(f,t);return t})};t.prototype.D_Get=function(t,e){return this.D_RequestAuth("GET",t,e)};t.prototype.D_Post=function(t,e){return this.D_RequestAuth("POST",t,e)};t.prototype.D_Del=function(t,e){return this.D_RequestAuth("DEL",t,e)};t.prototype.D_Put=function(t,e){return this.D_RequestAuth("PUT",t,e)};t.prototype.D_RequestAuth=function(t,e,o,r){var n,s;s=this.GetToken();if(s===false){setTimeout(function(){return E.action("Request.no_token")},0);return Promise.resolve({status:{code:401,text:"NO_TOKEN",ok:false},data:{error:"TOKEN"}})}n=E.merge({},this.opts.app_headers,r!=null?r:{});n.Authorization=s.token_type+" "+s.access_token;return this.D_Request(t,e,o,n).then(function(t){return function(t){if(t.status.code===401){setTimeout(function(){return E.action("Request.bad_token")},0);return{status:{code:401,text:"BAD_TOKEN",ok:false},data:{error:"TOKEN"}}}return t}}(this))};return t}();E.Extra.RestAPI$Base=t}).call(this);
E.view$Base={
Layout: {
"default":{preloaded:1,can_componentize:false,defer:0,content:function(){return oE.kids([['page',{}]])}}},
Page: {
"default":{preloaded:1,can_componentize:true,defer:0,content:function(){return [{tag:'b',attrs:{},children:['A Base Page']}]}}},
Part: {
}};

