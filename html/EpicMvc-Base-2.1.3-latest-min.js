/* Copyright 2007-2017 by James Shelby, shelby (at:) dtsol.com; All rights reserved. */
var m=function e(t,n){var r="[object Object]",o="[object Array]",a="[object String]",i="function";var l={}.toString;var s=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,f=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/;var u=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;var c=function(){};var d,h,v,p;function g(e){d=e.document;h=e.location;p=e.cancelAnimationFrame||e.clearTimeout;v=e.requestAnimationFrame||e.setTimeout}g(t);function m(){var e=[].slice.call(arguments);var t=e[1]!=null&&l.call(e[1])===r&&!("tag"in e[1]||"view"in e[1])&&!("subtree"in e[1]);var n=t?e[1]:{};var i="class"in n?"class":"className";var u={tag:"div",attrs:{}};var c,d=[];if(l.call(e[0])!=a)throw new Error("selector in m(selector, attrs, children) should be a string");while(c=s.exec(e[0])){if(c[1]===""&&c[2])u.tag=c[2];else if(c[1]==="#")u.attrs.id=c[2];else if(c[1]===".")d.push(c[2]);else if(c[3][0]==="["){var h=f.exec(c[3]);u.attrs[h[1]]=h[3]||(h[2]?"":true)}}var v=t?e.slice(2):e.slice(1);if(v.length===1&&l.call(v[0])===o){u.children=v[0]}else{u.children=v}for(var p in n){if(n.hasOwnProperty(p)){if(p===i&&n[p]!=null&&n[p]!==""){d.push(n[p]);u.attrs[p]=""}else u.attrs[p]=n[p]}}if(d.length>0)u.attrs[i]=d.join(" ");return u}function y(e,t,s,f,h,v,p,g,N,E,k){try{if(h==null||h.toString()==null)h=""}catch(T){h=""}if(h.subtree==="retain")return v;var j=l.call(v),O=l.call(h);if(v==null||j!==O){if(v!=null){if(s&&s.nodes){var A=g-f;var S=A+(O===o?h:v.nodes).length;C(s.nodes.slice(A,S),s.slice(A,S))}else if(v.nodes)C(v.nodes,v)}v=new h.constructor;if(v.tag)v={};v.nodes=[]}if(O===o){for(var M=0,R=h.length;M<R;M++){if(l.call(h[M])===o){h=h.concat.apply([],h);M--;R=h.length}}var B=[],I=v.length===h.length,L=0;var U=1,D=2,$=3;var q={},J=false;for(var M=0;M<v.length;M++){if(v[M]&&v[M].attrs&&v[M].attrs.key!=null){J=true;q[v[M].attrs.key]={action:U,index:M}}}var _=0;for(var M=0,R=h.length;M<R;M++){if(h[M]&&h[M].attrs&&h[M].attrs.key!=null){for(var G=0,R=h.length;G<R;G++){if(h[G]&&h[G].attrs&&h[G].attrs.key==null)h[G].attrs.key="__mithril__"+_++}break}}if(J){var K=false;if(h.length!=v.length)K=true;else for(var M=0,F,P;F=v[M],P=h[M];M++){if(F.attrs&&P.attrs&&F.attrs.key!=P.attrs.key){K=true;break}}if(K){for(var M=0,R=h.length;M<R;M++){if(h[M]&&h[M].attrs){if(h[M].attrs.key!=null){var V=h[M].attrs.key;if(!q[V])q[V]={action:D,index:M};else q[V]={action:$,index:M,from:q[V].index,element:v.nodes[q[V].index]||d.createElement("div")}}}}var W=[];for(var X in q)W.push(q[X]);var Y=W.sort(w);var Q=new Array(v.length);Q.nodes=v.nodes.slice();for(var M=0,Z;Z=Y[M];M++){if(Z.action===U){C(v[Z.index].nodes,v[Z.index]);Q.splice(Z.index,1)}if(Z.action===D){var ee=d.createElement("div");ee.key=h[Z.index].attrs.key;e.insertBefore(ee,e.childNodes[Z.index]||null);Q.splice(Z.index,0,{attrs:{key:h[Z.index].attrs.key},nodes:[ee]});Q.nodes[Z.index]=ee}if(Z.action===$){if(e.childNodes[Z.index]!==Z.element&&Z.element!==null){e.insertBefore(Z.element,e.childNodes[Z.index]||null)}Q[Z.index]=v[Z.from];Q.nodes[Z.index]=Z.element}}v=Q}}for(var M=0,te=0,R=h.length;M<R;M++){var ne=y(e,t,v,g,h[M],v[te],p,g+L||L,N,E,k);if(ne===n)continue;if(!ne.nodes.intact)I=false;if(ne.$trusted){L+=(ne.match(/<[^\/]|\>\s*[^<]/g)||[0]).length}else L+=l.call(ne)===o?ne.length:1;v[te++]=ne}if(!I){for(var M=0,R=h.length;M<R;M++){if(v[M]!=null)B.push.apply(B,v[M].nodes)}for(var M=0,re;re=v.nodes[M];M++){if(re.parentNode!=null&&B.indexOf(re)<0)C([re],[v[M]])}if(h.length<v.length)v.length=h.length;v.nodes=B}}else if(h!=null&&O===r){var oe=[],ae=[];while(h.view){var ie=h.view.$original||h.view;var le=m.redraw.strategy()=="diff"&&v.views?v.views.indexOf(ie):-1;var se=le>-1?v.controllers[le]:new(h.controller||c);var V=h&&h.attrs&&h.attrs.key;h=H==0||v&&v.controllers&&v.controllers.indexOf(se)>-1?h.view(se):{tag:"placeholder"};if(h.subtree==="retain")return v;if(V){if(!h.attrs)h.attrs={};h.attrs.key=V}if(se.onunload)z.push({controller:se,handler:se.onunload});oe.push(ie);ae.push(se)}if(!h.tag&&ae.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");if(!h.attrs)h.attrs={};if(!v.attrs)v.attrs={};var fe=Object.keys(h.attrs);var ue=fe.length>("key"in h.attrs?1:0);if(h.tag!=v.tag||fe.sort().join()!=Object.keys(v.attrs).sort().join()||h.attrs.id!=v.attrs.id||h.attrs.key!=v.attrs.key||m.redraw.strategy()=="all"&&(!v.configContext||v.configContext.retain!==true)||m.redraw.strategy()=="diff"&&v.configContext&&v.configContext.retain===false){if(v.nodes.length)C(v.nodes);if(v.configContext&&typeof v.configContext.onunload===i)v.configContext.onunload();if(v.controllers){for(var M=0,se;se=v.controllers[M];M++){if(typeof se.onunload===i)se.onunload({preventDefault:c})}}}if(l.call(h.tag)!=a)return;var re,ce=v.nodes.length===0;if(h.attrs.xmlns)E=h.attrs.xmlns;else if(h.tag==="svg")E="http://www.w3.org/2000/svg";else if(h.tag==="math")E="http://www.w3.org/1998/Math/MathML";if(ce){if(h.attrs.is)re=E===n?d.createElement(h.tag,h.attrs.is):d.createElementNS(E,h.tag,h.attrs.is);else re=E===n?d.createElement(h.tag):d.createElementNS(E,h.tag);v={tag:h.tag,attrs:ue?x(re,h.tag,h.attrs,{},E):h.attrs,children:h.children!=null&&h.children.length>0?y(re,h.tag,n,n,h.children,v.children,true,0,h.attrs.contenteditable?re:N,E,k):h.children,nodes:[re]};if(ae.length){v.views=oe;v.controllers=ae;for(var M=0,se;se=ae[M];M++){if(se.onunload&&se.onunload.$old)se.onunload=se.onunload.$old;if(H&&se.onunload){var de=se.onunload;se.onunload=c;se.onunload.$old=de}}}if(v.children&&!v.children.nodes)v.children.nodes=[];if(h.tag==="select"&&"value"in h.attrs)x(re,h.tag,{value:h.attrs.value},{},E);e.insertBefore(re,e.childNodes[g]||null)}else{re=v.nodes[0];if(ue)x(re,h.tag,h.attrs,v.attrs,E);v.children=y(re,h.tag,n,n,h.children,v.children,false,0,h.attrs.contenteditable?re:N,E,k);v.nodes.intact=true;if(ae.length){v.views=oe;v.controllers=ae}if(p===true&&re!=null)e.insertBefore(re,e.childNodes[g]||null)}if(typeof h.attrs["config"]===i){var he=v.configContext=v.configContext||{};var ve=function(e,t){return function(){return e.attrs["config"].apply(e,t)}};k.push(ve(h,[re,!ce,he,v]))}}else if(typeof h!=i){var B;if(v.nodes.length===0){if(h.$trusted){B=b(e,g,h)}else{B=[d.createTextNode(h)];if(!e.nodeName.match(u))e.insertBefore(B[0],e.childNodes[g]||null)}v="string number boolean".indexOf(typeof h)>-1?new h.constructor(h):h;v.nodes=B}else if(v.valueOf()!==h.valueOf()||p===true){B=v.nodes;if(!N||N!==d.activeElement){if(h.$trusted){C(B,v);B=b(e,g,h)}else{if(t==="textarea")e.value=h;else if(N)N.innerHTML=h;else{if(B[0].nodeType===1||B.length>1){C(v.nodes,v);B=[d.createTextNode(h)]}e.insertBefore(B[0],e.childNodes[g]||null);B[0].nodeValue=h}}}v=new h.constructor(h);v.nodes=B}else v.nodes.intact=true}return v}function w(e,t){return e.action-t.action||e.index-t.index}function x(e,t,n,o,a){for(var s in n){var f=n[s];var u=o[s];if(!(s in o)||u!==f){o[s]=f;try{if(s==="config"||s=="key")continue;else if(typeof f===i&&s.indexOf("on")===0){e[s]=E(f,e)}else if(s==="style"&&f!=null&&l.call(f)===r){for(var c in f){if(u==null||u[c]!==f[c])e.style[c]=f[c]}for(var c in u){if(!(c in f))e.style[c]=""}}else if(a!=null){if(s==="href")e.setAttributeNS("http://www.w3.org/1999/xlink","href",f);else if(s==="className")e.setAttribute("class",f);else e.setAttribute(s,f)}else if(s in e&&!(s==="list"||s==="style"||s==="form"||s==="type"||s==="width"||s==="height")){if(t!=="input"||e[s]!==f)e[s]=f}else e.setAttribute(s,f)}catch(d){if(d.message.indexOf("Invalid argument")<0)throw d}}else if(s==="value"&&t==="input"&&e.value!=f){e.value=f}}return o}function C(e,t){for(var n=e.length-1;n>-1;n--){if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(r){}t=[].concat(t);if(t[n])N(t[n])}}if(e.length!=0)e.length=0}function N(e){if(e.configContext&&typeof e.configContext.onunload===i){e.configContext.onunload();e.configContext.onunload=null}if(e.controllers){for(var t=0,n;n=e.controllers[t];t++){if(typeof n.onunload===i)n.onunload({preventDefault:c})}}if(e.children){if(l.call(e.children)===o){for(var t=0,r;r=e.children[t];t++)N(r)}else if(e.children.tag)N(e.children)}}function b(e,t,n){var r=e.childNodes[t];if(r){var o=r.nodeType!=1;var a=d.createElement("span");if(o){e.insertBefore(a,r||null);a.insertAdjacentHTML("beforebegin",n);e.removeChild(a)}else r.insertAdjacentHTML("beforebegin",n)}else e.insertAdjacentHTML("beforeend",n);var i=[];while(e.childNodes[t]!==r){i.push(e.childNodes[t]);t++}return i}function E(e,t){return function(n){n=n||event;m.redraw.strategy("diff");m.startComputation();try{return e.call(t,n)}finally{J()}}}var k;var T={appendChild:function(e){if(k===n)k=d.createElement("html");if(d.documentElement&&d.documentElement!==e){d.replaceChild(e,d.documentElement)}else d.appendChild(e);this.childNodes=d.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]};var j=[],O={};m.render=function(e,t,r){var o=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var a=A(e);var i=e===d;var l=i||e===d.documentElement?T:e;if(i&&t.tag!="html")t={tag:"html",attrs:{},children:t};if(O[a]===n)C(l.childNodes);if(r===true)K(e);O[a]=y(l,null,n,n,t,O[a],false,0,null,n,o);for(var s=0,f=o.length;s<f;s++)o[s]()};m.trust=function(e){e=new String(e);e.$trusted=true;return e};function A(e){var t=j.indexOf(e);return t<0?j.push(e)-1:t}function S(e){var t=function(){if(arguments.length)e=arguments[0];return e};t.toJSON=function(){return e};return t}m.prop=function(e){if((e!=null&&l.call(e)===r||typeof e===i)&&typeof e.then===i){return F(e)}return S(e)};var M=[],R=[],B=[],I=null,L=0,U=null,D=null,$=false,q,z=[];m.redraw=function(e){};m.redraw.strategy=m.prop();var H=0;m.startComputation=function(){H++};m.endComputation=function(){H=Math.max(H-1,0);if(H===0)m.redraw()};var J=function(){if(m.redraw.strategy()=="none"){H--;m.redraw.strategy("diff")}else m.endComputation()};function _(e,t){var a={};var i=[];for(var s in e){var f=t?t+"["+s+"]":s;var u=e[s];var c=l.call(u);var d=u===null?encodeURIComponent(f):c===r?_(u,f):c===o?u.reduce(function(e,t){if(!a[f])a[f]={};if(!a[f][t]){a[f][t]=true;return e.concat(encodeURIComponent(f)+"="+encodeURIComponent(t))}return e},[]).join("&"):encodeURIComponent(f)+"="+encodeURIComponent(u);if(u!==n)i.push(d)}return i.join("&")}function G(e){if(e.charAt(0)==="?")e=e.substring(1);var t=e.split("&"),n={};for(var r=0,a=t.length;r<a;r++){var i=t[r].split("=");var s=decodeURIComponent(i[0]);var f=i.length==2?decodeURIComponent(i[1]):null;if(n[s]!=null){if(l.call(n[s])!==o)n[s]=[n[s]];n[s].push(f)}else n[s]=f}return n}function K(e){var t=A(e);C(e.childNodes,O[t]);O[t]=n}m.deferred=function(){var e=new P;e.promise=F(e.promise);return e};function F(e,t){var n=m.prop(t);e.then(n);n.then=function(n,r){return F(e.then(n,r),t)};return n}function P(e,t){var n=1,o=2,a=3,s=4;var f=this,u=0,c=0,d=[];f["promise"]={};f["resolve"]=function(e){if(!u){c=e;u=n;p()}return this};f["reject"]=function(e){if(!u){c=e;u=o;p()}return this};f.promise["then"]=function(e,t){var n=new P(e,t);if(u===a){n.resolve(c)}else if(u===s){n.reject(c)}else{d.push(n)}return n.promise};function h(e){u=e||s;d.map(function(e){u===a&&e.resolve(c)||e.reject(c)})}function v(e,t,n,o){if((c!=null&&l.call(c)===r||typeof c===i)&&typeof e===i){try{var a=0;e.call(c,function(e){if(a++)return;c=e;t()},function(e){if(a++)return;c=e;n()})}catch(s){m.deferred.onerror(s);c=s;n()}}else{o()}}function p(){var r;try{r=c&&c.then}catch(l){m.deferred.onerror(l);c=l;u=o;return p()}v(r,function(){u=n;p()},function(){u=o;p()},function(){try{if(u===n&&typeof e===i){c=e(c)}else if(u===o&&typeof t==="function"){c=t(c);u=n}}catch(l){m.deferred.onerror(l);c=l;return h()}if(c===f){c=TypeError();h()}else{v(r,function(){h(a)},h,function(){h(u===n&&a)})}})}}m.deferred.onerror=function(e){if(l.call(e)==="[object Error]"&&!e.constructor.toString().match(/ Error/))throw e};function V(e){return e}function W(e){if(e.dataType&&e.dataType.toLowerCase()==="jsonp"){var r="mithril_callback_"+(new Date).getTime()+"_"+Math.round(Math.random()*1e16).toString(36);var o=d.createElement("script");t[r]=function(a){o.parentNode.removeChild(o);e.onload({type:"load",target:{responseText:a}});t[r]=n};o.onerror=function(a){o.parentNode.removeChild(o);e.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}});t[r]=n;return false};o.onload=function(e){return false};o.src=e.url+(e.url.indexOf("?")>0?"&":"?")+(e.callbackKey?e.callbackKey:"callback")+"="+r+"&"+_(e.data||{});d.body.appendChild(o)}else{var s=new t.XMLHttpRequest;s.open(e.method,e.url,true,e.user,e.password);s.onreadystatechange=function(){if(s.readyState===4){if(s.status>=200&&s.status<300)e.onload({type:"load",target:s});else e.onerror({type:"error",target:s})}};if(e.serialize===JSON.stringify&&e.data&&e.method!=="GET"){s.setRequestHeader("Content-Type","application/json; charset=utf-8")}if(e.deserialize===JSON.parse){s.setRequestHeader("Accept","application/json, text/*")}if(typeof e.config===i){var f=e.config(s,e);if(f!=null)s=f}var u=e.method==="GET"||!e.data?"":e.data;if(u&&(l.call(u)!=a&&u.constructor!=t.FormData)){throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`"}s.send(u);return s}}function X(e,t,n){if(e.method==="GET"&&e.dataType!="jsonp"){var r=e.url.indexOf("?")<0?"?":"&";var o=_(t);e.url=e.url+(o?r+o:"")}else e.data=n(t);return e}function Y(e,t){var n=e.match(/:[a-z]\w+/gi);if(n&&t){for(var r=0;r<n.length;r++){var o=n[r].slice(1);e=e.replace(n[r],t[o]);delete t[o]}}return e}m.request=function(e){if(e.background!==true)m.startComputation();var t=new P;var n=e.dataType&&e.dataType.toLowerCase()==="jsonp";var r=e.serialize=n?V:e.serialize||JSON.stringify;var a=e.deserialize=n?V:e.deserialize||JSON.parse;var i=n?function(e){return e.responseText}:e.extract||function(e){return e.responseText.length===0&&a===JSON.parse?null:e.responseText};e.method=(e.method||"GET").toUpperCase();e.url=Y(e.url,e.data);e=X(e,e.data,r);e.onload=e.onerror=function(n){try{n=n||event;var r=(n.type==="load"?e.unwrapSuccess:e.unwrapError)||V;var s=r(a(i(n.target,e)),n.target);if(n.type==="load"){if(l.call(s)===o&&e.type){for(var f=0;f<s.length;f++)s[f]=new e.type(s[f])}else if(e.type)s=new e.type(s)}t[n.type==="load"?"resolve":"reject"](s)}catch(n){m.deferred.onerror(n);t.reject(n)}if(e.background!==true)m.endComputation()};W(e);t.promise=F(t.promise,e.initialValue);return t.promise};m.deps=function(e){g(t=e||t);return t};m.deps.factory=e;m.Deferred=P;return m}(typeof window!="undefined"?window:{});if(typeof module!="undefined"&&module!==null&&module.exports)module.exports=m;else if(typeof define==="function"&&define.amd)define(function(){return m});
/*EpicCore*/(function(){"use strict";var t,n,e,r,i,u,o,l=[].slice,f=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e=function(n,r){var i,u,o,f,a,s,c,p,d,h,v,S,g,T,w,_,A,b,E,y,C,M,k,O,R,I,x,K,L,P,D,F,j,J,G,N,$,U,V,W,B,q,z,H,Q,X,Y,Z;J=!1,K=0,o={},u={},B={},V={},x=[],z={event:function(){},loadDirs:{}},i={},i.nextCounter=function(){return++K},i.opt=function(t){return U(z,t)},i.camelCase=function(t,n){return null==n&&(n="-"),t.toLowerCase().replace(new RegExp(n+"(.)","g"),function(t,n){return n.toUpperCase()})},X=function(t){return{}.toString.call(t)[8]},U=function(){var t,n,e,i,u,o,f,a,s,c,p,d;e=arguments[0],c=2<=arguments.length?l.call(arguments,1):[],a="O",t="A",d="U",p="S",n=0,u={},u[a]=function(t,n){var e,u;if(X(n)!==a)return r;for(u in n)e=i(t[u],n[u]),e!==r&&(t[u]=e);return r},u[t]=function(n,e){var u,o,l,f,a;if(X(e)!==t)return r;for(o=l=0,f=e.length;f>l;o=++l)a=e[o],u=i(n[o],a),u!==r&&(n[o]=u);return r},u[d]=function(n,e){var r;switch(X(e)){case a:r={},u[a](r,e);break;case t:r=[],u[t](r,e);break;default:r=e}return r},u[p]=function(t,n){return X(n)!==d?n:t},i=function(t,e){var r,i;return n++,i=X(t),i in u||(i=p),r=u[i](t,e),n--,r};for(o=0,f=c.length;f>o;o++)s=c[o],i(e,s);return e},i.login=function(){var t,n,e;e=[];for(t in B)n=B[t],e.push("function"==typeof n.eventLogin?n.eventLogin():void 0);return e},i.logout=function(t,n){return J!==!1?void setTimeout(function(){return function(){return i.logout(t,n)}}(this),100):t?v(t,n).then(function(){return P()}):P()},P=function(){var t,n,e;e=[];for(t in B)n=B[t],("function"==typeof n.eventLogout?n.eventLogout():void 0)&&(delete V[t],e.push(delete B[t]));return e},i.run=function(t,n,e){var r;x=t,U(z,n),i.oLoader=new u[z.loader](x),r=i.oLoader.D_loadAsync(),r.then(function(){return C(),U(z,n),$(),F(),Z(),G(),"function"==typeof e&&e(),i.App().go(h.go),i.oRender=new u[z.render]})},Q=function(t){var n,e,r;null!=t&&(V=t),r=[];for(e in B)r.push("function"==typeof(n=B[e]).restoreState?n.restoreState(V[e]):void 0);return r},j=function(){var t,n,e;V={};for(t in B)n=B[t],null!=n.saveState&&(e=n.saveState())&&(V[t]=e);return V},h={frames:{},modals:{},layout:"default",go:"default//"},p={},a={},c={"default":{start:"default",TRACKS:{"default":{start:"default",STEPS:{"default":{}}}}}},d={},s={},M=function(){},C=function(){var t,n,r,u,o,l,f,v,S,g,T,w;for(r=0,o=x.length;o>r;r++){f=x[r],e=null!=(g=i["app$"+f])?g:{},e.STEPS&&U(c["default"].TRACKS["default"].STEPS,e.STEPS),e.TRACKS&&U(c["default"].TRACKS,e.TRACKS),n={SETTINGS:h,MACROS:p,ACTIONS:a,FLOWS:c,MODELS:d,OPTIONS:z};for(f in n)S=n[f],U(S,e[f])}for(w in d)if(v=d[w],v.fists)for(T=v.fists,u=0,l=T.length;l>u;u++)t=T[u],s[t]=w},k=function(t,n){return d[t][n]},w=function(t){return s[t]},T=function(t,n,e,r,i){var u,o,l,f,a,s,p,d,h;if(o=c[t]){if(n&&null!=(f=null!=(a=o.TRACKS)?a[n]:void 0)){if(e&&null!=(l=null!=(s=f.STEPS)?s[e]:void 0)&&null!=(u=null!=(p=l[r])?p[i]:void 0))return u;if(null!=(u=null!=(d=f[r])?d[i]:void 0))return u}if(null!=(u=null!=(h=o[r])?h[i]:void 0))return u}return null},g=function(t,n,e,r){var i,u,o,l,f,a;if(u=c[t]){if(n&&null!=(l=null!=(f=u.TRACKS)?f[n]:void 0)){if(e&&null!=(o=null!=(a=l.STEPS)?a[e]:void 0)&&null!=(i=o[r]))return i;if(null!=(i=l[r]))return i}if(null!=(i=u[r]))return i}return null},_=function(t){return c[t]},E=function(t,n){return c[t].TRACKS[n]},A=function(t,n,e){return c[t].TRACKS[n].STEPS[e]},I=function(t){return _(t).start},R=function(t,n){return E(t,n).start},S=function(t,n){var e;return null!=(e=T(t[0],t[1],t[2],"ACTIONS",n))?e:a[n]},b=function(t,n,e,r){var i;return n&&null!=(i=g(n,e,null!=r?r:!1,t))?i:h[t]},y=function(t,n,e){var r;return r=U({},c[t].v,c[t].TRACKS[n].v,c[t].TRACKS[n].STEPS[e].v)},O=function(t,n){var e,r,i,u,o,l,f,a;for(r in c){e=c[r],i=e.TRACKS;for(a in i){f=i[a],u=f.STEPS;for(l in u)if(o=u[l],o[t]===n)return[r,a,l];if(f[t]===n)return[r,a,f.start]}if(e[t]===n)return[r,e.start,c[e.start].start]}return!1},$=function(){var t,n,e;n=[];for(e in d)t=d[e],n.push(function(t,n){return i[t]=function(e,u,o){var l,f;return l=n.inst,l in B||(B[l]=new i.Model[n["class"]](t,n.options),l in V&&B[l].restoreState(V[l])),f=B[l],e===r?f:u===r?f.getTable(e):f.action(e,u,o)}}(e,t));return n},v=function(t,n){var e,r,u;J=t,m.startComputation(),r=function(){return m.endComputation()},u=function(t){return i.App().setIssues(t[0]),i.App().setMessages(t[1]),J=!1};try{e=f(t,n,i.App().getStepPath())}finally{null!=(null!=e?e.then:void 0)?e.then(u).then(r,function(t){throw r(),t}):(setTimeout(r,0),null!=e&&u(e))}},f=function(n,e,r){var u,o,l,f,a,s,c,d,h,v;return h=new t("App"),v=new t("App"),d=U({},e),u=S(r,n),null==u?[h,v]:(f=function(t){var e,r,u,o,f,a,s,c,S,g,T,w,_,A,b,E,y,C,M,k,O,R,I,x,K,L,P,D;for(k=["fist","clear"],T=0,_=k.length;_>T;T++)if(D=k[T],D in t)if(a=t[D],s=null!=(O=i.fistDef[a].event)?O:"Fist","clear"===D)i[s]().fistClear(a,d.row);else if(i[s]().fistValidate(M={},a,d.row),i.merge(d,M),"SUCCESS"!==M.fist$success)return;for(C=function(){switch(X(t.pass)){case"A":return t.pass;case"S":return t.pass.split(",");default:return[]}}(),g=w=0,A=C.length;A>w;g=++w)y=C[g],y.indexOf(":")>-1&&(R=y.split(":"),E=R[0],r=R[1],d[r]=d[E],C[g]=E);I=t.set;for(y in I)K=I[y],d[y]=K;return null!=t["do"]?(S=t["do"].indexOf(".")<0)?l(p[t["do"]]):(x=t["do"].split("."),P=x[0],L=x[1],L=L?L:n,o=new m.Deferred,M={},c=new i.Issue(P,L),b=new i.Issue(P,L),u={d:o,r:M,i:c,m:b},e=i[P](u,L,d),f=function(){var t;t=u.r;for(y in t)K=t[y],d[y]=K;return h.addObj(u.i),v.addObj(u.m)},null!=(null!=e?e.then:void 0)?e.then(f):f(e)):void 0},a=function(t){var n,e,r,u,o,f,a,s,c,p;for(null!=t.go&&i.App().go(t.go),f=null,null==t.next&&(t.next=[]),"A"!==X(t.next)&&(t.next=[t.next]),a=t.next,e=0,u=a.length;u>e;e++){if(n=a[e],!("when"in n)){f=n;break}if("default"===n.when){f=n;break}if("string"==typeof n.when&&n.when===(null!=(s=d.success)?s:d.ok)){f=n;break}o=!0,c=n.when;for(r in c)if(p=c[r],d[r]!==p){o=!1;break}if(o){f=n;break}}return f?l(f):void 0},l=function(t){var n,e;return n=f(t),e=function(){return a(t)},null!=(null!=n?n.then:void 0)?n.then(e):e(n)},o=l(u),s=function(){return[h,v]},c=function(t){throw new Error("BLOWUP:"+t.message)},null!=(null!=o?o.then:void 0)?o.then(s,c):s(o))},L={},D={},F=function(){var t,n,e,r,u,o,l;for(n=0,e=x.length;e>n;n++)r=x[n],t=null!=(o=i["fist$"+r])?o:{},t.FIELDS&&U(L,t.FIELDS),t.FISTS&&U(D,t.FISTS);for(r in D)u=D[r],u.fistNm=r;l=[];for(r in L)u=L[r],l.push(u.fieldNm=r);return l},N={},G=function(){var t,n,e,r,u,o;for(o=[],n=0,e=x.length;e>n;n++)r=x[n],t=null!=(u=i["issues$"+r])?u:{},o.push(U(N,t));return o},Y={},Z=function(){var t,n,e,r,u,o;for(u=[],t=0,n=x.length;n>t;t++)e=x[t],o=null!=(r=i["wist$"+e])?r:{},u.push(U(Y,o));return u},H={type_oau:X,Model:o,Extra:u,option:z,action:v,merge:U,getModelState:j,setModelState:Q,appGetF:_,appGetT:E,appGetS:A,appStartT:I,appStartS:R,appFindAction:S,appGetSetting:b,appGetVars:y,appFist:w,appFindAttr:g,appSearchAttr:O,fieldDef:L,fistDef:D,issueMap:N,wistDef:Y};for(W in H)q=H[W],i[W]=q;return i},t=function(){function t(t,n){this.t_view=t,this.t_action=n,this.issue_list=[]}return t.Make=function(n,e,r){var i;return i=new t(n),i.add(e,r),i},t.prototype.add=function(t,n){switch(typeof n){case"undefined":n=[];break;case"string":n=[n]}return this.issue_list.push({token:t,more:n,t_view:this.t_view,t_action:this.t_action})},t.prototype.addObj=function(t){var n,e,r,i,u;if("object"==typeof t&&"issue_list"in t)for(u=t.issue_list,e=0,r=u.length;r>e;e++)n=u[e],i=E.merge({},n),null==i.t_view&&(i.t_view=this.t_view),null==i.t_action&&(i.t_action=this.t_action),this.issue_list.push(i)},t.prototype.count=function(){return this.issue_list.length},t.prototype.asTable=function(){var t,n,e,r,i;for(t=[],i=this.issue_list,e=0,r=i.length;r>e;e++)n=i[e],t.push({view:n.t_view,action:n.t_action,token:n.token,title:n.t_view+"#"+n.t_action+"#"+n.token+"#"+n.more.join(","),issue:this.map(n.t_view,n.t_action,n.token,n.more)});return t},t.prototype.map=function(t,n,e,r){var i,u,o,l,f,a,s,c,p;if(f=E.issueMap,"object"!=typeof f)return"(no map) "+t+"#"+n+"#"+e+"#"+r.join(",");a=[],t in f&&(n in f[t]&&a.push(f[t][n]),"default"in f[t]&&a.push(f[t]["default"])),"default"in f&&(n in f["default"]&&a.push(f["default"][n]),"default"in f["default"]&&a.push(f["default"]["default"]));for(i=0,o=a.length;o>i;i++)for(p=a[i],s=p||[],u=0,l=s.length;l>u;u++)if(c=s[u],e.match(c[0]))return this.doMap(e,c[1],r,e);return"(no match)"+t+"#"+n+"#"+e+"#"+r.join(",")},t.prototype.doMap=function(t,n,e){var r;return r=n.replace(/%([0-9])(?::([0-9]))?%/g,function(n,r,i){return"0"===r?t:i?e[r-1]||e[i-1]||"":e[r-1]||""})},t}(),n=function(){function t(t,n,e){this.view_nm=t,this.options=n,this._ModelJS={ss:e||!1},this.restoreState(!1)}return t.prototype.getTable=function(t){return this.loadTableIf(t),this.Table[t]},t.prototype.loadTableIf=function(t){return t in this.Table?void 0:this.loadTable(t)},t.prototype.restoreState=function(t){var n;if(null!=this._ModelJS.ss)for(n in this._ModelJS.ss)delete this[n];return null!=this._ModelJS.ss&&E.merge(this,this._ModelJS.ss),t&&E.merge(this,t),this.Table={}},t.prototype.saveState=function(){var t,n,e;if(n=this._ModelJS.ss,!n)return!1;e={};for(t in n)this[t]!==n[t]&&(e[t]=this[t]);return E.merge({},e)},t.prototype.invalidateTables=function(t,n){var e,r,i,u;for(null==n&&(n=[]),t===!0&&(t=function(){var t;t=[];for(u in this.Table)f.call(n,u)>=0||t.push(u);return t}.call(this)),e=[],r=0,i=t.length;i>r;r++)u=t[r],u in this.Table&&(e.push(u),delete this.Table[u]);return E.View().invalidateTables(this.view_nm,t,e)},t}(),o="undefined"!=typeof window?window:{},o.EpicMvc=o.E=new e(o),u={Issue:t,ModelJS:n};for(i in u)r=u[i],o.E[i]=r;o._log2=function(){}}).call(this);
/*Base/app.coffee*/(function(){var s;s=function(s,e,a,i){if(s==="click"||s==="enter"||s==="keyup"&&e.keyCode===27){if(!/event:Tab:Drop:/.test(i)){return E.Tab().event("Tab",s,"Drop","_CLEARED",{})}}};E.app$Base={OPTIONS:{render:"RenderStrategy$Base",dataAction:"dataAction$Base",event:s},MODELS:{App:{"class":"App$Base",inst:"iBaseApp"},View:{"class":"View$Base",inst:"iBaseView"},Fist:{"class":"Fist$Base",inst:"iBaseFist"},Tab:{"class":"Tab$Base",inst:"iBaseTab"},Wist:{"class":"Wist$Base",inst:"iBaseWist"}}}}).call(this);
/*Base/Model/App.coffee*/(function(){"use strict";var t,s=function(t,s){for(var i in s){if(e.call(s,i))t[i]=s[i]}function r(){this.constructor=t}r.prototype=s.prototype;t.prototype=new r;t.__super__=s.prototype;return t},e={}.hasOwnProperty;t=function(t){s(e,t);function e(t,s){var i;i={f:null,t:null,s:null,sp:[]};e.__super__.constructor.call(this,t,s,i);this.clear()}e.prototype.clear=function(){var t,s;if(((t=this.issues)!=null?t.count:void 0)!==0){this.issues=new E.Issue(this.view_nm);this.invalidateTables(["Issue"])}if(((s=this.messages)!=null?s.count:void 0)!==0){this.messages=new E.Issue(this.view_nm);return this.invalidateTables(["Message"])}};e.prototype.goTo=function(t,s,e){var i;i=this.f+"/"+this.t+"/"+this.s;this.f=t;this.t=s;this.s=e;if(i!==this.f+"/"+this.t+"/"+this.s){return this.invalidateTables(["V"])}};e.prototype.go=function(t){var s,e,i,r;e=t.split("/"),s=e[0],r=e[1],i=e[2];if(!s){s=this.f;if(!r){r=this.t}}if(!r){r=E.appStartT(s)}if(!i){i=E.appStartS(s,r)}return this.goTo(s,r,i)};e.prototype.appGet=function(t){return E.appGetSetting(t,this.f,this.t,this.s)};e.prototype.getStepPath=function(){return[this.f,this.t,this.s]};e.prototype.action=function(t,s,i){var r,a,u,n,o,p,h,l;p=t.r,a=t.i,u=t.m;switch(s){case"path":return this.go(i.path);case"push":return this.sp.push([this.f,this.t,this.s]);case"pop":if(this.sp.length){o=this.sp.pop();return this.goTo(o[0],o[1],o[2])}break;case"add_message":return u.add(i.type,i.msgs);case"add_issue":return a.add(i.type,i.msgs);case"clear":return this.clear();case"route":n=E.appSearchAttr("route",i.route);if(n===false){return p.success="FAIL"}else{this.goTo(n[0],n[1],n[2]);return p.success="SUCCESS"}break;case"parse_hash":h=i.hash.split("~"),l=h[0],r=h[1];if(r!=null){return E.merge(p,{type:"code",route:l,code:r})}else{n=E.appSearchAttr("route",l);if(n===false){p.success="FAIL";return E.merge(p,{type:"route",route:l})}else{return E.merge(p,{type:"path",route:l,path:n.join("/")})}}break;default:return e.__super__.action.call(this,t,s,i)}};e.prototype.setIssues=function(t){if((t!=null?t.count():void 0)!==0){this.issues.addObj(t)}return this.invalidateTables(["Issue"])};e.prototype.setMessages=function(t){if((t!=null?t.count():void 0)!==0){this.messages.addObj(t)}return this.invalidateTables(["Message"])};e.prototype.loadTable=function(t){var s;s=E["issues$"+this.appGet("group")];this.Table[t]=function(){switch(t){case"Message":return this.messages.asTable(s);case"Issue":return this.issues.asTable(s);case"V":return[E.appGetVars(this.f,this.t,this.s)];default:return e.__super__.loadTable.call(this,t)}}.call(this)};return e}(E.ModelJS);E.Model.App$Base=t}).call(this);
/*Base/Model/Fist.coffee*/(function(){"use strict";var e,t=function(e,t){for(var i in t){if(s.call(t,i))e[i]=t[i]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},s={}.hasOwnProperty;e=function(e){t(s,e);function s(e,t){this.fist={};s.__super__.constructor.call(this,e,t)}s.prototype.eventLogout=function(){return true};s.prototype.event=function(e,t,i,r,n){var l,f,u,a,o,h,c,p;if(e!=="Fist"){BLOWUP()}f=this._getFist(i,n.row);if(r){l=f.ht[r]}switch(t){case"keyup":case"change":if(l.type==="yesno"){if(n.val===false){n.val=l.cdata[1]}else{n.val=l.cdata[0]}}if(l.hval!==n.val){u=l.issue;l.hval=n.val;h=E.fistH2H(l,l.hval);E.fistVAL(l,h);if(t==="change"||u!==l.issue){a=true}}break;case"blur":p=l.hval;c=l.issue;l.hval=E.fistH2H(l,l.hval);E.fistVAL(l,l.hval);if(p!==l.hval||c!==l.issue){a=true}break;case"focus":if(f.fnm!==r){f.fnm=r}break;default:return s.__super__.event.call(this,e,t,i,r,n)}o=this.confirm(f,l,t);if(a||o){if(n.async!==true){this.invalidateTables([f.rnm])}else{delete this.Table[f.rnm]}}};s.prototype.confirm=function(e,t,s){var i,r,n,l,f,u,a;if(!(t.confirm!=null||t.confirm_src!=null)){return false}n=t.confirm_src!=null?t:e.ht[t.confirm];r=e.ht[n.confirm_src];if(n.issue!=null){if(r.issue!=null){delete r.issue;return true}return false}a=r.hval;if(a===""&&r.fieldNm!==t.fieldNm){return false}u=r.issue;f=E.fistH2H(n,a);l=E.fistH2H(n,n.hval);if(f===l){delete r.issue}else{i="FIELD_ISSUE"+(r.issue_text?"_TEXT":"");this._makeIssue(i,r)}return u!==r.issue};s.prototype._makeIssue=function(e,t){var s,i;i=e;if("A"!==E.type_oau(i)){i=[i,t.nm,(s=t.label)!=null?s:t.nm,t.issue_text]}t.issue=new E.Issue(t.fistNm,t.nm);return t.issue.add(i[0],i.slice(1))};s.prototype.fistClear=function(e,t){var s;s=e+(t?":"+t:"");if(s in this.fist){delete this.fist[s];return this.invalidateTables([s])}};s.prototype.fistValidate=function(e,t,s){var i,r,n,l,f,u,a,o,h,c,p,v;h=e;f=this._getFist(t,s);r=0;c=f.ht;for(l in c){n=c[l];u=E.fistH2H(n,n.hval);if(u!==n.hval){n.hval=u;a=true}if(true!==E.fistVAL(n,n.hval)){r++}}p=f.ht;for(l in p){n=p[l];if(n.confirm!=null){if(true===this.confirm(f,n,"fistValidate")){r++}}}if(r){a=true;h.fist$success="FAIL";h.fist$errors=r}else{h.fist$success="SUCCESS";i=h[f.nm]={};v=f.db;for(o in v){n=v[o];i[o]=E.fistH2D(n,n.hval)}}if(a===true){this.invalidateTables([f.rnm])}};s.prototype.loadTable=function(e){var t,s,i,r,n,l,f,u,a,o,h,c,p;h=e.split(":"),r=h[0],p=h[1];f=this._getFist(r,p);s={};t=[];i=false;c=f.sp.FIELDS;for(a=u=0,o=c.length;u<o;a=++u){l=c[a];n=f.ht[l];p=this._makeField(f,n,a,p);if(p.req){i=true}s[l]=[p];t.push(p)}return this.Table[e]=[{Field:[s],Control:t,any_req:i}]};s.prototype._makeField=function(e,t,s,i){var r,n,l,f,u,a,o,h,c;l={is_first:s===0,focus:e.fnm===t.nm,yes_val:"X",req:false,"default":"",width:"",size:"",issue:"",value:"",selected:false,name:t.nm};f=E.merge(l,t);a=f.type.split(":"),f.type=a[0],r=a[1];f.id="U"+E.nextCounter();f.value=t.hval;if(f.type==="yesno"){if(f.cdata==null){f.cdata=["1","0"]}f.yes_val=String(f.cdata[0]);if(f.value===f.yes_val){f.selected=true}else{f.value=f.cdata[1]}}if(t.issue){f.issue=t.issue.asTable()[0].issue}if(f.type==="radio"||f.type==="pulldown"){n=this._getChoices(r,e,t,i);h=[];c="";for(s=u=0,o=n.options.length;0<=o?u<o:u>o;s=0<=o?++u:--u){c=n.values[s]===String(f.value);h.push({option:n.options[s],value:n.values[s],selected:c});f.Choice=h}}return f};s.prototype._getFist=function(e,t){var s,i,r,n,l,f,u,a,o,h,c,p,v;v=e+(t?":"+t:"");if(!(v in this.fist)){n={rnm:v,nm:e,row:t,ht:{},db:{},st:"new",sp:E.fistDef[e]};o=n.sp.FIELDS;for(l=0,f=o.length;l<f;l++){r=o[l];i=E.merge({},E.fieldDef[r],{nm:r,fistNm:e,row:t});i.h2h=function(){switch(E.type_oau(i.h2h)){case"S":return i.h2h.split(/[:,]/);case"A":return i.h2h;default:return[]}}();n.ht[r]=n.db[i.db_nm]=i}h=n.ht;for(r in h){a=h[r];if(a.confirm!=null){n.ht[a.confirm].confirm_src=r}}this.fist[v]=n}else{n=this.fist[v]}if(n.st==="new"){s=(c=E[E.appFist(e)]().fistGetValues(e,t))!=null?c:{};p=n.db;for(u in p){i=p[u];i.hval=E.fistD2H(i,s[u])}n.st="loaded"}return n};s.prototype._getChoices=function(e,t,s){var i,r,n,l,f,u,a,o,h,c,p,v,d,m;u=[];d=[];switch(e){case"array":o=s.cdata;for(i=0,n=o.length;i<n;i++){a=o[i];if(typeof a==="object"){u.push(String(a[1]));d.push(String(a[0]))}else{u.push(String(a));d.push(String(a))}}return{options:u,values:d};case"wist":h=s.cdata.split(":"),m=h[0],v=h[1],f=h[2];c=E.Wist(m);for(r=0,l=c.length;r<l;r++){p=c[r];u.push(p[f]);d.push(p[v])}return{options:u,values:d};case"custom":return E[E.appFist(t.nm)]().fistGetChoices(t.nm,s.nm,t.row)}};return s}(E.ModelJS);E.fistH2H=function(e,t){var s,i,r,n;t=E.fistH2H$pre(e,t);r=e.h2h;for(s=0,i=r.length;s<i;s++){n=r[s];t=E["fistH2H$"+n](e,t)}return t};E.fistH2H$pre=function(e,t){return t};E.fistH2D=function(e,t){if(e.h2d){return E["fistH2D$"+e.h2d](e,t)}else{return t}};E.fistD2H=function(e,t){var s;if(e.d2h){return E["fistD2H$"+e.d2h](e,t)}else{return(s=t!=null?t:e["default"])!=null?s:""}};E.fistVAL=function(e,t){var s,i,r,n,l;delete e.issue;s=true;if(t.length===0){if(e.req===true){s=e.req_text?["FIELD_EMPTY_TEXT",e.nm,(i=e.label)!=null?i:e.nm,e.req_text]:["FIELD_EMPTY",e.nm,(r=e.label)!=null?r:e.nm]}}else{if(e.validate){s=E["fistVAL$"+e.validate](e,t);if(s===false){s="FIELD_ISSUE"+(e.issue_text?"_TEXT":"")}}}if(s!==true){l=s;if("A"!==E.type_oau(l)){l=[l,e.nm,(n=e.label)!=null?n:e.nm,e.issue_text]}e.issue=new E.Issue(e.fistNm,e.nm);e.issue.add(l[0],l.slice(1))}return s===true};E.fistVAL$test=function(e,t){var s;s=e.validate_expr;if(typeof s==="string"){s=new RegExp(s)}return s.test(t)};E.Model.Fist$Base=e}).call(this);
/*Base/Model/Tab.coffee*/(function(){var t,e=function(t,e){for(var a in e){if(r.call(e,a))t[a]=e[a]}function o(){this.constructor=t}o.prototype=e.prototype;t.prototype=new o;t.__super__=e.prototype;return t},r={}.hasOwnProperty;t=function(t){e(r,t);function r(t,e){r.__super__.constructor.call(this,t,e);this.tabs=E.merge({Modal:{backdrop:false}},e)}r.prototype.event=function(t,e,r,a,o){var i,s,l;s=this._getTab(r,a);e=(l=s.TYPE)!=null?l:r;switch(e.toUpperCase()){case"MODAL":i=this._toggleModal(s,a);break;case"DROP":case"COLLAPSE":i=this._toggleDrop(s,a);break;default:i=this._setTab(s,a)}if(i){return this.invalidateTables([r])}};r.prototype.action=function(t,e,a){var o,i,s,l;switch(e){case"toggle":this.event("Tab","click",a.group,a.item,a);break;case"clear_modal":s="Modal";i=this._getTab(s);o=false;for(l in i){if(l!=="backdrop"&&i[l]===true){i.backdrop=i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear_drop":s="Drop";i=this._getTab(s);o=false;for(l in i){if(i[l]===true){i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear":this.event("Tab","click",a.group,"_CLEARED",a);break;default:return r.__super__.action.call(this,t,e,a)}};r.prototype.loadTable=function(t){var e;e=this._getTab(t);return this.Table[t]=[e]};r.prototype._getTab=function(t,e){var r,a;if((r=this.tabs)[t]==null){r[t]={}}if(e!=null){if((a=this.tabs[t])[e]==null){a[e]=false}}return this.tabs[t]};r.prototype._toggleModal=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(a!=="backdrop"&&a!==e&&t[a]===true){r=true;t.backdrop=t[a]=false}}}else if(t[e]!==true){r=true;o=t.backdrop=t[e]=true;for(a in t){if(a!=="backdrop"&&a!==e&&t[a]===true){t[a]=false}}}return r};r.prototype._toggleDrop=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(a!==e&&t[a]===true){r=true;t[a]=false}}}else{r=true;o=t[e]=!t[e];if(o===true){for(a in t){if(a!==e&&t[a]===true){t[a]=false}}}}return r};r.prototype._setTab=function(t,e){var r;if(t[e]===true){return false}for(r in t){t[r]=false}t[e]=true;return true};return r}(E.ModelJS);E.Model.Tab$Base=t;E.ex$collapse=function(t,e,r,a,o,i){var s,l,n,f;f=a.split(":"),s=f[0],n=f[1];l=E.Tab(s)[0][n]?t.scrollHeight:0;return t.style.height=String(l)+"px"}}).call(this);
/*Base/Model/View.coffee*/(function(){"use strict";var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){for(var i in e){if(n.call(e,i))t[i]=e[i]}function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r;t.__super__=e.prototype;return t},n={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++){if(e in this&&this[e]===t)return e}return-1};t=function(t){i(n,t);function n(t,i){this.ex=e(this.ex,this);this.T_if=e(this.T_if,this);this.T_page=e(this.T_page,this);this.handleIt=e(this.handleIt,this);var r,s,o;n.__super__.constructor.call(this,t,i);r=E.appGetSetting("frames");this.frames=function(){var t,e,i,n;i=function(){var t;t=[];for(o in r){t.push(o)}return t}().sort();n=[];for(t=0,e=i.length;t<e;t++){s=i[t];n.push(r[s])}return n}();this.frames.push("X");this.did_run=false;this.in_run=false;window.oE=this;this.defer_it_cnt=0;this.start=false}n.prototype.nest_up=function(t){if(this.defer_it_cnt===0){if(this.in_run){BLOWUP()}this.in_run=true;this.defer_it=new m.Deferred}return this.defer_it_cnt++};n.prototype.nest_dn=function(t){if(this.defer_it_cnt>0){this.defer_it_cnt--}if(this.defer_it_cnt===0){this.in_run=false;return this.defer_it.resolve([this.modal,this.defer_content])}};n.prototype.run=function(){var t,e,i,n,r,s,o,a,l;l="R";n=E.App().getStepPath(),t=n[0],a=n[1],o=n[2];if(i=E.appFindAttr(t,a,o,"modal")){i=(r=E.appGetSetting("modals")[i])!=null?r:i}e=i!=null?i:E.appGetSetting("layout",t,a,o);this.N={};this.modal=i?true:false;this.page_name=(s=E.appGetS(t,a,o).page)!=null?s:o;this.did_run=true;this.frames[this.frames.length-1]=e;this.frame_inx=0;this.resetInfo();this.nest_up(l);this.defer_content=this.kids([["page",{}]]);this.nest_dn(l);return this.defer_it.promise};n.prototype.resetInfo=function(){this.R={};this.I={};this.P=[{}]};n.prototype.saveInfo=function(){var t;t=E.merge({},{I:this.I,P:this.P});return t};n.prototype.restoreInfo=function(t){var e,i;this.resetInfo();this.P=t.P;this.I=t.I;i=[];for(e in this.I){if(!(e in this.R)){i.push(this.R[e]=this._getMyRow(this.I[e]))}}return i};n.prototype._getMyRow=function(t){if(t.m!=null){return E[t.m](t.o)[t.c]}if(!(t.p in this.R)){this.R[t.p]=this._getMyRow(this.I[t.p])}if(t.p&&t.p in this.R){return this.R[t.p][t.o][t.c]}};n.prototype.getTable=function(t){var e,i,n,r,s;switch(t){case"If":return[this.N];case"Part":r={};s=this.P;for(e=0,i=s.length;e<i;e++){n=s[e];E.merge(r,n)}return[r];default:return[]}};n.prototype.invalidateTables=function(t,e,i){if(!(this.did_run&&i.length)){return}m.startComputation();m.endComputation()};n.prototype.handleIt=function(t){if(typeof t==="function"){t=t()}return t};n.prototype.formatFromSpec=function(t,e,i){var n,r,s,o;switch(e){case"":if(i){return E.custom_filter(t,i)}else{return t}break;case"count":return t!=null?t.length:void 0;case"bool":if(t){return true}else{return false}case"bytes":return window.bytesToSize(Number(t));case"uriencode":return encodeURIComponent(t);case"quo":return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"');case"1":return String(t)[0];case"lc":return String(t).toLowerCase();case"ucFirst":o=String(o).toLowerCase();return o.slice(0,1).toUpperCase()+o.slice(1);default:if(e[0]==="?"){r=e.slice(1).split("?"),n=r[0],s=r[1];return(t?n:s!=null?s:"").replace(new RegExp("[%]","g"),t)}}};n.prototype.v3=function(t,e,i,n,r){var s,o;s=E[t](e)[0];o=s[i];if(n!=null){return this.formatFromSpec(o,n,r)}else{return o}};n.prototype.v2=function(t,e,i,n){var r;if(e[0]==="_"){r=this.R[t]._[e.slice(1).toLowerCase()]}else{r=this.R[t][e]}if(i!=null){return this.formatFromSpec(r,i,n)}else{return r}};n.prototype.weed=function(t){var e,i,n;e={};for(i in t){n=t[i];if(i[0]!=="?"){e[i]=n}else{if(n){e[i.slice(1)]=n}}}return e};n.prototype.kids=function(t){var e,i,n,r,s,o,a;a="K";o=[];for(n=i=0,s=t.length;i<s;n=++i){r=t[n];if("A"===E.type_oau(r)){o.push(n);e=this["T_"+r[0]](r[1],r[2]);if(e!=null?e.then:void 0){this.nest_up(a);(function(t){return function(i){return e.then(function(e){o[i]=e;return t.nest_dn(a)},function(e){console.error("kids",e);o[i]=e.message;return t.nest_dn(a)})}})(this)(n)}else{o[n]=e}}else{o.push(r)}}return o};n.prototype.loadPartAttrs=function(t,e){var i,n,r;n={};for(i in t){r=t[i];if("data-e-"!==i.slice(0,7)){continue}n[e?i:i.slice(7)]=r}return n};n.prototype.T_page=function(t){var e,i,n;if(this.frame_inx<this.frames.length){e=E.oLoader.d_layout(i=this.frames[this.frame_inx++]);n=(this.frame_inx<this.frames.length?"Frame":"Layout")+"/"+i}else{e=E.oLoader.d_page(i=this.page_name);n="Page/"+i}return this.piece_handle(n,t!=null?t:{},e)};n.prototype.T_part=function(t){var e,i;i=t.part;e=E.oLoader.d_part(i);return this.piece_handle("Part/"+i,t,e,true)};n.prototype.piece_handle=function(t,e,i,n){var r,s,o;if(i!=null?i.then:void 0){return this.D_piece(t,e,i,n)}s=i.content,r=i.can_componentize;o=this.saveInfo();this.P.push(this.loadPartAttrs(e));s=this.handleIt(s);this.restoreInfo(o);return s};n.prototype.D_piece=function(t,e,i,n){var r,s,o;o="P";this.nest_up(o+t);s=this.saveInfo();r=i.then(function(i){return function(r){var a;try{if(r!=null?r.then:void 0){BLOWUP()}i.restoreInfo(s);a=i.piece_handle(t,e,r,n);return a}finally{i.nest_dn(o+t)}}}(this),function(i){return function(n){console.error("D_piece",n);i.nest_dn(o+t+" IN-ERROR");return typeof i._Err==="function"?i._Err("tag","page/part",e,n):void 0;throw n}}(this));return r};n.prototype.T_if_true=function(t,e){if(this.N[t.name]){return this.handleIt(e())}else{return""}};n.prototype.T_if_false=function(t,e){if(this.N[t.name]){return""}else{return this.handleIt(e)}};n.prototype.T_if=function(t,e){var i,n,s,o,a;n=false;i=false;if("val"in t){if("eq"in t){if(t.val===t.eq){i=true}}else if("ne"in t){if(t.val!==t.ne){i=true}}else if("gt"in t){if(t.val>t.gt){i=true}}else if("in_list"in t){if(s=t.val,r.call(t.in_list.split(","),s)>=0){i=true}}else if("not_in_list"in t){if(o=t.val,r.call(t.not_in_list.split(","),o)<0){i=true}}else{n=true}}else if("set"in t){i=t.set?true:false}else if("not_set"in t){i=t.not_set?false:true}else if("table_is_empty"in t){a=this._accessModelTable(t.table_is_empty,false);if(!a.length){i=true}}else if("table_is_not_empty"in t){a=this._accessModelTable(t.table_is_not_empty,false);if(a.length){i=true}}else{n=true}if(n){console.log("ISSUE T_if",t)}if("name"in t){this.N[t.name]=i}if(i&&e){return this.handleIt(e)}else{return""}};n.prototype._accessModelTable=function(t,e){var i,n,r,s,o,a;n=t.split("/"),i=n[0],r=n[1];if(i in this.R){a=this.R[i][r];o={p:i}}else{a=E[i](r);o={m:i}}if(e===false){return a}s=e!=null?e:r;if(a.length===0){return[a,s]}o.o=r;this.I[s]=o;return[a,s]};n.prototype.T_foreach=function(t,e){var i,n,r,s,o,a,l,u,f;o=this._accessModelTable(t.table,t.alias),f=o[0],l=o[1];if(f.length===0){return""}a=[];s="limit"in t?Number(t.limit)-1:f.length;for(i=n=0,r=f.length;n<r;i=++n){u=f[i];u=f[i];u._={count:i,first:i===0,last:i===s-1,"break":false};this.R[l]=u;this.I[l].c=i;a.push(this.handleIt(e))}delete this.I[l];delete this.R[l];return a};n.prototype.T_fist=function(t,e){var i,n,r,s,o,a,l,u,f,h,p,c,_,d,m,g,y,v,I;r=E.fistDef[t.fist];a=(u=r.event)!=null?u:"Fist";v=t.fist+(t.row!=null?":"+t.row:"");y=(f=(h=t.via)!=null?h:r.via)!=null?f:"Control";o="Fist";p=this._accessModelTable(a+"/"+v,o),I=p[0],g=p[1];this.R[g]=I[0];this.I[g].c=0;m=g;n=e?e:(l=(c=(_=t.part)!=null?_:r.part)!=null?c:"fist_default",t.part!=null?t.part:t.part=(d=r.part)!=null?d:"fist_default",function(e){return function(){return e.kids([["part",E.merge({part:l},e.loadPartAttrs(t,true))]])}}(this));s={table:o+"/"+y};if(t.alias!=null){s.alias=t.alias}i=this.T_foreach(s,n);delete this.R[m];delete this.I[m];return i};n.prototype.ex=function(t,e,i){var n,r,s,o,a,l,u,f,h,p,c,_;n=t.attributes;c=[];for(a=o=0,h=n.length;0<=h?o<h:o>h;a=0<=h?++o:--o){if(!("data-ex-"===n[a].name.slice(0,8))){continue}p=n[a].name.split("-"),r=p[0],s=p[1],l=p[2],u=p[3],f=p[4];_=n[a].value;c.push(E["ex$"+l](t,e,i,_,u,f))}return c};return n}(E.ModelJS);E.Model.View$Base=t}).call(this);
/*Base/Model/Wist.coffee*/(function(){var t,i=function(t,i){for(var r in i){if(o.call(i,r))t[r]=i[r]}function n(){this.constructor=t}n.prototype=i.prototype;t.prototype=new n;t.__super__=i.prototype;return t},o={}.hasOwnProperty;t=function(t){i(o,t);function o(t,i){o.__super__.constructor.call(this,t,i);this.wist={}}o.prototype.loadTable=function(t){return this.Table[t]=this._getWist(t).table};o.prototype._getWist=function(t){var i,o,r,n;if(!(t in this.wist)){i=E.wistDef[t];n=[];for(o in i){r=i[o];r.token=String(o);n.push(r)}this.wist[t]={hash:i,table:n}}return this.wist[t]};return o}(E.ModelJS);E.Model.Wist$Base=t}).call(this);
/*Base/Extra/dataAction.coffee*/(function(){var t,i=[].indexOf||function(t){for(var i=0,n=this.length;i<n;i++){if(i in this&&this[i]===t)return i}return-1};t=function(t,i,n){var e,f,r,l,c,a,u,o,s,v,h,p,k;if(typeof(f=E.option).activity==="function"){f.activity(t)}e=i.split(",");r=true;v=false;for(c=0,o=e.length;c<o;c++){s=e[c];h=s.split(":"),k=h[0],p=h[1],l=h[2],u=h[3],a=h[4];if(!p){p=k;k="click"}if(k==="event"){E.event(p,t,l,u,a,n)}if(r&&k===t){if(k==="click"||k==="rclick"){v=true}r=false;E.action(p,n)}}return v};E.Extra.dataAction$Base=t;E.event=function(t,n,e,f,r,l){var c,a;if(r!=="all"){c=r.split("-");if(i.call(c,n)<0){return}}if(t==="Fist"){t=(a=E.fistDef[e].event)!=null?a:t}return E[t]().event(t,n,e,f,l)}}).call(this);
/*Base/Extra/LoadStrategy.coffee*/(function(){var t;t=function(){function t(t){var e;this.reverse_packages=function(){var r,o,a;a=[];for(e=r=o=t.length-1;o<=0?r<=0:r>=0;e=o<=0?++r:--r){a.push(t[e])}return a}()}t.prototype.getArtifact=function(t,e){var r,o,a,n,i,f,u,s;s=false;n=this.reverse_packages;for(r=0,o=n.length;r<o;r++){a=n[r];s=(i=(f=E["view$"+a])!=null?(u=f[e])!=null?u[t]:void 0:void 0)!=null?i:false;if(s!==false){break}}if(s===false){console.log("NO FILE FOUND! "+t)}return s};t.prototype.D_loadAsync=function(){var t;t=new m.Deferred;t.resolve();return t.promise};t.prototype.d_layout=function(t){return this.getArtifact(t,"Layout")};t.prototype.d_page=function(t){return this.getArtifact(t,"Page")};t.prototype.d_part=function(t){return this.getArtifact(t,"Part")};return t}();E.Extra.LoadStrategy$Base=t;E.opt({loader:"LoadStrategy$Base"})}).call(this);
/*Base/Extra/RenderStrategy.coffee*/(function(){"use strict";var t,e,n,i=function(t,e){return function(){return t.apply(e,arguments)}};t=13;e=27;n=function(){function n(){this.m_redraw=i(this.m_redraw,this);this.onPopState=i(this.onPopState,this);this.handleEvent=i(this.handleEvent,this);var t,e,n;this.very_first=true;this.was_popped=false;this.was_modal=false;this.touchEndIsClick=false;this.touchBoundary=10;this.last_path="not_set";this.unloadMsgs={};this.baseUrl=window.document.location.pathname;this.baseId="epic-new-page";this.modalId="epic-new-modal";t=document.createElement("div");t.id=this.baseId;document.body.appendChild(t);e=document.createElement("div");e.id=this.modalId;document.body.appendChild(e);setTimeout(function(t){return function(){return t.onPopState(true)}}(this),0);window.onpopstate=this.onPopState;this.redraw_guard=0;n=m.redraw.strategy;m.redraw=this.m_redraw;m.redraw.strategy=n;this.init();true}n.prototype.handleEvent=function(n){var i,a,r,s,o,u,h,d,c,l,f,p,m,w,g,y,_,v,b,k,I,S;if(n==null){n=window.event}b=n.type;if(b==="input"){b="change"}if(b==="mousedown"){if(n.which===1||n.button===1){b="click"}else if(n.which===3||n.button===2){b="rclick"}else{return}}if(b==="keyup"&&n.keyCode===9){return}switch(b){case"keyup":switch(n.keyCode){case t:b="enter";break;case e:b="escape"}break;case"touchstart":v=event.targetTouches[0];this.touchEndIsClick=[v.pageX,v.pageY];return true;case"touchmove":if(this.touchEndIsClick!==false){m=this.touchEndIsClick,I=m[0],S=m[1];v=event.targetTouches[0];if(Math.abs(v.pageX-I)>this.touchBoundary||Math.abs(v.pageY-S)>this.touchBoundary){this.touchEndIsClick=false}}return true;case"touchend":if(this.touchEndIsClick!==false){b="click"}this.touchEndIsClick=false}_=n.target;if(_===window){return false}while(_.tagName!=="BODY"&&!(a=_.getAttribute("data-e-action"))){_=_.parentElement}E.option.event(b,n,_,a);if(!a){return false}r={};i=_.attributes;for(u=o=0,w=i.length;0<=w?o<w:o>w;u=0<=w?++o:--o){if(!("data-e-"===i[u].name.slice(0,7))){continue}if("action"===(c=i[u].name.slice(7))){continue}r[c]=i[u].value}k=_.value;if(_.type==="checkbox"&&_.checked===false){k=false}s=_.files;r.val=k;r._files=s;g=["touches","changedTouches","targetTouches"];for(h=0,d=g.length;h<d;h++){c=g[h];if(c in n){r[c]=n[c]}}l=_.getAttribute("data-params");if(l){y=JSON.parse(l);for(c in y){p=y[c];r[c]=p}}f=E.Extra[E.option.dataAction](b,a,r);if(f){n.preventDefault()}return false};n.prototype.init=function(){var t,e,n,i,a;n=["mousedown","dblclick","keyup","blur","focus","change","input","touchstart","touchmove","touchend"];a=[];for(e=0,i=n.length;e<i;e++){t=n[e];a.push(document.body.addEventListener(t,this.handleEvent,true))}return a};n.prototype.UnloadMessage=function(t,e){var n,i,a;if(e){this.unloadMsgs[t]=e}else{delete this.unloadMsgs[t]}n=function(){var t,e;t=this.unloadMsgs;e=[];for(i in t){a=t[i];e.push(a)}return e}.call(this);n=n.length?n.join("\n"):null;return window.onbeforeunload=function(){return n}};n.prototype.onPopState=function(t){if(t===true||!t.state){if(this.was_popped||!this.very_first){E.action("browser_rehash",{hash:location.hash.substr(1)});return}}this.was_popped=true;if(this.very_first){E.action("browser_hash",{hash:location.hash.substr(1)})}else{if(t.state){E.setModelState(t.state)}m.startComputation();m.endComputation();E.action("browser_navhash",{hash:location.hash.substr(1)})}};n.prototype.m_redraw=function(){this.redraw_guard++;if(this.redraw_guard!==1){return}return E.View().run().then(function(t){return function(e){var n,i;i=e[0],n=e[1];t.render(i,n);t.redraw_guard--;if(t.redraw_guard!==0){t.redraw_guard=0;return setTimeout(function(){return t.m_redraw()},16)}}}(this)).then(null,function(t){return function(t){return console.error("RenderStrategy$Base m_redraw",t)}}(this))};n.prototype.render=function(t,e){var n;if(t){m.render(n=document.getElementById(this.modalId),e)}else{if(this.was_modal){m.render(document.getElementById(this.modalId),[])}m.render(n=document.getElementById(this.baseId),m("div",{},e))}if(!t){this.handleRenderState()}this.was_modal=t;this.was_popped=false;this.very_first=false};n.prototype.handleRenderState=function(){var t,e,n,i,a,r,s,o,u;s=E.App().getStepPath();u=s.join("/");i=u===this.last_path?"replace":true;if(!i){return}n="";r=false;o=E.appFindAttr(s[0],s[1],s[2],"route");if(E.type_oau(o)==="O"&&"model"in o){r=E[o.model]().route(o)}if(typeof o==="string"){r=o}if(r!==false){n=r}a=E.getModelState();if(window.location.protocol!=="file:"){if(this.very_first||i==="replace"){if(typeof(t=window.history).replaceState==="function"){t.replaceState(a,n,"#"+n)}}else if(!this.was_popped&&i===true){if(typeof(e=window.history).pushState==="function"){e.pushState(a,n,"#"+n)}window.document.title=n}}this.last_path=u};return n}();E.Extra.RenderStrategy$Base=n}).call(this);
/*Base/Extra/RestAPI.coffee*/(function(){"use strict";var t;t=function(){function t(t){var e,r,o,n,s;this.opts={port:"",prefix:"",version:"",proto:"//",app_headers:{}};for(e in t){n=t[e];this.opts[e]=n}r=String(this.opts.port);if(r.length){r=":"+r}if(this.opts.prefix.length){o="/"+this.opts.prefix}if(this.opts.version.length){s="/"+this.opts.version}this.route_prefix=""+this.opts.proto+this.opts.host+(r!=null?r:"")+(o!=null?o:"")+(s!=null?s:"")+"/";this.SetToken(false)}t.prototype.GetPrefix=function(){return this.route_prefix};t.prototype.GetToken=function(){return this.token};t.prototype.SetToken=function(t){this.token=t};t.prototype.D_Request=function(t,e,r,o){var n,s;n=E.merge({},this.opts.app_headers,o!=null?o:{});s={code:false,text:false,ok:false};return m.request({background:true,method:t,url:this.route_prefix+e,data:r,config:function(t){var e,r,o;r=n!=null?n:{};for(e in r){o=r[e];t.setRequestHeader(e,o)}},unwrapSuccess:function(t){return{status:s,data:t}},unwrapError:function(t){return{status:s,data:t}},extract:function(t,e){s.code=t.status;s.text=t.statusText;s.xhr=t;if(t.status===200){s.ok=true}if(!t.responseText.length&&t.readyState===4){s.text="NetworkError";return'{"error":"NETWORK_ERROR"}'}return t.responseText}}).then(null,function(t){return t})};t.prototype.D_Get=function(t,e){return this.D_RequestAuth("GET",t,e)};t.prototype.D_Post=function(t,e){return this.D_RequestAuth("POST",t,e)};t.prototype.D_Del=function(t,e){return this.D_RequestAuth("DEL",t,e)};t.prototype.D_Put=function(t,e){return this.D_RequestAuth("PUT",t,e)};t.prototype.D_RequestAuth=function(t,e,r,o){var n,s,u;u=this.GetToken();if(u===false){setTimeout(function(){return E.action("Request.no_token")},0);n=new m.Deferred;n.resolve({status:{code:401,text:"NO_TOKEN",ok:false},data:{error:"TOKEN"}});return n.promise}s=E.merge({},this.opts.app_headers,o!=null?o:{});s.Authorization=u.token_type+" "+u.access_token;return this.D_Request(t,e,r,s).then(function(t){return function(t){if(status.code===401){setTimeout(function(){return E.action("Request.bad_token")},0);return{status:{code:401,text:"BAD_TOKEN",ok:false},data:{error:"TOKEN"}}}return t}}(this))};return t}();E.Extra.RestAPI$Base=t}).call(this);
E.view$Base={
Layout: {
"default":{preloaded:1,can_componentize:false,defer:0,content:function(){return oE.kids([['page',{}]])}}},
Page: {
"default":{preloaded:1,can_componentize:true,defer:0,content:function(){return [{tag:'b',attrs:{},children:['A Base Page']}]}}},
Part: {
}};

