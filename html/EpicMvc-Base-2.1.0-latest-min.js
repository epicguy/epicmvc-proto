/* Copyright 2007-2015 by James Shelby, shelby (at:) dtsol.com; All rights reserved. */
// JCS: Version http://lhorie.github.io/mithril/archive/v0.2.0/
var m=function e(t,n){function m(e){h=e.document,p=e.location,v=e.cancelAnimationFrame||e.clearTimeout,d=e.requestAnimationFrame||e.setTimeout}function g(){var e=[].slice.call(arguments),t=e[1]!=null&&u.call(e[1])===r&&!("tag"in e[1]||"view"in e[1])&&!("subtree"in e[1]),n=t?e[1]:{},o="class"in n?"class":"className",l={tag:"div",attrs:{}},c,h=[];if(u.call(e[0])!=s)throw new Error("selector in m(selector, attrs, children) should be a string");while(c=a.exec(e[0]))if(c[1]===""&&c[2])l.tag=c[2];else if(c[1]==="#")l.attrs.id=c[2];else if(c[1]===".")h.push(c[2]);else if(c[3][0]==="["){var p=f.exec(c[3]);l.attrs[p[1]]=p[3]||(p[2]?"":!0)}var d=t?e.slice(2):e.slice(1);d.length===1&&u.call(d[0])===i?l.children=d[0]:l.children=d;for(var v in n)n.hasOwnProperty(v)&&(v===o&&n[v]!=null&&n[v]!==""?(h.push(n[v]),l.attrs[v]=""):l.attrs[v]=n[v]);return h.length>0&&(l.attrs[o]=h.join(" ")),l}function y(e,t,a,f,p,d,v,m,S,T,N){try{if(p==null||p.toString()==null)p=""}catch(C){p=""}if(p.subtree==="retain")return d;var k=u.call(d),L=u.call(p);if(d==null||k!==L){if(d!=null)if(a&&a.nodes){var A=m-f,O=A+(L===i?p:d.nodes).length;E(a.nodes.slice(A,O),a.slice(A,O))}else d.nodes&&E(d.nodes,d);d=new p.constructor,d.tag&&(d={}),d.nodes=[]}if(L===i){for(var M=0,_=p.length;M<_;M++)u.call(p[M])===i&&(p=p.concat.apply([],p),M--,_=p.length);var D=[],P=d.length===p.length,H=0,B=1,j=2,F=3,I={},U=!1;for(var M=0;M<d.length;M++)d[M]&&d[M].attrs&&d[M].attrs.key!=null&&(U=!0,I[d[M].attrs.key]={action:B,index:M});var z=0;for(var M=0,_=p.length;M<_;M++)if(p[M]&&p[M].attrs&&p[M].attrs.key!=null){for(var W=0,_=p.length;W<_;W++)p[W]&&p[W].attrs&&p[W].attrs.key==null&&(p[W].attrs.key="__mithril__"+z++);break}if(U){var X=!1;if(p.length!=d.length)X=!0;else for(var M=0,V,$;V=d[M],$=p[M];M++)if(V.attrs&&$.attrs&&V.attrs.key!=$.attrs.key){X=!0;break}if(X){for(var M=0,_=p.length;M<_;M++)if(p[M]&&p[M].attrs&&p[M].attrs.key!=null){var J=p[M].attrs.key;I[J]?I[J]={action:F,index:M,from:I[J].index,element:d.nodes[I[J].index]||h.createElement("div")}:I[J]={action:j,index:M}}var K=[];for(var Q in I)K.push(I[Q]);var G=K.sort(b),Y=new Array(d.length);Y.nodes=d.nodes.slice();for(var M=0,Z;Z=G[M];M++){Z.action===B&&(E(d[Z.index].nodes,d[Z.index]),Y.splice(Z.index,1));if(Z.action===j){var et=h.createElement("div");et.key=p[Z.index].attrs.key,e.insertBefore(et,e.childNodes[Z.index]||null),Y.splice(Z.index,0,{attrs:{key:p[Z.index].attrs.key},nodes:[et]}),Y.nodes[Z.index]=et}Z.action===F&&(e.childNodes[Z.index]!==Z.element&&Z.element!==null&&e.insertBefore(Z.element,e.childNodes[Z.index]||null),Y[Z.index]=d[Z.from],Y.nodes[Z.index]=Z.element)}d=Y}}for(var M=0,tt=0,_=p.length;M<_;M++){var nt=y(e,t,d,m,p[M],d[tt],v,m+H||H,S,T,N);if(nt===n)continue;nt.nodes.intact||(P=!1),nt.$trusted?H+=(nt.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:H+=u.call(nt)===i?nt.length:1,d[tt++]=nt}if(!P){for(var M=0,_=p.length;M<_;M++)d[M]!=null&&D.push.apply(D,d[M].nodes);for(var M=0,rt;rt=d.nodes[M];M++)rt.parentNode!=null&&D.indexOf(rt)<0&&E([rt],[d[M]]);p.length<d.length&&(d.length=p.length),d.nodes=D}}else if(p!=null&&L===r){var it=[],st=[];while(p.view){var ot=p.view.$original||p.view,ut=g.redraw.strategy()=="diff"&&d.views?d.views.indexOf(ot):-1,at=ut>-1?d.controllers[ut]:new(p.controller||c),J=p&&p.attrs&&p.attrs.key;p=R==0||d&&d.controllers&&d.controllers.indexOf(at)>-1?p.view(at):{tag:"placeholder"};if(p.subtree==="retain")return d;J&&(p.attrs||(p.attrs={}),p.attrs.key=J),at.onunload&&q.push({controller:at,handler:at.onunload}),it.push(ot),st.push(at)}if(!p.tag&&st.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");p.attrs||(p.attrs={}),d.attrs||(d.attrs={});var ft=Object.keys(p.attrs),lt=ft.length>("key"in p.attrs?1:0);if(p.tag!=d.tag||ft.sort().join()!=Object.keys(d.attrs).sort().join()||p.attrs.id!=d.attrs.id||p.attrs.key!=d.attrs.key||g.redraw.strategy()=="all"&&(!d.configContext||d.configContext.retain!==!0)||g.redraw.strategy()=="diff"&&d.configContext&&d.configContext.retain===!1){d.nodes.length&&E(d.nodes),d.configContext&&typeof d.configContext.onunload===o&&d.configContext.onunload();if(d.controllers)for(var M=0,at;at=d.controllers[M];M++)typeof at.onunload===o&&at.onunload({preventDefault:c})}if(u.call(p.tag)!=s)return;var rt,ct=d.nodes.length===0;p.attrs.xmlns?T=p.attrs.xmlns:p.tag==="svg"?T="http://www.w3.org/2000/svg":p.tag==="math"&&(T="http://www.w3.org/1998/Math/MathML");if(ct){p.attrs.is?rt=T===n?h.createElement(p.tag,p.attrs.is):h.createElementNS(T,p.tag,p.attrs.is):rt=T===n?h.createElement(p.tag):h.createElementNS(T,p.tag),d={tag:p.tag,attrs:lt?w(rt,p.tag,p.attrs,{},T):p.attrs,children:p.children!=null&&p.children.length>0?y(rt,p.tag,n,n,p.children,d.children,!0,0,p.attrs.contenteditable?rt:S,T,N):p.children,nodes:[rt]};if(st.length){d.views=it,d.controllers=st;for(var M=0,at;at=st[M];M++){at.onunload&&at.onunload.$old&&(at.onunload=at.onunload.$old);if(R&&at.onunload){var ht=at.onunload;at.onunload=c,at.onunload.$old=ht}}}d.children&&!d.children.nodes&&(d.children.nodes=[]),p.tag==="select"&&"value"in p.attrs&&w(rt,p.tag,{value:p.attrs.value},{},T),e.insertBefore(rt,e.childNodes[m]||null)}else rt=d.nodes[0],lt&&w(rt,p.tag,p.attrs,d.attrs,T),d.children=y(rt,p.tag,n,n,p.children,d.children,!1,0,p.attrs.contenteditable?rt:S,T,N),d.nodes.intact=!0,st.length&&(d.views=it,d.controllers=st),v===!0&&rt!=null&&e.insertBefore(rt,e.childNodes[m]||null);if(typeof p.attrs.config===o){var pt=d.configContext=d.configContext||{},dt=function(e,t){return function(){return e.attrs.config.apply(e,t)}};N.push(dt(p,[rt,!ct,pt,d]))}}else if(typeof p!=o){var D;if(d.nodes.length===0)p.$trusted?D=x(e,m,p):(D=[h.createTextNode(p)],e.nodeName.match(l)||e.insertBefore(D[0],e.childNodes[m]||null)),d="string number boolean".indexOf(typeof p)>-1?new p.constructor(p):p,d.nodes=D;else if(d.valueOf()!==p.valueOf()||v===!0){D=d.nodes;if(!S||S!==h.activeElement)if(p.$trusted)E(D,d),D=x(e,m,p);else if(t==="textarea")e.value=p;else if(S)S.innerHTML=p;else{if(D[0].nodeType===1||D.length>1)E(d.nodes,d),D=[h.createTextNode(p)];e.insertBefore(D[0],e.childNodes[m]||null),D[0].nodeValue=p}d=new p.constructor(p),d.nodes=D}else d.nodes.intact=!0}return d}function b(e,t){return e.action-t.action||e.index-t.index}function w(e,t,n,i,s){for(var a in n){var f=n[a],l=i[a];if(a in i&&l===f)a==="value"&&t==="input"&&e.value!=f&&(e.value=f);else{i[a]=f;try{if(a==="config"||a=="key")continue;if(typeof f===o&&a.indexOf("on")===0)e[a]=T(f,e);else if(a==="style"&&f!=null&&u.call(f)===r){for(var c in f)if(l==null||l[c]!==f[c])e.style[c]=f[c];for(var c in l)c in f||(e.style[c]="")}else if(s!=null)a==="href"?e.setAttributeNS("http://www.w3.org/1999/xlink","href",f):a==="className"?e.setAttribute("class",f):e.setAttribute(a,f);else if(a in e&&a!=="list"&&a!=="style"&&a!=="form"&&a!=="type"&&a!=="width"&&a!=="height"){if(t!=="input"||e[a]!==f)e[a]=f}else e.setAttribute(a,f)}catch(h){if(h.message.indexOf("Invalid argument")<0)throw h}}}return i}function E(e,t){for(var n=e.length-1;n>-1;n--)if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(r){}t=[].concat(t),t[n]&&S(t[n])}e.length!=0&&(e.length=0)}function S(e){e.configContext&&typeof e.configContext.onunload===o&&(e.configContext.onunload(),e.configContext.onunload=null);if(e.controllers)for(var t=0,n;n=e.controllers[t];t++)typeof n.onunload===o&&n.onunload({preventDefault:c});if(e.children)if(u.call(e.children)===i)for(var t=0,r;r=e.children[t];t++)S(r);else e.children.tag&&S(e.children)}function x(e,t,n){var r=e.childNodes[t];if(r){var i=r.nodeType!=1,s=h.createElement("span");i?(e.insertBefore(s,r||null),s.insertAdjacentHTML("beforebegin",n),e.removeChild(s)):r.insertAdjacentHTML("beforebegin",n)}else e.insertAdjacentHTML("beforeend",n);var o=[];while(e.childNodes[t]!==r)o.push(e.childNodes[t]),t++;return o}function T(e,t){return function(n){n=n||event,g.redraw.strategy("diff"),g.startComputation();try{return e.call(t,n)}finally{U()}}}function A(e){var t=k.indexOf(e);return t<0?k.push(e)-1:t}function O(e){var t=function(){return arguments.length&&(e=arguments[0]),e};return t.toJSON=function(){return e},t}function z(e,t){var s={},o=[];for(var a in e){var f=t?t+"["+a+"]":a,l=e[a],c=u.call(l),h=l===null?encodeURIComponent(f):c===r?z(l,f):c===i?l.reduce(function(e,t){return s[f]||(s[f]={}),s[f][t]?e:(s[f][t]=!0,e.concat(encodeURIComponent(f)+"="+encodeURIComponent(t)))},[]).join("&"):encodeURIComponent(f)+"="+encodeURIComponent(l);l!==n&&o.push(h)}return o.join("&")}function W(e){e.charAt(0)==="?"&&(e=e.substring(1));var t=e.split("&"),n={};for(var r=0,s=t.length;r<s;r++){var o=t[r].split("="),a=decodeURIComponent(o[0]),f=o.length==2?decodeURIComponent(o[1]):null;n[a]!=null?(u.call(n[a])!==i&&(n[a]=[n[a]]),n[a].push(f)):n[a]=f}return n}function X(e){var t=A(e);E(e.childNodes,L[t]),L[t]=n}function V(e,t){var n=g.prop(t);return e.then(n),n.then=function(n,r){return V(e.then(n,r),t)},n}function $(e,t){function p(e){l=e||a,h.map(function(e){l===s&&e.resolve(c)||e.reject(c)})}function d(e,t,n,i){if((c!=null&&u.call(c)===r||typeof c===o)&&typeof e===o)try{var s=0;e.call(c,function(e){if(s++)return;c=e,t()},function(e){if(s++)return;c=e,n()})}catch(a){g.deferred.onerror(a),c=a,n()}else i()}function v(){var r;try{r=c&&c.then}catch(u){return g.deferred.onerror(u),c=u,l=i,v()}d(r,function(){l=n,v()},function(){l=i,v()},function(){try{l===n&&typeof e===o?c=e(c):l===i&&typeof t=="function"&&(c=t(c),l=n)}catch(u){return g.deferred.onerror(u),c=u,p()}c===f?(c=TypeError(),p()):d(r,function(){p(s)},p,function(){p(l===n&&s)})})}var n=1,i=2,s=3,a=4,f=this,l=0,c=0,h=[];f.promise={},f.resolve=function(e){return l||(c=e,l=n,v()),this},f.reject=function(e){return l||(c=e,l=i,v()),this},f.promise.then=function(e,t){var n=new $(e,t);return l===s?n.resolve(c):l===a?n.reject(c):h.push(n),n.promise}}function J(e){return e}function K(e){if(!e.dataType||e.dataType.toLowerCase()!=="jsonp"){var a=new t.XMLHttpRequest;a.open(e.method,e.url,!0,e.user,e.password),a.onreadystatechange=function(){a.readyState===4&&(a.status>=200&&a.status<300?e.onload({type:"load",target:a}):e.onerror({type:"error",target:a}))},e.serialize===JSON.stringify&&e.data&&e.method!=="GET"&&a.setRequestHeader("Content-Type","application/json; charset=utf-8"),e.deserialize===JSON.parse&&a.setRequestHeader("Accept","application/json, text/*");if(typeof e.config===o){var f=e.config(a,e);f!=null&&(a=f)}var l=e.method==="GET"||!e.data?"":e.data;if(l&&u.call(l)!=s&&l.constructor!=t.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return a.send(l),a}var r="mithril_callback_"+(new Date).getTime()+"_"+Math.round(Math.random()*1e16).toString(36),i=h.createElement("script");t[r]=function(s){i.parentNode.removeChild(i),e.onload({type:"load",target:{responseText:s}}),t[r]=n},i.onerror=function(s){return i.parentNode.removeChild(i),e.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),t[r]=n,!1},i.onload=function(e){return!1},i.src=e.url+(e.url.indexOf("?")>0?"&":"?")+(e.callbackKey?e.callbackKey:"callback")+"="+r+"&"+z(e.data||{}),h.body.appendChild(i)}function Q(e,t,n){if(e.method==="GET"&&e.dataType!="jsonp"){var r=e.url.indexOf("?")<0?"?":"&",i=z(t);e.url=e.url+(i?r+i:"")}else e.data=n(t);return e}function G(e,t){var n=e.match(/:[a-z]\w+/gi);if(n&&t)for(var r=0;r<n.length;r++){var i=n[r].slice(1);e=e.replace(n[r],t[i]),delete t[i]}return e}var r="[object Object]",i="[object Array]",s="[object String]",o="function",u={}.toString,a=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,f=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,l=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,c=function(){},h,p,d,v;m(t);var N,C={appendChild:function(e){N===n&&(N=h.createElement("html")),h.documentElement&&h.documentElement!==e?h.replaceChild(e,h.documentElement):h.appendChild(e),this.childNodes=h.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]},k=[],L={};g.render=function(e,t,r){var i=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var s=A(e),o=e===h,u=o||e===h.documentElement?C:e;o&&t.tag!="html"&&(t={tag:"html",attrs:{},children:t}),L[s]===n&&E(u.childNodes),r===!0&&X(e),L[s]=y(u,null,n,n,t,L[s],!1,0,null,n,i);for(var a=0,f=i.length;a<f;a++)i[a]()},g.trust=function(e){return e=new String(e),e.$trusted=!0,e},g.prop=function(e){return(e!=null&&u.call(e)===r||typeof e===o)&&typeof e.then===o?V(e):O(e)};var M=[],_=[],D=[],P=null,H=0,B=null,j=null,F=!1,I,q=[];g.redraw=function(e){},g.redraw.strategy=g.prop();var R=0;g.startComputation=function(){R++},g.endComputation=function(){R=Math.max(R-1,0),R===0&&g.redraw()};var U=function(){g.redraw.strategy()=="none"?(R--,g.redraw.strategy("diff")):g.endComputation()};return g.deferred=function(){var e=new $;return e.promise=V(e.promise),e},g.deferred.onerror=function(e){if(u.call(e)==="[object Error]"&&!e.constructor.toString().match(/ Error/))throw e},g.request=function(e){e.background!==!0&&g.startComputation();var t=new $,n=e.dataType&&e.dataType.toLowerCase()==="jsonp",r=e.serialize=n?J:e.serialize||JSON.stringify,s=e.deserialize=n?J:e.deserialize||JSON.parse,o=n?function(e){return e.responseText}:e.extract||function(e){return e.responseText.length===0&&s===JSON.parse?null:e.responseText};return e.method=(e.method||"GET").toUpperCase(),e.url=G(e.url,e.data),e=Q(e,e.data,r),e.onload=e.onerror=function(n){try{n=n||event;var r=(n.type==="load"?e.unwrapSuccess:e.unwrapError)||J,a=r(s(o(n.target,e)),n.target);if(n.type==="load")if(u.call(a)===i&&e.type)for(var f=0;f<a.length;f++)a[f]=new e.type(a[f]);else e.type&&(a=new e.type(a));t[n.type==="load"?"resolve":"reject"](a)}catch(n){g.deferred.onerror(n),t.reject(n)}e.background!==!0&&g.endComputation()},K(e),t.promise=V(t.promise,e.initialValue),t.promise},g.deps=function(e){return m(t=e||t),t},g.deps.factory=e,g.Deferred=$,g}(typeof window!="undefined"?window:{});typeof module!="undefined"&&module!==null&&module.exports?module.exports=m:typeof define=="function"&&define.amd&&define(function(){return m});
/*EpicCore*/(function(){"use strict";var e,t,n,r,i,s,o,u=[].slice,a=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};n=function(t,r){var i,s,o,a,f,l,c,h,p,d,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z;F=!1,_=0,o={},s={},X={},z={},M=[],$={event:function(){},loadDirs:{}},i={},i.nextCounter=function(){return++_},i.opt=function(e){return U($,e)},i.camelCase=function(e,t){return t==null&&(t="-"),e.toLowerCase().replace(new RegExp(t+"(.)","g"),function(e,t){return t.toUpperCase()})},K=function(e){return{}.toString.call(e)[8]},U=function(){var e,t,n,i,s,o,a,f,l,c,h,p;n=arguments[0],f=2<=arguments.length?u.call(arguments,1):[],o="O",e="A",c="U",l="S",t=0,s={},s[o]=function(e,t){var n,s;if(K(t)!==o)return r;for(s in t)n=i(e[s],t[s]),n!==r&&(e[s]=n);return r},s[e]=function(t,n){var s,o,u,a,f;if(K(n)!==e)return r;for(o=a=0,f=n.length;a<f;o=++a)u=n[o],s=i(t[o],u),s!==r&&(t[o]=s);return r},s[c]=function(t,n){var r;switch(K(n)){case o:r={},s[o](r,n);break;case e:r=[],s[e](r,n);break;default:r=n}return r},s[l]=function(e,t){return K(t)!==c?t:e},i=function(e,n){var r,i;return t++,i=K(e),i in s||(i=l),r=s[i](e,n),t--,r};for(h=0,p=f.length;h<p;h++)a=f[h],i(n,a);return n},i.login=function(){var e,t,n;n=[];for(e in X)t=X[e],n.push(typeof t.eventLogin=="function"?t.eventLogin():void 0);return n},i.logout=function(e,t){var n=this;if(F!==!1){setTimeout(function(){return i.logout(e,t)},100);return}return e?d(e,t).then(function(){return P()}):P()},P=function(){var e,t,n;n=[];for(e in X){t=X[e];if(typeof t.eventLogout=="function"?!t.eventLogout():!void 0)continue;delete z[e],n.push(delete X[e])}return n},i.run=function(e,t,n){var r;M=e,U($,t),i.oLoader=new s[$.loader](M),r=i.oLoader.D_loadAsync(),r.then(function(){return N(),U($,t),R(),B(),G(),I(),typeof n=="function"&&n(),i.App().go(p.go),i.oRender=new s[$.render]})},J=function(e){var t,n,r;e!=null&&(z=e),r=[];for(t in X)r.push(typeof (n=X[t]).restoreState=="function"?n.restoreState(z[t]):void 0);return r},j=function(){var e,t,n;z={};for(e in X)t=X[e],t.saveState!=null&&(n=t.saveState())&&(z[e]=n);return z},p={frames:{},modals:{},layout:"default",go:"default//"},c={},a={},l={"default":{start:"default",TRACKS:{"default":{start:"default",STEPS:{"default":{}}}}}},h={},f={},C=function(e){},N=function(){var e,t,r,s,o,u,d,v,m,g,y,b;for(d=0,m=M.length;d<m;d++){r=M[d],n=(y=i["app$"+r])!=null?y:{},n.STEPS&&U(l["default"].TRACKS["default"].STEPS,n.STEPS),n.TRACKS&&U(l["default"].TRACKS,n.TRACKS),t={SETTINGS:p,MACROS:c,ACTIONS:a,FLOWS:l,MODELS:h,OPTIONS:$};for(r in t)o=t[r],U(o,n[r])}for(u in h){s=h[u];if(s.fists){b=s.fists;for(v=0,g=b.length;v<g;v++)e=b[v],f[e]=u}}},k=function(e,t){return h[e][t]},b=function(e){return f[e]},y=function(e,t,n,r,i){var s,o,u,a,f,c,h,p,d;o=l[e];if(o){if(t&&(a=(f=o.TRACKS)!=null?f[t]:void 0)!=null){if(n&&(u=(c=a.STEPS)!=null?c[n]:void 0)!=null&&(s=(h=u[r])!=null?h[i]:void 0)!=null)return s;if((s=(p=a[r])!=null?p[i]:void 0)!=null)return s}if((s=(d=o[r])!=null?d[i]:void 0)!=null)return s}return null},g=function(e,t,n,r){var i,s,o,u,a,f;s=l[e];if(s){if(t&&(u=(a=s.TRACKS)!=null?a[t]:void 0)!=null){if(n&&(o=(f=u.STEPS)!=null?f[n]:void 0)!=null&&(i=o[r])!=null)return i;if((i=u[r])!=null)return i}if((i=s[r])!=null)return i}return null},w=function(e){return l[e]},x=function(e,t){return l[e].TRACKS[t]},E=function(e,t,n){return l[e].TRACKS[t].STEPS[n]},O=function(e){return w(e).start},A=function(e,t){return x(e,t).start},v=function(e,t){var n;return(n=y(e[0],e[1],e[2],"ACTIONS",t))!=null?n:a[t]},S=function(e,t,n,r){var i;return t?(i=g(t,n,r!=null?r:false,e))!=null?i:p[e]:p[e]},T=function(e,t,n){var r;return r=U({},l[e].v,l[e].TRACKS[t].v,l[e].TRACKS[t].STEPS[n].v),r},L=function(e,t){var n,r,i,s,o,u,a,f;for(r in l){n=l[r],a=n.TRACKS;for(u in a){o=a[u],f=o.STEPS;for(s in f){i=f[s];if(i[e]===t)return[r,u,s]}if(o[e]===t)return[r,u,o.start]}if(n[e]===t)return[r,n.start,l[n.start].start]}return!1},R=function(){var e,t,n;n=[];for(t in h)e=h[t],n.push(function(e,t){return i[e]=function(n,s,o){var u,a;return u=t.inst,u in X||(X[u]=new i.Model[t["class"]](e,t.options),u in X&&X[u].restoreState(X[u])),a=X[u],n===r?a:s===r?a.getTable(n):a.action(n,s,o)}}(t,e));return n},d=function(e,t){var n,r,s;F=e,m.startComputation(),r=function(){return m.endComputation()},s=function(e){return i.App().setIssues(e[0]),i.App().setMessages(e[1]),F=!1};try{n=Y(e,t,i.App().getStepPath())}finally{(n!=null?n.then:void 0)!=null?n.then(s).then(r,function(e){throw r(),e}):(setTimeout(r,0),n!=null&&s(n))}},Y=function(t,n,r){var s,o,u,a,f,l,h,p,d,g;return d=new e("App"),g=new e("App"),p=U({},n),s=v(r,t),s==null?[d,g]:(a=function(e){var n,r,s,o,a,f,l,h,v,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B;_=["fist","clear"];for(L=0,O=_.length;L<O;L++){k=_[L];if(!(k in e))continue;f=e[k],l=(D=i.fistDef[f].event)!=null?D:"Fist";if(k==="clear")i[l]().fistClear(f,p.row);else{i[l]().fistValidate(x={},f,p.row),i.merge(p,x);if(x.fist$success!=="SUCCESS")return}}S=function(){switch(K(e.pass)){case"A":return e.pass;case"S":return e.pass.split(",");default:return[]}}();for(y=A=0,M=S.length;A<M;y=++A){E=S[y];if(!(E.indexOf(":")>-1))continue;P=E.split(":"),w=P[0],r=P[1],p[r]=p[w],S[y]=w}H=e.set;for(E in H)T=H[E],p[E]=T;if(e["do"]!=null)return v=e["do"].indexOf(".")<0,v?u(c[e["do"]]):(B=e["do"].split("."),C=B[0],N=B[1],N=N?N:t,o=new m.Deferred,x={},h=new i.Issue(C,N),b=new i.Issue(C,N),s={d:o,r:x,i:h,m:b},n=i[C](s,N,p),a=function(){var e;e=s.r;for(E in e)T=e[E],p[E]=T;return d.addObj(s.i),g.addObj(s.m)},(n!=null?n.then:void 0)!=null?n.then(a):a(n))},f=function(e){var t,n,r,s,o,a,f,l,c,h,d;e.go!=null&&i.App().go(e.go),s=null,(l=e.next)==null&&(e.next=[]),"A"!==K(e.next)&&(e.next=[e.next]),c=e.next;for(a=0,f=c.length;a<f;a++){t=c[a];if(!("when"in t)){s=t;break}if(t.when==="default"){s=t;break}if(typeof t.when=="string"&&t.when===((h=p.success)!=null?h:p.ok)){s=t;break}r=!0,d=t.when;for(n in d){o=d[n];if(p[n]!==o){r=!1;break}}if(r){s=t;break}}if(s)return u(s)},u=function(e){var t,n;return t=a(e),n=function(){return f(e)},(t!=null?t.then:void 0)!=null?t.then(n):n(t)},o=u(s),l=function(){return[d,g]},h=function(e){throw new Error("BLOWUP:"+e.message)},(o!=null?o.then:void 0)!=null?o.then(l,h):l(o))},D={},H={},B=function(){var e,t,n,r,s,o,u;for(r=0,s=M.length;r<s;r++)t=M[r],e=(o=i["fist$"+t])!=null?o:{},e.FIELDS&&U(D,e.FIELDS),e.FISTS&&U(H,e.FISTS);for(t in H)n=H[t],n.fistNm=t;u=[];for(t in D)n=D[t],u.push(n.fieldNm=t);return u},q={},I=function(){var e,t,n,r,s,o;o=[];for(n=0,r=M.length;n<r;n++)t=M[n],e=(s=i["issues$"+t])!=null?s:{},o.push(U(q,e));return o},Q={},G=function(){var e,t,n,r,s,o;o=[];for(n=0,r=M.length;n<r;n++)e=M[n],t=(s=i["wist$"+e])!=null?s:{},o.push(U(Q,t));return o},Z={type_oau:K,Model:o,Extra:s,option:$,action:d,merge:U,getModelState:j,setModelState:J,appGetF:w,appGetT:x,appGetS:E,appStartT:O,appStartS:A,appFindAction:v,appGetSetting:S,appGetVars:T,appFist:b,appFindAttr:g,appSearchAttr:L,fieldDef:D,fistDef:H,issueMap:q,wistDef:Q};for(W in Z)V=Z[W],i[W]=V;return i},e=function(){function e(e,t){this.t_view=e,this.t_action=t,this.issue_list=[]}return e.Make=function(t,n,r){var i;return i=new e(t),i.add(n,r),i},e.prototype.add=function(e,t){switch(typeof t){case"undefined":t=[];break;case"string":t=[t]}return this.issue_list.push({token:e,more:t,t_view:this.t_view,t_action:this.t_action})},e.prototype.addObj=function(e){var t,n,r,i,s,o,u;if(!(typeof e=="object"&&"issue_list"in e))return;s=e.issue_list;for(r=0,i=s.length;r<i;r++)t=s[r],n=E.merge({},t),(o=n.t_view)==null&&(n.t_view=this.t_view),(u=n.t_action)==null&&(n.t_action=this.t_action),this.issue_list.push(n)},e.prototype.count=function(){return this.issue_list.length},e.prototype.asTable=function(){var e,t,n,r,i;e=[],i=this.issue_list;for(n=0,r=i.length;n<r;n++)t=i[n],e.push({token:t.token,title:""+t.t_view+"#"+t.t_action+"#"+t.token+"#"+t.more.join(","),issue:this.map(t.t_view,t.t_action,t.token,t.more)});return e},e.prototype.map=function(e,t,n,r){var i,s,o,u,a,f,l,c,h;i=E.issueMap;if(typeof i!="object")return"(no map) "+e+"#"+t+"#"+n+"#"+r.join(",");s=[],e in i&&(t in i[e]&&s.push(i[e][t]),"default"in i[e]&&s.push(i[e]["default"])),"default"in i&&(t in i["default"]&&s.push(i["default"][t]),"default"in i["default"]&&s.push(i["default"]["default"]));for(a=0,l=s.length;a<l;a++){u=s[a],h=u||[];for(f=0,c=h.length;f<c;f++){o=h[f];if(n.match(o[0]))return this.doMap(n,o[1],r,n)}}return"(no match)"+e+"#"+t+"#"+n+"#"+r.join(",")},e.prototype.doMap=function(e,t,n){var r;return r=t.replace(/%([0-9])(?::([0-9]))?%/g,function(t,r,i,s){return r==="0"?e:i?n[r-1]||n[i-1]||"":n[r-1]||""}),r},e}(),t=function(){function e(e,t,n){this.view_nm=e,this.options=t,this._ModelJS={ss:n||!1},this.restoreState(!1)}return e.prototype.getTable=function(e){return this.loadTableIf(e),this.Table[e]},e.prototype.loadTableIf=function(e){if(!(e in this.Table))return this.loadTable(e)},e.prototype.restoreState=function(e){var t;if(this._ModelJS.ss!=null)for(t in this._ModelJS.ss)delete this[t];return this._ModelJS.ss!=null&&E.merge(this,this._ModelJS.ss),e&&E.merge(this,e),this.Table={}},e.prototype.saveState=function(){var e,t,n;t=this._ModelJS.ss;if(!t)return!1;n={};for(e in t)this[e]!==t[e]&&(n[e]=this[e]);return E.merge({},n)},e.prototype.invalidateTables=function(e,t){var n,r,i,s;t==null&&(t=[]),e===!0&&(e=function(){var e;e=[];for(r in this.Table)a.call(t,r)>=0||e.push(r);return e}.call(this)),n=[];for(i=0,s=e.length;i<s;i++)r=e[i],r in this.Table&&(n.push(r),delete this.Table[r]);return E.View().invalidateTables(this.view_nm,e,n)},e}(),s=typeof window!="undefined"?window:{},s.EpicMvc=s.E=new n(s),o={Issue:e,ModelJS:t};for(i in o)r=o[i],s.E[i]=r;s._log2=function(){}}).call(this);
/*Base/app.coffee*/(function(){var e;e=function(e,t,n,r){if(e==="click"||e==="enter"||e==="keyup"&&t.keyCode===27)if(!/event:Tab:Drop:/.test(r))return E.Tab().event("Tab",e,"Drop","_CLEARED",{})},E.app$Base={OPTIONS:{render:"RenderStrategy$Base",dataAction:"dataAction$Base",event:e},MODELS:{App:{"class":"App$Base",inst:"iBaseApp"},View:{"class":"View$Base",inst:"iBaseView"},Fist:{"class":"Fist$Base",inst:"iBaseFist"},Tab:{"class":"Tab$Base",inst:"iBaseTab"},Wist:{"class":"Wist$Base",inst:"iBaseWist"}}}}).call(this);
/*Base/manifest.coffee*/(function(){E.manifest$Base={Extra:["LoadStrategy","RenderStrategy","dataAction","RestAPI"],Model:["App","View","Fist","Wist","Tab"],js:[],root:["app"]}}).call(this);
/*Base/Model/View.coffee*/(function(){"use strict";var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=function(e){function n(e,r){this.ex=t(this.ex,this),this.T_if=t(this.T_if,this),this.T_page=t(this.T_page,this),this.handleIt=t(this.handleIt,this);var i,s,o;n.__super__.constructor.call(this,e,r),i=E.appGetSetting("frames"),this.frames=function(){var e,t,n,r;n=function(){var e;e=[];for(o in i)e.push(o);return e}().sort(),r=[];for(e=0,t=n.length;e<t;e++)s=n[e],r.push(i[s]);return r}(),this.frames.push("X"),this.did_run=!1,this.in_run=!1,window.oE=this,this.defer_it_cnt=0,this.start=!1}return r(n,e),n.prototype.nest_up=function(e){return this.defer_it_cnt===0&&(this.in_run&&BLOWUP(),this.in_run=!0,this.defer_it=new m.Deferred),this.defer_it_cnt++},n.prototype.nest_dn=function(e){this.defer_it_cnt>0&&this.defer_it_cnt--;if(this.defer_it_cnt===0)return this.in_run=!1,this.defer_it.resolve([this.modal,this.defer_content])},n.prototype.run=function(){var e,t,n,r,i,s,o,u,a;s="R",o=E.App().getStepPath(),e=o[0],i=o[1],r=o[2];if(n=E.appFindAttr(e,i,r,"modal"))n=(u=E.appGetSetting("modals")[n])!=null?u:n;return t=n!=null?n:E.appGetSetting("layout",e,i,r),this.modal=n?!0:!1,this.page_name=(a=E.appGetS(e,i,r).page)!=null?a:r,this.did_run=!0,this.frames[this.frames.length-1]=t,this.frame_inx=0,this.resetInfo(),this.nest_up(s),this.defer_content=this.kids([["page",{}]]),this.nest_dn(s),this.defer_it.promise},n.prototype.resetInfo=function(){return this.R={},this.I={},this.P=[{}],this.N={}},n.prototype.saveInfo=function(){var e;return e=E.merge({},{I:this.I,P:this.P}),e},n.prototype.restoreInfo=function(e){var t,n;this.resetInfo(),this.P=e.P,this.I=e.I,n=[];for(t in this.I)t in this.R||n.push(this.R[t]=this._getMyRow(this.I[t]));return n},n.prototype._getMyRow=function(e){if(e.m!=null)return E[e.m](e.o)[e.c];e.p in this.R||(this.R[e.p]=this._getMyRow(this.I[e.p]));if(e.p&&e.p in this.R)return this.R[e.p][e.o][e.c]},n.prototype.getTable=function(e){switch(e){case"If":return[this.N];case"Part":return this.P.slice(-1);default:return[]}},n.prototype.invalidateTables=function(e,t,n){if(!this.did_run||!n.length)return;m.startComputation(),m.endComputation()},n.prototype.handleIt=function(e){return typeof e=="function"&&(e=e()),e},n.prototype.formatFromSpec=function(e,t,n){var r,i,s,o,u;switch(t){case"":return n?typeof (o=window.EpicMvc).custom_filter=="function"?o.custom_filter(e,n):void 0:e;case"count":return e!=null?e.length:void 0;case"bool":return e?!0:!1;case"bytes":return window.bytesToSize(Number(e));case"uriencode":return encodeURIComponent(e);case"quo":return e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"');case"1":return String(e)[0];case"lc":return String(e).toLowerCase();case"ucFirst":return s=String(s).toLowerCase(),s.slice(0,1).toUpperCase()+s.slice(1);default:return t[0]==="?"?(u=t.slice(1).split("?"),r=u[0],i=u[1],(e?r:i!=null?i:"").replace(new RegExp("[%]","g"),e)):E.option.v1(e,t)}},n.prototype.v3=function(e,t,n,r,i){var s,o;return s=E[e](t)[0],o=s[n],r!=null?this.formatFromSpec(o,r,i):o},n.prototype.v2=function(e,t,n,r){var i;return t[0]==="_"?i=this.R[e]._[t.slice(1).toLowerCase()]:i=this.R[e][t],n!=null?this.formatFromSpec(i,n,r):i},n.prototype.weed=function(e){var t,n,r;t={};for(n in e)r=e[n],n[0]!=="?"?t[n]=r:r&&(t[n.slice(1)]=r);return t},n.prototype.kids=function(e){var t,n,r,i,s,o,u,a=this;s="K",i=[];for(n=o=0,u=e.length;o<u;n=++o)r=e[n],"A"===E.type_oau(r)?(i.push(n),t=this["T_"+r[0]](r[1],r[2]),(t!=null?t.then:void 0)?(this.nest_up(s),function(e){return t.then(function(t){return i[e]=t,a.nest_dn(s)},function(t){return console.error("kids",t),i[e]=t.message,a.nest_dn(s)})}(n)):i[n]=t):i.push(r);return i},n.prototype.loadPartAttrs=function(e){var t,n,r;n={};for(t in e){r=e[t];if("data-e-"!==t.slice(0,7))continue;n[t.slice(7)]=r}return n},n.prototype.T_page=function(e){var t,n,r;return this.frame_inx<this.frames.length?(t=E.oLoader.d_layout(n=this.frames[this.frame_inx++]),r=(this.frame_inx<this.frames.length?"Frame":"Layout")+"/"+n):(t=E.oLoader.d_page(n=this.page_name),r="Page/"+n),this.piece_handle(r,e!=null?e:{},t)},n.prototype.T_part=function(e){var t,n;return n=e.part,t=E.oLoader.d_part(n),this.piece_handle("Part/"+n,e,t,!0)},n.prototype.piece_handle=function(e,t,n,r){var i,s;return(n!=null?n.then:void 0)?this.D_piece(e,t,n,r):(s=n.content,i=n.can_componentize,this.P.push(this.loadPartAttrs(t)),s=this.handleIt(s))},n.prototype.D_piece=function(e,t,n,r){var i,s,o,u=this;return o="P",this.nest_up(o+e),s=this.saveInfo(),i=n.then(function(n){var i;try{return(n!=null?n.then:void 0)&&BLOWUP(),u.restoreInfo(s),i=u.piece_handle(e,t,n,r),i}finally{u.nest_dn(o+e)}},function(n){return console.error("D_piece",n),u.nest_dn(o+e+" IN-ERROR"),u._Err("tag","page/part",t,n)}),i},n.prototype.T_if_true=function(e,t){return this.N[e.name]?this.handleIt(t()):""},n.prototype.T_if_false=function(e,t){return this.N[e.name]?"":this.handleIt(t)},n.prototype.T_if=function(e,t){var n,r,s,o,u;r=!1,n=!1;if("val"in e)if("eq"in e)e.val===e.eq&&(n=!0);else if("ne"in e)e.val!==e.ne&&(n=!0);else if("gt"in e)e.val>e.gt&&(n=!0);else if("in_list"in e){if(o=e.val,i.call(e.in_list.split(","),o)>=0)n=!0}else if("not_in_list"in e){if(u=e.val,i.call(e.not_in_list.split(","),u)<0)n=!0}else r=!0;else"set"in e?n=e.set?!0:!1:"not_set"in e?n=e.not_set?!1:!0:"table_is_empty"in e?(s=this._accessModelTable(e.table_is_empty,!1),s.length||(n=!0)):"table_is_not_empty"in e?(s=this._accessModelTable(e.table_is_not_empty,!1),s.length&&(n=!0)):r=!0;return r&&console.log("ISSUE T_if",e),"name"in e&&(this.N[e.name]=n),n&&t?this.handleIt(t):""},n.prototype._accessModelTable=function(e,t){var n,r,i,s,o,u;return u=e.split("/"),n=u[0],r=u[1],n in this.R?(o=this.R[n][r],s={p:n}):(o=E[n](r),s={m:n}),t===!1?o:(i=t!=null?t:r,o.length===0?[o,i]:(s.o=r,this.I[i]=s,[o,i]))},n.prototype.T_foreach=function(e,t){var n,r,i,s,o,u,a,f,l;l=this._accessModelTable(e.table,e.alias),u=l[0],s=l[1];if(u.length===0)return"";i=[],r="limit"in e?Number(e.limit)-1:u.length;for(n=a=0,f=u.length;a<f;n=++a)o=u[n],o=u[n],o._={count:n,first:n===0,last:n===r-1,"break":!1},this.R[s]=o,this.I[s].c=n,i.push(this.handleIt(t));return delete this.I[s],delete this.R[s],i},n.prototype.T_fist=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,S,x=this;return i=E.fistDef[e.fist],u=(d=i.event)!=null?d:"Fist",h=e.fist+(e.row!=null?":"+e.row:""),c=(v=(m=e.via)!=null?m:i.via)!=null?v:"Control",o="Fist",g=this._accessModelTable(u+"/"+h,o),p=g[0],l=g[1],this.R[l]=p[0],this.I[l].c=0,f=l,r=t?t:(a=(y=(b=e.part)!=null?b:i.part)!=null?y:"fist_default",(w=e.part)!=null?w:e.part=(S=i.part)!=null?S:"fist_default",function(){return x.kids([["part",{part:a}]])}),s={table:o+"/"+c},e.alias!=null&&(s.alias=e.alias),n=this.T_foreach(s,r),delete this.R[f],delete this.I[f],n},n.prototype.ex=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d;r=e.attributes,d=[];for(o=c=0,h=r.length;0<=h?c<h:c>h;o=0<=h?++c:--c){if("data-ex-"!==r[o].name.slice(0,8))continue;p=r[o].name.split("-"),i=p[0],s=p[1],u=p[2],a=p[3],f=p[4],l=r[o].value,d.push(E["ex$"+u](e,t,n,l,a,f))}return d},n}(E.ModelJS),E.Model.View$Base=e}).call(this);
/*Base/Model/Fist.coffee*/(function(){"use strict";var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(e,n){this.fist={},t.__super__.constructor.call(this,e,n)}return n(t,e),t.prototype.eventLogout=function(){return!0},t.prototype.event=function(e,n,r,i,s){var o,u,a,f,l,c,h,p;e!=="Fist"&&BLOWUP(),u=this._getFist(r,s.row),i&&(o=u.ht[i]);switch(n){case"keyup":case"change":o.type==="yesno"&&(s.val===o.cdata[0]?s.val=o.cdata[1]:s.val=o.cdata[0]);if(o.hval!==s.val){a=o.issue,o.hval=s.val,c=E.fistH2H(o,o.hval),E.fistVAL(o,c);if(n==="change"||a!==o.issue)f=!0}break;case"blur":p=o.hval,h=o.issue,o.hval=E.fistH2H(o,o.hval),E.fistVAL(o,o.hval);if(p!==o.hval||h!==o.issue)f=!0;break;case"focus":u.fnm!==i&&(u.fnm=i);break;default:return t.__super__.event.call(this,e,n,r,i,s)}l=this.confirm(u,o,n);if(f||l)s.async!==!0?this.invalidateTables([u.rnm]):delete this.Table[u.rnm]},t.prototype.confirm=function(e,t,n){var r,i,s,o,u,a,f;return t.confirm==null&&t.confirm_src==null?!1:(s=t.confirm_src!=null?t:e.ht[t.confirm],i=e.ht[s.confirm_src],s.issue!=null?i.issue!=null?(delete i.issue,!0):!1:(f=i.hval,f===""&&i.fieldNm!==t.fieldNm?!1:(a=i.issue,u=E.fistH2H(s,f),o=E.fistH2H(s,s.hval),u===o?delete i.issue:(r="FIELD_ISSUE"+(i.issue_text?"_TEXT":""),this._makeIssue(r,i)),a!==i.issue)))},t.prototype._makeIssue=function(e,t){var n,r;return n=e,"A"!==E.type_oau(n)&&(n=[n,t.nm,(r=t.label)!=null?r:t.nm,t.issue_text]),t.issue=new E.Issue(t.fistNm,t.nm),t.issue.add(n[0],n.slice(1))},t.prototype.fistClear=function(e,t){var n;return n=e+(t?":"+t:""),delete this.fist[n]},t.prototype.fistValidate=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p;l=e,u=this._getFist(t,n),i=0,c=u.ht;for(o in c)s=c[o],!0!==E.fistVAL(s,s.hval)&&i++;h=u.ht;for(o in h)s=h[o],s.confirm!=null&&!0===this.confirm(u,s,"fistValidate")&&i++;if(i)a=!0,l.fist$success="FAIL",l.fist$errors=i;else{l.fist$success="SUCCESS",r=l[u.nm]={},p=u.db;for(f in p)s=p[f],r[f]=E.fistH2D(s,s.hval)}a===!0&&this.invalidateTables([u.rnm])},t.prototype.loadTable=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;h=e.split(":"),i=h[0],f=h[1],u=this._getFist(i,f),n={},t=[],r=!1,p=u.sp.FIELDS;for(a=l=0,c=p.length;l<c;a=++l)o=p[a],s=u.ht[o],f=this._makeField(u,s,a,f),f.req&&(r=!0),n[o]=[f],t.push(f);return this.Table[e]=[{Field:[n],Control:t,any_req:r}]},t.prototype._makeField=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p;o={is_first:n===0,focus:e.fnm===t.nm,yes_val:"X",req:!1,"default":"",width:"",size:"",issue:"",value:"",selected:!1,name:t.nm},u=E.merge(o,t),c=u.type.split(":"),u.type=c[0],i=c[1],u.id="U"+E.nextCounter(),u.value=t.hval,u.type==="yesno"&&((h=u.cdata)==null&&(u.cdata=["1","0"]),u.yes_val=String(u.cdata[0]),u.value===u.yes_val?u.selected=!0:u.value=u.cdata[1]),t.issue&&(u.issue=t.issue.asTable()[0].issue);if(u.type==="radio"||u.type==="pulldown"){s=this._getChoices(i,e,t,r),a=[],f="";for(n=l=0,p=s.options.length;0<=p?l<p:l>p;n=0<=p?++l:--l)f=s.values[n]===String(u.value),a.push({option:s.options[n],value:s.values[n],selected:f}),u.Choice=a}return u},t.prototype._getFist=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;a=e+(t?":"+t:"");if(a in this.fist)s=this.fist[a];else{s={rnm:a,nm:e,row:t,ht:{},db:{},st:"new",sp:E.fistDef[e]},c=s.sp.FIELDS;for(f=0,l=c.length;f<l;f++)i=c[f],r=E.merge({},E.fieldDef[i],{nm:i,fistNm:e,row:t}),r.h2h=function(){switch(E.type_oau(r.h2h)){case"S":return r.h2h.split(/[:,]/);case"A":return r.h2h;default:return[]}}(),s.ht[i]=s.db[r.db_nm]=r;h=s.ht;for(i in h)u=h[i],u.confirm!=null&&(s.ht[u.confirm].confirm_src=i);this.fist[a]=s}if(s.st==="new"){n=(p=E[E.appFist(e)]().fistGetValues(e,t))!=null?p:{},d=s.db;for(o in d)r=d[o],r.hval=E.fistD2H(r,n[o]);s.st="loaded"}return s},t.prototype._getChoices=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m;i=[],a=[];switch(e){case"array":d=n.cdata;for(l=0,h=d.length;l<h;l++)s=d[l],typeof s=="object"?(i.push(String(s[1])),a.push(String(s[0]))):(i.push(String(s)),a.push(String(s)));return{options:i,values:a};case"wist":v=n.cdata.split(":"),f=v[0],u=v[1],r=v[2],m=E.Wist(f);for(c=0,p=m.length;c<p;c++)o=m[c],i.push(o[r]),a.push(o[u]);return{options:i,values:a};case"custom":return E[E.appFist(t.nm)]().fistGetChoices(t.nm,n.nm,t.row);default:return E.option.fi4(e,t,n)}},t}(E.ModelJS),E.fistH2H=function(e,t){var n,r,i,s;t=E.fistH2H$pre(e,t),s=e.h2h;for(r=0,i=s.length;r<i;r++)n=s[r],t=E["fistH2H$"+n](e,t);return t},E.fistH2H$pre=function(e,t){return t},E.fistH2D=function(e,t){return e.h2d?E["fistH2D$"+e.h2d](e,t):t},E.fistD2H=function(e,t){var n;return e.d2h?E["fistD2H$"+e.d2h](e,t):(n=t!=null?t:e["default"])!=null?n:""},E.fistVAL=function(e,t){var n,r,i,s,o;return delete e.issue,n=!0,t.length===0?e.req===!0&&(n=e.req_text?["FIELD_EMPTY_TEXT",e.nm,(i=e.label)!=null?i:e.nm,e.req_text]:["FIELD_EMPTY",e.nm,(s=e.label)!=null?s:e.nm]):e.validate&&(n=E["fistVAL$"+e.validate](e,t),n===!1&&(n="FIELD_ISSUE"+(e.issue_text?"_TEXT":""))),n!==!0&&(r=n,"A"!==E.type_oau(r)&&(r=[r,e.nm,(o=e.label)!=null?o:e.nm,e.issue_text]),e.issue=new E.Issue(e.fistNm,e.nm),e.issue.add(r[0],r.slice(1))),n===!0},E.fistVAL$test=function(e,t){var n;return n=e.validate_expr,typeof n=="string"&&(n=new RegExp(n)),n.test(t)},E.Model.Fist$Base=e}).call(this);
/*Base/Model/Wist.coffee*/(function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(e,n){t.__super__.constructor.call(this,e,n),this.wist={}}return n(t,e),t.prototype.loadTable=function(e){return this.Table[e]=this._getWist(e).table},t.prototype._getWist=function(e){var t,n,r,i;if(!(e in this.wist)){E.option.w1(e),t=E.wistDef[e],i=[];for(n in t)r=t[n],r.token=String(n),i.push(r);this.wist[e]={hash:t,table:i}}return this.wist[e]},t}(E.ModelJS),E.Model.Wist$Base=e}).call(this);
/*Base/Model/Tab.coffee*/(function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(e,n){t.__super__.constructor.call(this,e,n),this.tabs=E.merge({Modal:{backdrop:!1}},n)}return n(t,e),t.prototype.event=function(e,t,n,r,i){var s,o,u;o=this._getTab(n,r),t=(u=o.TYPE)!=null?u:n;switch(t.toUpperCase()){case"MODAL":s=this._toggleModal(o,r);break;case"DROP":case"COLLAPSE":s=this._toggleDrop(o,r);break;default:s=this._setTab(o,r)}if(s)return this.invalidateTables([n])},t.prototype.action=function(e,n,r){var i,s,o,u;switch(n){case"toggle":this.event("Tab","click",r.group,r.item,r);break;case"clear_modal":o="Modal",s=this._getTab(o),i=!1;for(u in s)u!=="backdrop"&&s[u]===!0&&(s.backdrop=s[u]=!1,i=!0);i&&this.invalidateTables([o]);break;case"clear_drop":o="Drop",s=this._getTab(o),i=!1;for(u in s)s[u]===!0&&(s[u]=!1,i=!0);i&&this.invalidateTables([o]);break;case"clear":this.event("Tab","click",r.group,"_CLEARED",r);break;default:return t.__super__.action.call(this,e,n,r)}},t.prototype.loadTable=function(e){var t;return t=this._getTab(e),this.Table[e]=[t]},t.prototype._getTab=function(e,t){var n,r,i,s;return(i=(n=this.tabs)[e])==null&&(n[e]={}),t!=null&&(s=(r=this.tabs[e])[t])==null&&(r[t]=!1),this.tabs[e]},t.prototype._toggleModal=function(e,t){var n,r,i;if(t==="_CLEARED"){n=!1;for(r in e)r!=="backdrop"&&r!==t&&e[r]===!0&&(n=!0,e.backdrop=e[r]=!1)}else if(e[t]!==!0){n=!0,i=e.backdrop=e[t]=!0;for(r in e)r!=="backdrop"&&r!==t&&e[r]===!0&&(e[r]=!1)}return n},t.prototype._toggleDrop=function(e,t){var n,r,i;if(t==="_CLEARED"){n=!1;for(r in e)r!==t&&e[r]===!0&&(n=!0,e[r]=!1)}else{n=!0,i=e[t]=!e[t];if(i===!0)for(r in e)r!==t&&e[r]===!0&&(e[r]=!1)}return n},t.prototype._setTab=function(e,t){var n;if(e[t]===!0)return!1;for(n in e)e[n]=!1;return e[t]=!0,!0},t}(E.ModelJS),E.Model.Tab$Base=e,E.ex$collapse=function(e,t,n,r,i,s){var o,u,a,f;return f=r.split(":"),o=f[0],a=f[1],u=E.Tab(o)[0][a]?e.scrollHeight:0,e.style.height=String(u)+"px"}}).call(this);
/*Base/Model/App.coffee*/(function(){"use strict";var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(e,n){var r;r={f:null,t:null,s:null,sp:[]},t.__super__.constructor.call(this,e,n,r),this.clear()}return n(t,e),t.prototype.clear=function(){return this.issues=new E.Issue(this.view_nm),this.messages=new E.Issue(this.view_nm),this.invalidateTables(["Issue","Message"])},t.prototype.goTo=function(e,t,n){var r;r=""+this.f+"/"+this.t+"/"+this.s,this.f=e,this.t=t,this.s=n;if(r!==""+this.f+"/"+this.t+"/"+this.s)return this.invalidateTables(["V"])},t.prototype.go=function(e){var t,n,r,i;return i=e.split("/"),t=i[0],r=i[1],n=i[2],t||(t=this.f,r||(r=this.t)),r||(r=E.appStartT(t)),n||(n=E.appStartS(t,r)),this.goTo(t,r,n)},t.prototype.appGet=function(e){return E.appGetSetting(e,this.f,this.t,this.s)},t.prototype.getStepPath=function(){return[this.f,this.t,this.s]},t.prototype.action=function(e,n,r){var i,s,o,u,a,f,l,c;f=e.r,s=e.i,o=e.m;switch(n){case"path":return this.go(r.path);case"push":return this.sp.push([this.f,this.t,this.s]);case"pop":if(this.sp.length)return a=this.sp.pop(),this.goTo(a[0],a[1],a[2]);break;case"add_message":return o.add(r.type,r.msgs);case"add_issue":return s.add(r.type,r.msgs);case"clear":return this.clear();case"route":return u=E.appSearchAttr("route",r.route),u===!1?f.success="FAIL":(this.goTo(u[0],u[1],u[2]),f.success="SUCCESS");case"parse_hash":return c=r.hash.split("~"),l=c[0],i=c[1],i!=null?E.merge(f,{type:"code",route:l,code:i}):(u=E.appSearchAttr("route",l),u===!1?f.success="FAIL":E.merge(f,{type:"path",path:u.join("/")}));default:return t.__super__.action.call(this,e,n,r)}},t.prototype.setIssues=function(e){return(e!=null?e.count():void 0)!==0&&this.issues.addObj(e),this.invalidateTables(["Issue"])},t.prototype.setMessages=function(e){return(e!=null?e.count():void 0)!==0&&this.messages.addObj(e),this.invalidateTables(["Message"])},t.prototype.loadTable=function(e){var n;n=E["issues$"+this.appGet("group")],this.Table[e]=function(){switch(e){case"Message":return this.messages.asTable(n);case"Issue":return this.issues.asTable(n);case"V":return[E.appGetVars(this.f,this.t,this.s)];default:return t.__super__.loadTable.call(this,e)}}.call(this)},t}(E.ModelJS),E.Model.App$Base=e}).call(this);
/*Base/Extra/dataAction.coffee*/(function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;typeof (h=E.option).activity=="function"&&h.activity(e),r=t.split(","),i=!0,f=!1;for(p=0,d=r.length;p<d;p++){a=r[p],v=a.split(":"),c=v[0],l=v[1],s=v[2],u=v[3],o=v[4],l||(l=c,c="click"),c==="event"&&E.event(l,e,s,u,o,n);if(i&&c===e){if(c==="click"||c==="rclick")f=!0;i=!1,E.action(l,n)}}return f},E.Extra.dataAction$Base=e,E.event=function(e,n,r,i,s,o){var u,a;if(s!=="all"){u=s.split("-");if(t.call(u,n)<0)return}return e==="Fist"&&(e=(a=E.fistDef[r].event)!=null?a:e),E[e]().event(e,n,r,i,o)}}).call(this);
/*Base/Extra/LoadStrategy.coffee*/(function(){var e;e=function(){function e(e){var t;this.reverse_packages=function(){var n,r,s;s=[];for(t=n=r=e.length-1;r<=0?n<=0:n>=0;t=r<=0?++n:--n)s.push(e[t]);return s}()}return e.prototype.getArtifact=function(e,t){var n,r,i,s,o,u,a,f;r=!1,o=this.reverse_packages;for(i=0,s=o.length;i<s;i++){n=o[i],r=(u=(a=E["view$"+n])!=null?(f=a[t])!=null?f[e]:void 0:void 0)!=null?u:!1;if(r!==!1)break}return r===!1&&console.log("NO FILE FOUND! "+e),r},e.prototype.D_loadAsync=function(){var e;return e=new m.Deferred,e.resolve(),e.promise},e.prototype.d_layout=function(e){return this.getArtifact(e,"Layout")},e.prototype.d_page=function(e){return this.getArtifact(e,"Page")},e.prototype.d_part=function(e){return this.getArtifact(e,"Part")},e}(),E.Extra.LoadStrategy$Base=e,E.opt({loader:"LoadStrategy$Base"})}).call(this);
/*Base/Extra/RestAPI.coffee*/(function(){"use strict";var e;e=function(){function e(e){var t,n,r,i,s;this.opts={port:"",prefix:"",version:""};for(t in e)i=e[t],this.opts[t]=i;n=String(this.opts.port),n.length&&(n=":"+n),this.opts.prefix.length&&(r="/"+this.opts.prefix),this.opts.version.length&&(s="/"+this.opts.version),this.route_prefix="//"+this.opts.host+(n!=null?n:"")+(r!=null?r:"")+(s!=null?s:"")+"/",this.SetToken(!1)}return e.prototype.GetPrefix=function(){return this.route_prefix},e.prototype.GetToken=function(){return this.token},e.prototype.SetToken=function(e){this.token=e},e.prototype.D_Request=function(e,t,n,r){var i;return i={code:!1,text:!1,ok:!1},m.request({background:!0,method:e,url:this.route_prefix+t,data:n,config:function(e){var t,n,i;i=r!=null?r:{};for(t in i)n=i[t],e.setRequestHeader(t,n)},unwrapSuccess:function(e){return{status:i,data:e}},unwrapError:function(e){return{status:i,data:e}},extract:function(e,t){return i.code=e.status,i.text=e.statusText,e.status===200&&(i.ok=!0),!e.responseText.length&&e.readyState===4?(i.text="NetworkError",'{"error":"NETWORK_ERROR"}'):e.responseText}}).then(null,function(e){return e})},e.prototype.D_Get=function(e,t){return this.D_RequestAuth("GET",e,t)},e.prototype.D_Post=function(e,t){return this.D_RequestAuth("POST",e,t)},e.prototype.D_Del=function(e,t){return this.D_RequestAuth("DEL",e,t)},e.prototype.D_Put=function(e,t){return this.D_RequestAuth("PUT",e,t)},e.prototype.D_RequestAuth=function(e,t,n,r){var i,s,o=this;return s=this.GetToken(),s===!1?(setTimeout(function(){return E.action("Request.no_token")},0),i=new m.Deferred,i.resolve({status:{code:401,text:"NO_TOKEN",ok:!1},data:{error:"TOKEN"}}),i.promise):(r==null&&(r={}),r.Authorization=""+s.token_type+" "+s.access_token,this.D_Request(e,t,n,r).then(function(e){return status.code===401?(setTimeout(function(){return E.action("Request.bad_token")},0),{status:{code:401,text:"BAD_TOKEN",ok:!1},data:{error:"TOKEN"}}):e}))},e}(),E.Extra.RestAPI$Base=e}).call(this);
/*Base/Extra/RenderStrategy.coffee*/(function(){"use strict";var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}};e=13,t=function(){function t(){this.m_redraw=n(this.m_redraw,this),this.onPopState=n(this.onPopState,this),this.handleEvent=n(this.handleEvent,this);var e,t,r,i=this;this.very_first=!0,this.was_popped=!1,this.was_modal=!1,this.last_path="not_set",this.unloadMsgs={},this.baseUrl=window.document.location.pathname,this.baseId="epic-new-page",this.modalId="epic-new-modal",e=document.createElement("div"),e.id=this.baseId,document.body.appendChild(e),t=document.createElement("div"),t.id=this.modalId,document.body.appendChild(t),setTimeout(function(){return i.onPopState(!0)},0),window.onpopstate=this.onPopState,this.redraw_guard=0,r=m.redraw.strategy,m.redraw=this.m_redraw,m.redraw.strategy=r,this.init(),!0}return t.prototype.handleEvent=function(t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;t==null&&(t=window.event),h=t.type,h==="input"&&(h="change");if(h==="mousedown")if(t.which===1||t.button===1)h="click";else{if(t.which!==3&&t.button!==2)return;h="rclick"}if(h==="keyup"&&t.keyCode===9)return;h==="keyup"&&t.keyCode===e&&(h="enter"),c=t.target;if(c===window)return!1;while(c.tagName!=="BODY"&&!(r=c.getAttribute("data-e-action")))c=c.parentElement;E.option.event(h,t,c,r);if(!r)return!1;i={},n=c.attributes;for(o=d=0,v=n.length;0<=v?d<v:d>v;o=0<=v?++d:--d){if("data-e-"!==n[o].name.slice(0,7))continue;if("action"===(u=n[o].name.slice(7)))continue;i[u]=n[o].value}p=c.value,s=c.files,i.val=p,i._files=s;for(u in t){p=t[u];if(u==="touches"||u==="changedTouches"||u==="targetTouches")i[u]=t[u]}a=c.getAttribute("data-params");if(a){m=JSON.parse(a);for(u in m)l=m[u],i[u]=l}return f=E.Extra[E.option.dataAction](h,r,i),f&&t.preventDefault(),!1},t.prototype.init=function(){var e,t,n,r,i;t=["mousedown","dblclick","keyup","blur","focus","input","touchstart","touchmove","touchend"],i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(document.body.addEventListener(e,this.handleEvent,!0));return i},t.prototype.UnloadMessage=function(e,t){var n,r,i;return t?this.unloadMsgs[e]=t:delete this.unloadMsgs[e],n=function(){var e,t;e=this.unloadMsgs,t=[];for(r in e)i=e[r],t.push(i);return t}.call(this),n=n.length?n.join("\n"):null,window.onbeforeunload=function(){return n}},t.prototype.onPopState=function(e){if(e===!0||!e.state)if(this.was_popped||!this.very_first)return;this.was_popped=!0,this.very_first?E.action("browser_hash",{hash:location.hash.substr(1)}):(e.state&&E.setModelState(e.state),m.startComputation(),m.endComputation())},t.prototype.m_redraw=function(){var e=this;this.redraw_guard++;if(this.redraw_guard!==1)return;return E.View().run().then(function(t){var n,r;r=t[0],n=t[1],_log2("DEFER-R","RESULTS: modal, content",e.redraw_guard,r,n),e.render(r,n),e.redraw_guard--;if(e.redraw_guard!==0)return e.redraw_guard=0,setTimeout(function(){return e.m_redraw()},16)}).then(null,function(e){return console.error("RenderStrategy$Base m_redraw",e)})},t.prototype.render=function(e,t){var n;e?m.render(n=document.getElementById(this.modalId),t):(this.was_modal&&m.render(document.getElementById(this.modalId),[]),m.render(n=document.getElementById(this.baseId),m("div",{},t))),e||this.handleRenderState(),this.was_modal=e,this.was_popped=!1,this.very_first=!1},t.prototype.handleRenderState=function(){var e,t,n,r,i,s,o,u,a;i=E.App().getStepPath(),s=i.join("/"),t=s===this.last_path?"replace":!0;if(!t)return;e="",r=(a=E.appFindAttr(i[0],i[1],i[2],"route"))!=null?a:!1,r!==!1&&(e=r),n=E.getModelState(),this.very_first||t==="replace"?typeof (o=window.history).replaceState=="function"&&o.replaceState(n,e,"#"+e):!this.was_popped&&t===!0&&(typeof (u=window.history).pushState=="function"&&u.pushState(n,e,"#"+e),window.document.title=e),this.last_path=s},t}(),E.Extra.RenderStrategy$Base=t}).call(this);
E.view$Base={
Layout: {
"default":{preloaded:1,can_componentize:false,defer:0,content:function(){return oE.kids([['page',{}]])}}},
Page: {
"default":{preloaded:1,can_componentize:true,defer:0,content:function(){return [{tag:'b',attrs:{},children:['A Base Page']}]}}},
Part: {
}};

