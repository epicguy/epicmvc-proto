/* Copyright 2007-2017 by James Shelby, shelby (at:) dtsol.com; All rights reserved. */
var m=function e(t,n){var r="[object Object]",i="[object Array]",l="[object String]",a="function";var o={}.toString;var s=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,f=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/;var d=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;var c=function(){};var u,h,v,g;function m(e){u=e.document;h=e.location;g=e.cancelAnimationFrame||e.clearTimeout;v=e.requestAnimationFrame||e.setTimeout}m(t);function p(){var e=[].slice.call(arguments);var t=e[1]!=null&&o.call(e[1])===r&&!("tag"in e[1]||"view"in e[1])&&!("subtree"in e[1]);var n=t?e[1]:{};var a="class"in n?"class":"className";var d={tag:"div",attrs:{}};var c,u=[];if(o.call(e[0])!=l)throw new Error("selector in m(selector, attrs, children) should be a string");while(c=s.exec(e[0])){if(c[1]===""&&c[2])d.tag=c[2];else if(c[1]==="#")d.attrs.id=c[2];else if(c[1]===".")u.push(c[2]);else if(c[3][0]==="["){var h=f.exec(c[3]);d.attrs[h[1]]=h[3]||(h[2]?"":true)}}var v=t?e.slice(2):e.slice(1);if(v.length===1&&o.call(v[0])===i){d.children=v[0]}else{d.children=v}for(var g in n){if(n.hasOwnProperty(g)){if(g===a&&n[g]!=null&&n[g]!==""){u.push(n[g]);d.attrs[g]=""}else d.attrs[g]=n[g]}}if(u.length>0)d.attrs[a]=u.join(" ");return d}function y(e,t,s,f,h,v,g,m,C,E,k){try{if(h==null||h.toString()==null)h=""}catch(A){h=""}if(h.subtree==="retain")return v;var O=o.call(v),M=o.call(h);if(v==null||O!==M){if(v!=null){if(s&&s.nodes){var T=m-f;var j=T+(M===i?h:v.nodes).length;N(s.nodes.slice(T,j),s.slice(T,j))}else if(v.nodes)N(v.nodes,v)}v=new h.constructor;if(v.tag)v={};v.nodes=[]}if(M===i){for(var B=0,S=h.length;B<S;B++){if(o.call(h[B])===i){h=h.concat.apply([],h);B--;S=h.length}}var $=[],L=v.length===h.length,R=0;var D=1,H=2,I=3;var _={},F=false;for(var B=0;B<v.length;B++){if(v[B]&&v[B].attrs&&v[B].attrs.key!=null){F=true;_[v[B].attrs.key]={action:D,index:B}}}var G=0;for(var B=0,S=h.length;B<S;B++){if(h[B]&&h[B].attrs&&h[B].attrs.key!=null){for(var U=0,S=h.length;U<S;U++){if(h[U]&&h[U].attrs&&h[U].attrs.key==null)h[U].attrs.key="__mithril__"+G++}break}}if(F){var q=false;if(h.length!=v.length)q=true;else for(var B=0,J,V;J=v[B],V=h[B];B++){if(J.attrs&&V.attrs&&J.attrs.key!=V.attrs.key){q=true;break}}if(q){for(var B=0,S=h.length;B<S;B++){if(h[B]&&h[B].attrs){if(h[B].attrs.key!=null){var W=h[B].attrs.key;if(!_[W])_[W]={action:H,index:B};else _[W]={action:I,index:B,from:_[W].index,element:v.nodes[_[W].index]||u.createElement("div")}}}}var Y=[];for(var z in _)Y.push(_[z]);var Q=Y.sort(w);var X=new Array(v.length);X.nodes=v.nodes.slice();for(var B=0,Z;Z=Q[B];B++){if(Z.action===D){N(v[Z.index].nodes,v[Z.index]);X.splice(Z.index,1)}if(Z.action===H){var ee=u.createElement("div");ee.key=h[Z.index].attrs.key;e.insertBefore(ee,e.childNodes[Z.index]||null);X.splice(Z.index,0,{attrs:{key:h[Z.index].attrs.key},nodes:[ee]});X.nodes[Z.index]=ee}if(Z.action===I){if(e.childNodes[Z.index]!==Z.element&&Z.element!==null){e.insertBefore(Z.element,e.childNodes[Z.index]||null)}X[Z.index]=v[Z.from];X.nodes[Z.index]=Z.element}}v=X}}for(var B=0,te=0,S=h.length;B<S;B++){var ne=y(e,t,v,m,h[B],v[te],g,m+R||R,C,E,k);if(ne===n)continue;if(!ne.nodes.intact)L=false;if(ne.$trusted){R+=(ne.match(/<[^\/]|\>\s*[^<]/g)||[0]).length}else R+=o.call(ne)===i?ne.length:1;v[te++]=ne}if(!L){for(var B=0,S=h.length;B<S;B++){if(v[B]!=null)$.push.apply($,v[B].nodes)}for(var B=0,re;re=v.nodes[B];B++){if(re.parentNode!=null&&$.indexOf(re)<0)N([re],[v[B]])}if(h.length<v.length)v.length=h.length;v.nodes=$}}else if(h!=null&&M===r){var ie=[],le=[];while(h.view){var ae=h.view.$original||h.view;var oe=p.redraw.strategy()=="diff"&&v.views?v.views.indexOf(ae):-1;var se=oe>-1?v.controllers[oe]:new(h.controller||c);var W=h&&h.attrs&&h.attrs.key;h=P==0||v&&v.controllers&&v.controllers.indexOf(se)>-1?h.view(se):{tag:"placeholder"};if(h.subtree==="retain")return v;if(W){if(!h.attrs)h.attrs={};h.attrs.key=W}if(se.onunload)K.push({controller:se,handler:se.onunload});ie.push(ae);le.push(se)}if(!h.tag&&le.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");if(!h.attrs)h.attrs={};if(!v.attrs)v.attrs={};var fe=Object.keys(h.attrs);var de=fe.length>("key"in h.attrs?1:0);if(h.tag!=v.tag||fe.sort().join()!=Object.keys(v.attrs).sort().join()||h.attrs.id!=v.attrs.id||h.attrs.key!=v.attrs.key||p.redraw.strategy()=="all"&&(!v.configContext||v.configContext.retain!==true)||p.redraw.strategy()=="diff"&&v.configContext&&v.configContext.retain===false){if(v.nodes.length)N(v.nodes);if(v.configContext&&typeof v.configContext.onunload===a)v.configContext.onunload();if(v.controllers){for(var B=0,se;se=v.controllers[B];B++){if(typeof se.onunload===a)se.onunload({preventDefault:c})}}}if(o.call(h.tag)!=l)return;var re,ce=v.nodes.length===0;if(h.attrs.xmlns)E=h.attrs.xmlns;else if(h.tag==="svg")E="http://www.w3.org/2000/svg";else if(h.tag==="math")E="http://www.w3.org/1998/Math/MathML";if(ce){if(h.attrs.is)re=E===n?u.createElement(h.tag,h.attrs.is):u.createElementNS(E,h.tag,h.attrs.is);else re=E===n?u.createElement(h.tag):u.createElementNS(E,h.tag);v={tag:h.tag,attrs:de?x(re,h.tag,h.attrs,{},E):h.attrs,children:h.children!=null&&h.children.length>0?y(re,h.tag,n,n,h.children,v.children,true,0,h.attrs.contenteditable?re:C,E,k):h.children,nodes:[re]};if(le.length){v.views=ie;v.controllers=le;for(var B=0,se;se=le[B];B++){if(se.onunload&&se.onunload.$old)se.onunload=se.onunload.$old;if(P&&se.onunload){var ue=se.onunload;se.onunload=c;se.onunload.$old=ue}}}if(v.children&&!v.children.nodes)v.children.nodes=[];if(h.tag==="select"&&"value"in h.attrs)x(re,h.tag,{value:h.attrs.value},{},E);e.insertBefore(re,e.childNodes[m]||null)}else{re=v.nodes[0];if(de)x(re,h.tag,h.attrs,v.attrs,E);v.children=y(re,h.tag,n,n,h.children,v.children,false,0,h.attrs.contenteditable?re:C,E,k);v.nodes.intact=true;if(le.length){v.views=ie;v.controllers=le}if(g===true&&re!=null)e.insertBefore(re,e.childNodes[m]||null)}if(typeof h.attrs["config"]===a){var he=v.configContext=v.configContext||{};var ve=function(e,t){return function(){return e.attrs["config"].apply(e,t)}};k.push(ve(h,[re,!ce,he,v]))}}else if(typeof h!=a){var $;if(v.nodes.length===0){if(h.$trusted){$=b(e,m,h)}else{$=[u.createTextNode(h)];if(!e.nodeName.match(d))e.insertBefore($[0],e.childNodes[m]||null)}v="string number boolean".indexOf(typeof h)>-1?new h.constructor(h):h;v.nodes=$}else if(v.valueOf()!==h.valueOf()||g===true){$=v.nodes;if(!C||C!==u.activeElement){if(h.$trusted){N($,v);$=b(e,m,h)}else{if(t==="textarea")e.value=h;else if(C)C.innerHTML=h;else{if($[0].nodeType===1||$.length>1){N(v.nodes,v);$=[u.createTextNode(h)]}e.insertBefore($[0],e.childNodes[m]||null);$[0].nodeValue=h}}}v=new h.constructor(h);v.nodes=$}else v.nodes.intact=true}return v}function w(e,t){return e.action-t.action||e.index-t.index}function x(e,t,n,i,l){for(var s in n){var f=n[s];var d=i[s];if(!(s in i)||d!==f){i[s]=f;try{if(s==="config"||s=="key")continue;else if(typeof f===a&&s.indexOf("on")===0){e[s]=E(f,e)}else if(s==="style"&&f!=null&&o.call(f)===r){for(var c in f){if(d==null||d[c]!==f[c])e.style[c]=f[c]}for(var c in d){if(!(c in f))e.style[c]=""}}else if(l!=null){if(s==="href")e.setAttributeNS("http://www.w3.org/1999/xlink","href",f);else if(s==="className")e.setAttribute("class",f);else e.setAttribute(s,f)}else if(s in e&&!(s==="list"||s==="style"||s==="form"||s==="type"||s==="width"||s==="height")){if(t!=="input"||e[s]!==f)e[s]=f}else e.setAttribute(s,f)}catch(u){if(u.message.indexOf("Invalid argument")<0)throw u}}else if(s==="value"&&t==="input"&&e.value!=f){e.value=f}}return i}function N(e,t){for(var n=e.length-1;n>-1;n--){if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(r){}t=[].concat(t);if(t[n])C(t[n])}}if(e.length!=0)e.length=0}function C(e){if(e.configContext&&typeof e.configContext.onunload===a){e.configContext.onunload();e.configContext.onunload=null}if(e.controllers){for(var t=0,n;n=e.controllers[t];t++){if(typeof n.onunload===a)n.onunload({preventDefault:c})}}if(e.children){if(o.call(e.children)===i){for(var t=0,r;r=e.children[t];t++)C(r)}else if(e.children.tag)C(e.children)}}function b(e,t,n){var r=e.childNodes[t];if(r){var i=r.nodeType!=1;var l=u.createElement("span");if(i){e.insertBefore(l,r||null);l.insertAdjacentHTML("beforebegin",n);e.removeChild(l)}else r.insertAdjacentHTML("beforebegin",n)}else e.insertAdjacentHTML("beforeend",n);var a=[];while(e.childNodes[t]!==r){a.push(e.childNodes[t]);t++}return a}function E(e,t){return function(n){n=n||event;p.redraw.strategy("diff");p.startComputation();try{return e.call(t,n)}finally{F()}}}var k;var A={appendChild:function(e){if(k===n)k=u.createElement("html");if(u.documentElement&&u.documentElement!==e){u.replaceChild(e,u.documentElement)}else u.appendChild(e);this.childNodes=u.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]};var O=[],M={};p.render=function(e,t,r){var i=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var l=T(e);var a=e===u;var o=a||e===u.documentElement?A:e;if(a&&t.tag!="html")t={tag:"html",attrs:{},children:t};if(M[l]===n)N(o.childNodes);if(r===true)G(e);M[l]=y(o,null,n,n,t,M[l],false,0,null,n,i);for(var s=0,f=i.length;s<f;s++)i[s]()};p.trust=function(e){e=new String(e);e.$trusted=true;return e};function T(e){var t=O.indexOf(e);return t<0?O.push(e)-1:t}function j(e){var t=function(){if(arguments.length)e=arguments[0];return e};t.toJSON=function(){return e};return t}p.prop=j;var B=[],S=[],$=[],L=null,R=0,D=null,H=null,I=false,_,K=[];p.redraw=function(e){};p.redraw.strategy=p.prop();var P=0;p.startComputation=function(){P++};p.endComputation=function(){P=Math.max(P-1,0);if(P===0)p.redraw()};var F=function(){if(p.redraw.strategy()=="none"){P--;p.redraw.strategy("diff")}else p.endComputation()};function G(e){var t=T(e);N(e.childNodes,M[t]);M[t]=n}return p}(typeof window!="undefined"?window:{});if(typeof module!="undefined"&&module!==null&&module.exports)module.exports=m;else if(typeof define==="function"&&define.amd)define(function(){return m});
/*EpicCore*/(function(){"use strict";var t,n,e,r,i,u,o,l=[].slice,a=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};t="undefined"!=typeof exports&&null!==exports?require("E"):window.E={},r=function(e){var i,u,o,a,s,c,p,d,h,v,S,g,T,w,_,A,b,y,C,E,M,k,O,R,x,I,L,P,K,F,D,j,J,G,N,$,U,V,W,q,B,z,H,Q,X,Y,Z;J=!1,L=0,u={},i={},q={},V={},I=[],z={event:function(){},loadDirs:{}},t.nextCounter=function(){return++L},t.opt=function(t){return U(z,t)},t.camelCase=function(t,n){return null==n&&(n="-"),t.toLowerCase().replace(new RegExp(n+"(.)","g"),function(t,n){return n.toUpperCase()})},X=function(t){return{}.toString.call(t)[8]},U=function(){var t,n,r,i,u,o,f,a,s,c,p,d;r=arguments[0],c=2<=arguments.length?l.call(arguments,1):[],a="O",t="A",d="U",p="S",n=0,u={},u[a]=function(t,n){var r,u;if(X(n)!==a)return e;for(u in n)r=i(t[u],n[u]),r!==e&&(t[u]=r);return e},u[t]=function(n,r){var u,o,l,f,a;if(X(r)!==t)return e;for(o=l=0,f=r.length;f>l;o=++l)a=r[o],u=i(n[o],a),u!==e&&(n[o]=u);return e},u[d]=function(n,e){var r;switch(X(e)){case a:r={},u[a](r,e);break;case t:r=[],u[t](r,e);break;default:r=e}return r},u[p]=function(t,n){return X(n)!==d?n:t},i=function(t,e){var r,i;return n++,i=X(t),i in u||(i=p),r=u[i](t,e),n--,r};for(o=0,f=c.length;f>o;o++)s=c[o],i(r,s);return r},t.login=function(){var n,e,r;t.log(f,q),r=[];for(n in q)e=q[n],r.push("function"==typeof e.eventLogin?e.eventLogin():void 0);return r},t.logout=function(n,e){return J!==!1?void setTimeout(function(){return function(){return t.logout(n,e)}}(this),100):n?v(n,e).then(function(){return K()}):K()},K=function(){var t,n,e;e=[];for(t in q)n=q[t],("function"==typeof n.eventLogout?n.eventLogout():void 0)&&(delete V[t],e.push(delete q[t]));return e},t.run=function(n,e,r){var u;I=n,U(z,e),t.oLoader=new i[z.loader](I),u=t.oLoader.D_loadAsync(),u.then(function(){return E(),U(z,e),$(),D(),Z(),G(),"function"==typeof r&&r(),t.App().go(h.go),t.oRender=new i[z.render]})},Q=function(t){var n,e,r;null!=t&&(V=t),r=[];for(e in q)r.push("function"==typeof(n=q[e]).restoreState?n.restoreState(V[e]):void 0);return r},j=function(){var t,n,e;V={};for(t in q)n=q[t],null!=n.saveState&&(e=n.saveState())&&(V[t]=e);return V},h={frames:{},modals:{},layout:"default",go:"default//"},p={},a={},c={"default":{start:"default",TRACKS:{"default":{start:"default",STEPS:{"default":{}}}}}},d={},s={},M=function(){},E=function(){var n,e,i,u,o,l,f,v,S,g,T,w;for(i=0,o=I.length;o>i;i++){f=I[i],r=null!=(g=t["app$"+f])?g:{},r.STEPS&&U(c["default"].TRACKS["default"].STEPS,r.STEPS),r.TRACKS&&U(c["default"].TRACKS,r.TRACKS),e={SETTINGS:h,MACROS:p,ACTIONS:a,FLOWS:c,MODELS:d,OPTIONS:z};for(f in e)S=e[f],U(S,r[f])}for(w in d)if(v=d[w],v.fists)for(T=v.fists,u=0,l=T.length;l>u;u++)n=T[u],s[n]=w},k=function(t,n){return d[t][n]},w=function(t){return s[t]},T=function(t,n,e,r,i){var u,o,l,f,a,s,p,d,h;if(o=c[t]){if(n&&null!=(f=null!=(a=o.TRACKS)?a[n]:void 0)){if(e&&null!=(l=null!=(s=f.STEPS)?s[e]:void 0)&&null!=(u=null!=(p=l[r])?p[i]:void 0))return u;if(null!=(u=null!=(d=f[r])?d[i]:void 0))return u}if(null!=(u=null!=(h=o[r])?h[i]:void 0))return u}return null},g=function(t,n,e,r){var i,u,o,l,f,a;if(u=c[t]){if(n&&null!=(l=null!=(f=u.TRACKS)?f[n]:void 0)){if(e&&null!=(o=null!=(a=l.STEPS)?a[e]:void 0)&&null!=(i=o[r]))return i;if(null!=(i=l[r]))return i}if(null!=(i=u[r]))return i}return null},_=function(t){return c[t]},y=function(t,n){return c[t].TRACKS[n]},A=function(t,n,e){return c[t].TRACKS[n].STEPS[e]},x=function(t){return _(t).start},R=function(t,n){return y(t,n).start},S=function(t,n){var e;return null!=(e=T(t[0],t[1],t[2],"ACTIONS",n))?e:a[n]},b=function(t,n,e,r){var i;return n&&null!=(i=g(n,e,null!=r?r:!1,t))?i:h[t]},C=function(t,n,e){var r;return r=U({},c[t].v,c[t].TRACKS[n].v,c[t].TRACKS[n].STEPS[e].v)},O=function(t,n){var e,r,i,u,o,l,f,a;for(r in c){e=c[r],i=e.TRACKS;for(a in i){f=i[a],u=f.STEPS;for(l in u)if(o=u[l],o[t]===n)return[r,a,l];if(f[t]===n)return[r,a,f.start]}if(e[t]===n)return[r,e.start,c[e.start].start]}return!1},$=function(){var n,r,i;r=[];for(i in d)n=d[i],r.push(function(n,r){return t[n]=function(i,u,o){var l,f;return l=r.inst,l in q||(q[l]=new t.Model[r["class"]](n,r.options),l in V&&q[l].restoreState(V[l])),f=q[l],i===e?f:u===e?f.getTable(i):f.action(i,u,o)}}(i,n));return r},v=function(n,e){var r,i,u;t.log(f,e),J=n,m.startComputation(),i=function(){return m.endComputation()},u=function(n){return t.log(f,"cb:",n[0],n[1]),t.App().setIssues(n[0]),t.App().setMessages(n[1]),J=!1};try{r=o(n,e,t.App().getStepPath())}finally{null!=(null!=r?r.then:void 0)?r.then(u).then(i,function(t){throw i(),t}):(setTimeout(i,0),null!=r&&u(r))}},o=function(e,r,i){var u,o,l,a,s,c,d,h,v,g;return v=new n("App"),g=new n("App"),h=U({},r),u=S(i,e),t.log(f,"got node:",u),null==u?[v,g]:(a=function(n){var r,i,u,o,a,s,c,d,S,T,w,m,_,A,b,y,C,E,M,k,O,R,x,I,L,P,K,F;for(k=["fist","clear"],T=0,m=k.length;m>T;T++)if(F=k[T],F in n)if(a=n[F],s=null!=(O=t.fistDef[a].event)?O:"Fist","clear"===F)t[s]().fistClear(a,h.row);else if(t[s]().fistValidate(M={},a,h.row),t.merge(h,M),"SUCCESS"!==M.fist$success)return;for(C=function(){switch(X(n.pass)){case"A":return n.pass;case"S":return n.pass.split(",");default:return[]}}(),S=w=0,_=C.length;_>w;S=++w)y=C[S],y.indexOf(":")>-1&&(R=y.split(":"),b=R[0],i=R[1],h[i]=h[b],C[S]=b);x=n.set;for(y in x)L=x[y],h[y]=L;return null!=n["do"]?(d=n["do"].indexOf(".")<0)?l(p[n["do"]]):(I=n["do"].split("."),K=I[0],P=I[1],P=P?P:e,E=Promise.resolve(),M={},c=new t.Issue(K,P),A=new t.Issue(K,P),u={p:E,r:M,i:c,m:A},r=t[K](u,P,h),o=function(){var t;t=u.r;for(y in t)L=t[y],h[y]=L;return v.addObj(u.i),g.addObj(u.m)},t.log(f,"d_doLeftSide: after model called:",{view_nm:K,view_act:P,master_data:h,ans:r,r:u.r}),null!=(null!=r?r.then:void 0)?r.then(o):o(r)):void 0},s=function(n){var e,r,i,u,o,f,a,s,c,p;for(null!=n.go&&t.App().go(n.go),f=null,null==n.next&&(n.next=[]),"A"!==X(n.next)&&(n.next=[n.next]),a=n.next,r=0,u=a.length;u>r;r++){if(e=a[r],!("when"in e)){f=e;break}if("default"===e.when){f=e;break}if("string"==typeof e.when&&e.when===(null!=(s=h.success)?s:h.ok)){f=e;break}o=!0,c=e.when;for(i in c)if(p=c[i],h[i]!==p){o=!1;break}if(o){f=e;break}}return f?l(f):void 0},l=function(t){var n,e;return n=a(t),e=function(){return s(t)},null!=(null!=n?n.then:void 0)?n.then(e):e(n)},o=l(u),c=function(){return[v,g]},d=function(t){throw new Error("BLOWUP:"+t.message)},null!=(null!=o?o.then:void 0)?o.then(c,d):c(o))},P={},F={},D=function(){var n,e,r,i,u,o,l;for(e=0,r=I.length;r>e;e++)i=I[e],n=null!=(o=t["fist$"+i])?o:{},n.FIELDS&&U(P,n.FIELDS),n.FISTS&&U(F,n.FISTS);for(i in F)u=F[i],u.fistNm=i;l=[];for(i in P)u=P[i],l.push(u.fieldNm=i);return l},N={},G=function(){var n,e,r,i,u,o;for(o=[],e=0,r=I.length;r>e;e++)i=I[e],n=null!=(u=t["issues$"+i])?u:{},o.push(U(N,n));return o},Y={},Z=function(){var n,e,r,i,u,o;for(u=[],n=0,e=I.length;e>n;n++)r=I[n],o=null!=(i=t["wist$"+r])?i:{},u.push(U(Y,o));return u},H={type_oau:X,Model:u,Extra:i,option:z,action:v,merge:U,getModelState:j,setModelState:Q,appGetF:_,appGetT:y,appGetS:A,appStartT:x,appStartS:R,appFindAction:S,appGetSetting:b,appGetVars:C,appFist:w,appFindAttr:g,appSearchAttr:O,fieldDef:P,fistDef:F,issueMap:N,wistDef:Y};for(W in H)B=H[W],t[W]=B},n=function(){function n(t,n){this.t_view=t,this.t_action=n,this.issue_list=[]}return n.Make=function(t,e,r){var i;return i=new n(t),i.add(e,r),i},n.prototype.add=function(n,e){switch(t.log(f,"params:type/msgs",n,e),typeof e){case"undefined":e=[];break;case"string":e=[e]}return this.issue_list.push({token:n,more:e,t_view:this.t_view,t_action:this.t_action})},n.prototype.addObj=function(n){var e,r,i,u,o;if("object"==typeof n&&"issue_list"in n)for(o=n.issue_list,r=0,i=o.length;i>r;r++)e=o[r],u=t.merge({},e),null==u.t_view&&(u.t_view=this.t_view),null==u.t_action&&(u.t_action=this.t_action),this.issue_list.push(u)},n.prototype.count=function(){return this.issue_list.length},n.prototype.asTable=function(){var t,n,e,r,i;for(t=[],i=this.issue_list,e=0,r=i.length;r>e;e++)n=i[e],t.push({view:n.t_view,action:n.t_action,token:n.token,title:n.t_view+"#"+n.t_action+"#"+n.token+"#"+n.more.join(","),issue:this.map(n.t_view,n.t_action,n.token,n.more)});return t},n.prototype.map=function(n,e,r,i){var u,o,l,f,a,s,c,p,d;if(a=t.issueMap,"object"!=typeof a)return"(no map) "+n+"#"+e+"#"+r+"#"+i.join(",");s=[],n in a&&(e in a[n]&&s.push(a[n][e]),"default"in a[n]&&s.push(a[n]["default"])),"default"in a&&(e in a["default"]&&s.push(a["default"][e]),"default"in a["default"]&&s.push(a["default"]["default"]));for(u=0,l=s.length;l>u;u++)for(d=s[u],c=d||[],o=0,f=c.length;f>o;o++)if(p=c[o],r.match(p[0]))return this.doMap(r,p[1],i,r);return"(no match)"+n+"#"+e+"#"+r+"#"+i.join(",")},n.prototype.doMap=function(t,n,e){var r;return r=n.replace(/%([0-9])(?::([0-9]))?%/g,function(n,r,i){return"0"===r?t:i?e[r-1]||e[i-1]||"":e[r-1]||""})},n}(),e=function(){function n(t,n,e){this.view_nm=t,this.options=n,this._ModelJS={ss:e||!1},this.restoreState(!1)}return n.prototype.getTable=function(t){return this.loadTableIf(t),this.Table[t]},n.prototype.loadTableIf=function(t){return t in this.Table?void 0:this.loadTable(t)},n.prototype.restoreState=function(n){var e;if(null!=this._ModelJS.ss)for(e in this._ModelJS.ss)delete this[e];return null!=this._ModelJS.ss&&t.merge(this,this._ModelJS.ss),n&&t.merge(this,n),this.Table={}},n.prototype.saveState=function(){var n,e,r;if(e=this._ModelJS.ss,!e)return!1;r={};for(n in e)this[n]!==e[n]&&(r[n]=this[n]);return t.merge({},r)},n.prototype.invalidateTables=function(n,e){var r,i,u,o;for(null==e&&(e=[]),n===!0&&(n=function(){var t;t=[];for(o in this.Table)a.call(e,o)>=0||t.push(o);return t}.call(this)),r=[],i=0,u=n.length;u>i;i++)o=n[i],o in this.Table&&(r.push(o),delete this.Table[o]);return t.View().invalidateTables(this.view_nm,n,r)},n}(),r(),o={Issue:n,ModelJS:e};for(u in o)i=o[u],t[u]=i;t.log=function(){}}).call(this);
/*Base/app.coffee*/(function(){"use strict";var s;s=function(s,e,a,t){if(s==="click"||s==="enter"||s==="keyup"&&e.keyCode===27){if(!/event:Tab:Drop:/.test(t)){return E.Tab().event("Tab",s,"Drop","_CLEARED",{})}}};E.app$Base={OPTIONS:{render:"RenderStrategy$Base",dataAction:"dataAction$Base",event:s},MODELS:{App:{"class":"App$Base",inst:"iBaseApp"},View:{"class":"View$Base",inst:"iBaseView"},Fist:{"class":"Fist$Base",inst:"iBaseFist"},Tab:{"class":"Tab$Base",inst:"iBaseTab"},Wist:{"class":"Wist$Base",inst:"iBaseWist"}}}}).call(this);
/*Base/Model/App.coffee*/(function(){"use strict";var t,s=function(t,s){for(var i in s){if(e.call(s,i))t[i]=s[i]}function r(){this.constructor=t}r.prototype=s.prototype;t.prototype=new r;t.__super__=s.prototype;return t},e={}.hasOwnProperty;t=function(t){s(e,t);function e(t,s){var i;i={f:null,t:null,s:null,sp:[]};e.__super__.constructor.call(this,t,s,i);this.clear()}e.prototype.clear=function(){var t,s;if(((t=this.issues)!=null?t.count:void 0)!==0){this.issues=new E.Issue(this.view_nm);this.invalidateTables(["Issue"])}if(((s=this.messages)!=null?s.count:void 0)!==0){this.messages=new E.Issue(this.view_nm);return this.invalidateTables(["Message"])}};e.prototype.goTo=function(t,s,e){var i;i=this.f+"/"+this.t+"/"+this.s;this.f=t;this.t=s;this.s=e;E.log(f,{was:i,is:this.f+"/"+this.t+"/"+this.s});if(i!==this.f+"/"+this.t+"/"+this.s){return this.invalidateTables(["V"])}};e.prototype.go=function(t){var s,e,i,r;e=t.split("/"),s=e[0],r=e[1],i=e[2];if(!s){s=this.f;if(!r){r=this.t}}if(!r){r=E.appStartT(s)}if(!i){i=E.appStartS(s,r)}E.log(f,{flow:s,t:r,s:i},this.f,this.t,this.s);return this.goTo(s,r,i)};e.prototype.appGet=function(t){return E.appGetSetting(t,this.f,this.t,this.s)};e.prototype.getStepPath=function(){return[this.f,this.t,this.s]};e.prototype.action=function(t,s,i){var r,a,o,u,n,h,p,l;h=t.r,a=t.i,o=t.m;switch(s){case"path":return this.go(i.path);case"push":return this.sp.push([this.f,this.t,this.s]);case"pop":if(this.sp.length){n=this.sp.pop();return this.goTo(n[0],n[1],n[2])}break;case"add_message":return o.add(i.type,i.msgs);case"add_issue":return a.add(i.type,i.msgs);case"clear":return this.clear();case"route":u=E.appSearchAttr("route",i.route);if(u===false){return h.success="FAIL"}else{this.goTo(u[0],u[1],u[2]);return h.success="SUCCESS"}break;case"parse_hash":p=i.hash.split("~"),l=p[0],r=p[1];if(r!=null){return E.merge(h,{type:"code",route:l,code:r})}else{u=E.appSearchAttr("route",l);if(u===false){h.success="FAIL";return E.merge(h,{type:"route",route:l})}else{return E.merge(h,{type:"path",route:l,path:u.join("/")})}}break;default:return e.__super__.action.call(this,t,s,i)}};e.prototype.setIssues=function(t){if((t!=null?t.count():void 0)!==0){this.issues.addObj(t)}return this.invalidateTables(["Issue"])};e.prototype.setMessages=function(t){if((t!=null?t.count():void 0)!==0){this.messages.addObj(t)}return this.invalidateTables(["Message"])};e.prototype.loadTable=function(t){var s;s=E["issues$"+this.appGet("group")];this.Table[t]=function(){switch(t){case"Message":return this.messages.asTable(s);case"Issue":return this.issues.asTable(s);case"V":return[E.appGetVars(this.f,this.t,this.s)];default:return e.__super__.loadTable.call(this,t)}}.call(this)};return e}(E.ModelJS);E.Model.App$Base=t}).call(this);
/*Base/Model/Fist.coffee*/(function(){"use strict";var t,e=function(t,e){for(var s in e){if(i.call(e,s))t[s]=e[s]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t},i={}.hasOwnProperty,s=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++){if(e in this&&this[e]===t)return e}return-1};t=function(t){e(i,t);function i(t,e){this.fist={};i.__super__.constructor.call(this,t,e)}i.prototype.event=function(t,e,s,n,r){var l,u,a,o,h,c,p,d;E.log(f,r);if(t!=="Fist"){BLOWUP()}u=this._getFist(s,r.row,true);if(u===false){return}if(n){l=u.ht[n]}switch(e){case"keyup":case"change":if(l.type==="yesno"){if(r.val===false){r.val=l.cdata[1]}else{r.val=l.cdata[0]}}if(l.hval!==r.val){a=l.issue;l.hval=r.val;c=E.fistH2H(l,l.hval);E.fistVAL(l,c);if(e==="change"||a!==l.issue){o=true}}break;case"blur":d=l.hval;p=l.issue;l.hval=E.fistH2H(l,l.hval);E.fistVAL(l,l.hval);E.log(f,"invalidate?",d,l.hval,p,l.issue);if(d!==l.hval||p!==l.issue){o=true}break;case"focus":if(u.fnm!==n){u.fnm=n}break;default:return i.__super__.event.call(this,t,e,s,n,r)}h=this.confirm(u,l,e);if(o||h){if(r.async!==true){this.invalidateTables([u.rnm])}else{delete this.Table[u.rnm]}}};i.prototype.confirm=function(t,e,i){var s,n,r,l,f,u,a;if(!(e.confirm!=null||e.confirm_src!=null)){return false}r=e.confirm_src!=null?e:t.ht[e.confirm];n=t.ht[r.confirm_src];if(r.issue!=null){if(n.issue!=null){delete n.issue;return true}return false}a=n.hval;if(a===""&&n.fieldNm!==e.fieldNm){return false}u=n.issue;f=E.fistH2H(r,a);l=E.fistH2H(r,r.hval);if(f===l){delete n.issue}else{s="FIELD_ISSUE"+(n.issue_text?"_TEXT":"");this._makeIssue(s,n)}return u!==n.issue};i.prototype._makeIssue=function(t,e){var i,s;s=t;if("A"!==E.type_oau(s)){s=[s,e.nm,(i=e.label)!=null?i:e.nm,e.issue_text]}e.issue=new E.Issue(e.fistNm,e.nm);return e.issue.add(s[0],s.slice(1))};i.prototype.fistWipe=function(t){var e,i,n;if("A"!==E.type_oua(t)){t=t.split(",")}e=false;for(i in this.fist){if(n=i.split(":")[0],s.call(t,n)>=0){e=true;delete this.fist[i]}}if(e){return this.invalidateTables(true)}};i.prototype.fistClear=function(t,e){var i;i=t+((e!=null?e.length:void 0)?":"+e:"");if(i in this.fist){delete this.fist[i];return this.invalidateTables([i])}};i.prototype.fistValidate=function(t,e,i){var s,n,r,l,u,a,o,h,c,p,d,v;E.log(f);c=t;u=this._getFist(e,i);n=0;p=u.ht;for(l in p){r=p[l];a=E.fistH2H(r,r.hval);if(a!==r.hval){r.hval=a;o=true}if(true!==E.fistVAL(r,r.hval)){n++}}d=u.ht;for(l in d){r=d[l];if(r.confirm!=null){if(true===this.confirm(u,r,"fistValidate")){n++}}}if(n){o=true;c.fist$success="FAIL";c.fist$errors=n}else{c.fist$success="SUCCESS";s=c[u.nm]={};v=u.db;for(h in v){r=v[h];s[h]=E.fistH2D(r,r.hval)}}E.log(f,"result",c,s);if(o===true){this.invalidateTables([u.rnm])}};i.prototype.loadTable=function(t){var e,i,s,n,r,l,f,u,a,o,h,c,p,d;c=t.split(":"),n=c[0],r=c[1];u=this._getFist(n,r);i={};e=[];s=false;p=u.sp.FIELDS;for(o=a=0,h=p.length;a<h;o=++a){f=p[o];l=u.ht[f];d=this._makeField(u,l,o,d);if(d.req){s=true}i[f]=[d];e.push(d)}return this.Table[t]=[{Field:[i],Control:e,any_req:s}]};i.prototype._makeField=function(t,e,i,s){var n,r,l,f,u,a,o,h,c;l={is_first:i===0,focus:t.fnm===e.nm,yes_val:"X",req:false,"default":"",width:"",size:"",issue:"",value:"",selected:false,name:e.nm};f=E.merge(l,e);a=f.type.split(":"),f.type=a[0],n=a[1];f.value=e.hval;if(f.type==="yesno"){f.yes_val=String(f.cdata[0]);if(f.value===f.yes_val){f.selected=true}else{f.value=f.cdata[1]}}if(e.issue){f.issue=e.issue.asTable()[0].issue}if(f.type==="radio"||f.type==="pulldown"){r=this._getChoices(n,t,e,s);h=[];c="";for(i=u=0,o=r.options.length;0<=o?u<o:u>o;i=0<=o?++u:--u){c=r.values[i]===String(f.value);h.push({option:r.options[i],value:r.values[i],selected:c});f.Choice=h}}return f};i.prototype._getFist=function(t,e,i){var s,n,r,l,u,a,o,h,c,p,d,v,m;m=t+((e!=null?e.length:void 0)?":"+e:"");if(!(m in this.fist)){if(i===true){return false}l={rnm:m,nm:t,row:e,ht:{},db:{},st:"new",sp:E.fistDef[t]};E.log(f,"new fist",l);c=l.sp.FIELDS;for(u=0,a=c.length;u<a;u++){r=c[u];n=E.merge({},E.fieldDef[r],{nm:r,fistNm:t,row:e,id:"U"+E.nextCounter()});if(n.type==="yesno"){if(n.cdata==null){n.cdata=["Y",""]}if(n["default"]==null){n["default"]=n.cdata[1]}}n.h2h=function(){switch(E.type_oau(n.h2h)){case"S":return n.h2h.split(/[:,]/);case"A":return n.h2h;default:return[]}}();l.ht[r]=l.db[n.db_nm]=n}p=l.ht;for(r in p){h=p[r];if(h.confirm!=null){l.ht[h.confirm].confirm_src=r}}this.fist[m]=l}else{l=this.fist[m]}if(l.st==="new"){s=(d=E[E.appFist(t)]().fistGetValues(t,e))!=null?d:{};v=l.db;for(o in v){n=v[o];n.hval=E.fistD2H(n,s[o])}l.st="loaded"}return l};i.prototype._getChoices=function(t,e,i){var s,n,r,l,f,u,a,o,h,c,p,d,v,m;u=[];v=[];switch(t){case"array":o=i.cdata;for(s=0,r=o.length;s<r;s++){a=o[s];if(typeof a==="object"){u.push(String(a[1]));v.push(String(a[0]))}else{u.push(String(a));v.push(String(a))}}return{options:u,values:v};case"wist":h=i.cdata.split(":"),m=h[0],d=h[1],f=h[2];c=E.Wist(m);for(n=0,l=c.length;n<l;n++){p=c[n];u.push(p[f]);v.push(p[d])}return{options:u,values:v};case"custom":return E[E.appFist(e.nm)]().fistGetChoices(e.nm,i.nm,e.row)}};return i}(E.ModelJS);E.fistH2H=function(t,e){var i,s,n,r;e=E.fistH2H$pre(t,e);n=t.h2h;for(i=0,s=n.length;i<s;i++){r=n[i];e=E["fistH2H$"+r](t,e)}return e};E.fistH2H$pre=function(t,e){return e};E.fistH2D=function(t,e){if(t.h2d){return E["fistH2D$"+t.h2d](t,e)}else{return e}};E.fistD2H=function(t,e){var i;if(t.d2h){return E["fistD2H$"+t.d2h](t,e)}else{return(i=e!=null?e:t["default"])!=null?i:""}};E.fistVAL=function(t,e){var i,s,n,r,l;delete t.issue;i=true;if(e.length===0){if(t.req===true){i=t.req_text?["FIELD_EMPTY_TEXT",t.nm,(s=t.label)!=null?s:t.nm,t.req_text]:["FIELD_EMPTY",t.nm,(n=t.label)!=null?n:t.nm]}}else{if(t.validate){i=E["fistVAL$"+t.validate](t,e);if(i===false){i="FIELD_ISSUE"+(t.issue_text?"_TEXT":"")}}}if(i!==true){l=i;if("A"!==E.type_oau(l)){l=[l,t.nm,(r=t.label)!=null?r:t.nm,t.issue_text]}t.issue=new E.Issue(t.fistNm,t.nm);t.issue.add(l[0],l.slice(1))}return i===true};E.fistVAL$test=function(t,e){var i;i=t.validate_expr;if(typeof i==="string"){i=new RegExp(i)}return i.test(e)};E.Model.Fist$Base=t}).call(this);
/*Base/Model/Tab.coffee*/(function(){"use strict";var t,e=function(t,e){for(var a in e){if(r.call(e,a))t[a]=e[a]}function o(){this.constructor=t}o.prototype=e.prototype;t.prototype=new o;t.__super__=e.prototype;return t},r={}.hasOwnProperty;t=function(t){e(r,t);function r(t,e){r.__super__.constructor.call(this,t,e);this.tabs=E.merge({Modal:{backdrop:false}},e)}r.prototype.event=function(t,e,r,a,o){var i,s,l;E.log(f,{name:t,type:e,groupNm:r,itemNm:a,data:o});s=this._getTab(r,a);e=(l=s.TYPE)!=null?l:r;switch(e.toUpperCase()){case"MODAL":i=this._toggleModal(s,a);break;case"DROP":case"COLLAPSE":i=this._toggleDrop(s,a);break;default:i=this._setTab(s,a)}if(i){return this.invalidateTables([r])}};r.prototype.action=function(t,e,a){var o,i,s,l;switch(e){case"toggle":this.event("Tab","click",a.group,a.item,a);break;case"clear_modal":s="Modal";i=this._getTab(s);o=false;for(l in i){if(l!=="backdrop"&&i[l]===true){i.backdrop=i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear_drop":s="Drop";i=this._getTab(s);o=false;for(l in i){if(i[l]===true){i[l]=false;o=true}}if(o){this.invalidateTables([s])}break;case"clear":this.event("Tab","click",a.group,"_CLEARED",a);break;default:return r.__super__.action.call(this,t,e,a)}};r.prototype.loadTable=function(t){var e;e=this._getTab(t);return this.Table[t]=[e]};r.prototype._getTab=function(t,e){var r,a;if((r=this.tabs)[t]==null){r[t]={}}if(e!=null){if((a=this.tabs[t])[e]==null){a[e]=false}}return this.tabs[t]};r.prototype._toggleModal=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(a!=="backdrop"&&t[a]===true){r=true;t.backdrop=t[a]=false}}}else if(t[e]!==true){r=true;o=t.backdrop=t[e]=true;for(a in t){if(a!=="backdrop"&&a!==e&&t[a]===true){t[a]=false}}}return r};r.prototype._toggleDrop=function(t,e){var r,a,o;if(e==="_CLEARED"){r=false;for(a in t){if(t[a]===true){r=true;t[a]=false}}}else{r=true;o=t[e]=!t[e];if(o===true){for(a in t){if(a!==e&&t[a]===true){t[a]=false}}}}return r};r.prototype._setTab=function(t,e){var r;if(t[e]===true){return false}for(r in t){t[r]=false}t[e]=true;return true};return r}(E.ModelJS);E.Model.Tab$Base=t;E.ex$collapse=function(t,e,r,a,o,i){var s,l,n,u;u=a.split(":"),s=u[0],n=u[1];E.log(f,{g:s,i:n,sH:t.scrollHeight,g_row:E.Tab(s)[0]});l=E.Tab(s)[0][n]?t.scrollHeight:0;return t.style.maxHeight=String(l)+"px"}}).call(this);
/*Base/Model/View.coffee*/(function(){"use strict";var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){for(var i in e){if(n.call(e,i))t[i]=e[i]}function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r;t.__super__=e.prototype;return t},n={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++){if(e in this&&this[e]===t)return e}return-1};t=function(t){i(n,t);function n(t,i){this.ex=e(this.ex,this);this.T_if=e(this.T_if,this);this.T_page=e(this.T_page,this);this.handleIt=e(this.handleIt,this);var r,s,o;n.__super__.constructor.call(this,t,i);r=E.appGetSetting("frames");this.frames=function(){var t,e,i,n;i=function(){var t;t=[];for(o in r){t.push(o)}return t}().sort();n=[];for(t=0,e=i.length;t<e;t++){s=i[t];n.push(r[s])}return n}();this.frames.push("X");this.did_run=false;this.in_run=false;if(typeof window!=="undefined"&&window!==null){window.oE=this}this.defer_it_cnt=0;this.start=false}n.prototype.nest_up=function(t){if(this.defer_it_cnt===0){if(this.in_run){BLOWUP()}this.in_run=true;this.defer_it={promise:null,resolve:null};this.defer_it.promise=new Promise(function(t){return function(e,i){return t.defer_it.resolve=e}}(this))}return this.defer_it_cnt++};n.prototype.nest_dn=function(t){if(this.defer_it_cnt>0){this.defer_it_cnt--}if(this.defer_it_cnt===0){E.log(f,"END RUN",this.defer_content,(new Date).getTime()-this.start);this.in_run=false;return this.defer_it.resolve([this.modal,this.defer_content])}};n.prototype.run=function(){var t,e,i,n,r,s,o,l,a;a="R";n=E.App().getStepPath(),t=n[0],l=n[1],o=n[2];if(i=E.appFindAttr(t,l,o,"modal")){i=(r=E.appGetSetting("modals")[i])!=null?r:i}e=i!=null?i:E.appGetSetting("layout",t,l,o);this.N={};this.modal=i?true:false;this.page_name=(s=E.appGetS(t,l,o).page)!=null?s:o;this.did_run=true;this.frames[this.frames.length-1]=e;this.frame_inx=0;this.resetInfo();this.nest_up(a);this.defer_content=this.kids([["page",{}]]);this.nest_dn(a);return this.defer_it.promise};n.prototype.resetInfo=function(){this.R={};this.I={};this.P=[{}]};n.prototype.saveInfo=function(){var t;t=E.merge({},{I:this.I,P:this.P});return t};n.prototype.restoreInfo=function(t){var e,i;this.resetInfo();this.P=t.P;this.I=t.I;i=[];for(e in this.I){if(!(e in this.R)){i.push(this.R[e]=this._getMyRow(this.I[e]))}}return i};n.prototype._getMyRow=function(t){if(t.m!=null){return E[t.m](t.o)[t.c]}if(!(t.p in this.R)){this.R[t.p]=this._getMyRow(this.I[t.p])}if(t.p&&t.p in this.R){return this.R[t.p][t.o][t.c]}};n.prototype.getTable=function(t){var e,i,n,r,s;switch(t){case"If":return[this.N];case"Part":r={};s=this.P;for(e=0,i=s.length;e<i;e++){n=s[e];E.merge(r,n)}return[r]}};n.prototype.invalidateTables=function(t,e,i){if(!(this.did_run&&i.length)){return}m.startComputation();m.endComputation()};n.prototype.handleIt=function(t){if(typeof t==="function"){t=t()}return t};n.prototype.formatFromSpec=function(t,e,i){var n,r,s,o;switch(e){case"":if(i){return E.custom_filter(t,i)}else{return t}break;case"count":return t!=null?t.length:void 0;case"bool":if(t){return true}else{return false}case"uriencode":return encodeURIComponent(t);case"quo":return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"');case"1":return String(t)[0];case"lc":return String(t).toLowerCase();case"ucFirst":o=String(o).toLowerCase();return o.slice(0,1).toUpperCase()+o.slice(1);default:if(e[0]==="?"){r=e.slice(1).split("?"),n=r[0],s=r[1];return(t?n:s!=null?s:"").replace(new RegExp("[%]","g"),t)}}};n.prototype.v3=function(t,e,i,n,r){var s,o;s=E[t](e)[0];o=s[i];if(n!=null){return this.formatFromSpec(o,n,r)}else{return o}};n.prototype.v2=function(t,e,i,n){var r;if(e[0]==="_"){r=this.R[t]._[e.slice(1).toLowerCase()]}else{r=this.R[t][e]}if(i!=null){return this.formatFromSpec(r,i,n)}else{return r}};n.prototype.weed=function(t){var e,i,n;e={};for(i in t){n=t[i];if(i[0]!=="?"){e[i]=n}else{if(n){e[i.slice(1)]=n}}}return e};n.prototype.kids=function(t){var e,i,n,r,s,o,l;l="K";o=[];for(n=i=0,s=t.length;i<s;n=++i){r=t[n];if("A"===E.type_oau(r)){o.push(n);e=this["T_"+r[0]](r[1],r[2]);if(e!=null?e.then:void 0){this.nest_up(l);(function(t){return function(i){return e.then(function(e){o[i]=e;return t.nest_dn(l)},function(e){console.error("kids",e);o[i]=e.message;return t.nest_dn(l)})}})(this)(n)}else{o[n]=e}}else{o.push(r)}}return o};n.prototype.loadPartAttrs=function(t,e){var i,n,r;n={};for(i in t){r=t[i];if("data-e-"!==i.slice(0,7)){continue}n[e?i:i.slice(7)]=r}return n};n.prototype.T_page=function(t){var e,i,n;if(this.frame_inx<this.frames.length){e=E.oLoader.d_layout(i=this.frames[this.frame_inx++]);n=(this.frame_inx<this.frames.length?"Frame":"Layout")+"/"+i}else{e=E.oLoader.d_page(i=this.page_name);n="Page/"+i}return this.piece_handle(n,t!=null?t:{},e)};n.prototype.T_part=function(t){var e,i;i=t.part;e=E.oLoader.d_part(i);return this.piece_handle("Part/"+i,t,e,true)};n.prototype.piece_handle=function(t,e,i,n){var r,s,o;if(i!=null?i.then:void 0){return this.D_piece(t,e,i,n)}s=i.content,r=i.can_componentize;o=this.saveInfo();this.P.push(this.loadPartAttrs(e));s=this.handleIt(s);this.restoreInfo(o);return s};n.prototype.D_piece=function(t,e,i,n){var r,s,o;o="P";this.nest_up(o+t);s=this.saveInfo();r=i.then(function(i){return function(r){var l;try{if(r!=null?r.then:void 0){BLOWUP()}i.restoreInfo(s);l=i.piece_handle(t,e,r,n);return l}finally{i.nest_dn(o+t)}}}(this),function(i){return function(n){console.error("D_piece",n);i.nest_dn(o+t+" IN-ERROR");return typeof i._Err==="function"?i._Err("tag","page/part",e,n):void 0;throw n}}(this));return r};n.prototype.T_if_true=function(t,e){if(this.N[t.name]){return this.handleIt(e())}else{return""}};n.prototype.T_if_false=function(t,e){if(this.N[t.name]){return""}else{return this.handleIt(e)}};n.prototype.T_if=function(t,e){var i,n,s,o,l;n=false;i=false;if("val"in t){if("eq"in t){if(t.val===t.eq){i=true}}else if("ne"in t){if(t.val!==t.ne){i=true}}else if("gt"in t){if(t.val>t.gt){i=true}}else if("in_list"in t){if(s=t.val,r.call(t.in_list.split(","),s)>=0){i=true}}else if("not_in_list"in t){if(o=t.val,r.call(t.not_in_list.split(","),o)<0){i=true}}else{n=true}}else if("set"in t){i=t.set?true:false}else if("not_set"in t){i=t.not_set?false:true}else if("table_is_empty"in t){l=this._accessModelTable(t.table_is_empty,false);if(!l.length){i=true}}else if("table_is_not_empty"in t){l=this._accessModelTable(t.table_is_not_empty,false);if(l.length){i=true}}else{n=true}if(n){console.log("ISSUE T_if",t)}if("name"in t){this.N[t.name]=i}if(i&&e){return this.handleIt(e)}else{return""}};n.prototype._accessModelTable=function(t,e){var i,n,r,s,o,l;n=t.split("/"),i=n[0],r=n[1];if(i in this.R){l=this.R[i][r];o={p:i}}else{l=E[i](r);o={m:i}}if(e===false){return l}s=e!=null?e:r;if(l.length===0){return[l,s]}o.o=r;this.I[s]=o;return[l,s]};n.prototype.T_foreach=function(t,e){var i,n,r,s,o,l,a,u,f;o=this._accessModelTable(t.table,t.alias),f=o[0],a=o[1];if(f.length===0){return""}l=[];s="limit"in t?Number(t.limit)-1:f.length;for(i=n=0,r=f.length;n<r;i=++n){u=f[i];u._={count:i,first:i===0,last:i===s-1,"break":false};this.R[a]=u;this.I[a].c=i;l.push(this.handleIt(e))}delete this.I[a];delete this.R[a];return l};n.prototype.T_fist=function(t,e){var i,n,r,s,o,l,a,u,h,p,c,_,d,m,g,v,y,I,R,w;E.log(f,t,e);r=E.fistDef[t.fist];l=(u=r.event)!=null?u:"Fist";R=t.fist+(((h=t.row)!=null?h.length:void 0)?":"+t.row:"");I=(p=(c=t.via)!=null?c:r.via)!=null?p:"Control";o="__Fist";_=this._accessModelTable(l+"/"+R,o),w=_[0],y=_[1];E.log(f,"tbl,rh_alias (master)",w,y);this.R[y]=w[0];this.I[y].c=0;v=y;n=e?e:(a=(d=(m=t.part)!=null?m:r.part)!=null?d:"fist_default",t.part!=null?t.part:t.part=(g=r.part)!=null?g:"fist_default",function(e){return function(){return e.kids([["part",E.merge({part:a},e.loadPartAttrs(t,true))]])}}(this));s={table:o+"/"+I};if(t.alias!=null){s.alias=t.alias}i=this.T_foreach(s,n);delete this.R[v];delete this.I[v];return i};n.prototype.ex=function(t,e,i){var n,r,s,o,l,a,u,h,p,c,_,d;n=t.attributes;_=[];for(l=o=0,p=n.length;0<=p?o<p:o>p;l=0<=p?++o:--o){if(!("data-ex-"===n[l].name.slice(0,8))){continue}c=n[l].name.split("-"),r=c[0],s=c[1],a=c[2],u=c[3],h=c[4];d=n[l].value;E.log(f,n[l].name,d,u,h);_.push(E["ex$"+a](t,e,i,d,u,h))}return _};return n}(E.ModelJS);E.Model.View$Base=t}).call(this);
/*Base/Model/Wist.coffee*/(function(){"use strict";var t,i=function(t,i){for(var r in i){if(o.call(i,r))t[r]=i[r]}function n(){this.constructor=t}n.prototype=i.prototype;t.prototype=new n;t.__super__=i.prototype;return t},o={}.hasOwnProperty;t=function(t){i(o,t);function o(t,i){o.__super__.constructor.call(this,t,i);this.wist={}}o.prototype.loadTable=function(t){E.log(f);return this.Table[t]=this._getWist(t).table};o.prototype._getWist=function(t){var i,o,r,n;if(!(t in this.wist)){i=E.wistDef[t];n=[];for(o in i){r=i[o];r.token=String(o);n.push(r)}this.wist[t]={hash:i,table:n}}return this.wist[t]};return o}(E.ModelJS);E.Model.Wist$Base=t}).call(this);
/*Base/Extra/dataAction.coffee*/(function(){"use strict";var t,i=[].indexOf||function(t){for(var i=0,n=this.length;i<n;i++){if(i in this&&this[i]===t)return i}return-1};t=function(t,i,n){var e,r,c,l,a,s,u,o,v,h,p,k,g;if(typeof(r=E.option).activity==="function"){r.activity(t)}e=i.split(",");c=true;h=false;for(a=0,o=e.length;a<o;a++){v=e[a];p=v.split(":"),g=p[0],k=p[1],l=p[2],u=p[3],s=p[4];if(!k){k=g;g="click"}E.log(f,"check",g,t,g===t?"YES":"NO");if(g==="event"){E.event(k,t,l,u,s,n)}if(c&&g===t){if(g==="click"||g==="rclick"){h=true}c=false;E.action(k,n)}}return h};E.Extra.dataAction$Base=t;E.event=function(t,n,e,f,r,c){var l,a;if(r!=="all"){l=r.split("-");if(i.call(l,n)<0){return}}if(t==="Fist"){t=(a=E.fistDef[e].event)!=null?a:t}return E[t]().event(t,n,e,f,c)}}).call(this);
/*Base/Extra/LoadStrategy.coffee*/(function(){"use strict";var t;t=function(){function t(t){var e;this.reverse_packages=function(){var r,o,a;a=[];for(e=r=o=t.length-1;o<=0?r<=0:r>=0;e=o<=0?++r:--r){a.push(t[e])}return a}()}t.prototype.getArtifact=function(t,e){var r,o,a,n,i,s,u,f;f=false;n=this.reverse_packages;for(r=0,o=n.length;r<o;r++){a=n[r];f=(i=(s=E["view$"+a])!=null?(u=s[e])!=null?u[t]:void 0:void 0)!=null?i:false;if(f!==false){break}}if(f===false){console.log("NO FILE FOUND! "+t)}return f};t.prototype.D_loadAsync=function(){return Promise.resolve()};t.prototype.d_layout=function(t){return this.getArtifact(t,"Layout")};t.prototype.d_page=function(t){return this.getArtifact(t,"Page")};t.prototype.d_part=function(t){return this.getArtifact(t,"Part")};return t}();E.Extra.LoadStrategy$Base=t;E.opt({loader:"LoadStrategy$Base"})}).call(this);
/*Base/Extra/RenderStrategy.coffee*/(function(){"use strict";var t,e,a,r=function(t,e){return function(){return t.apply(e,arguments)}};t=13;e=27;a=function(){function a(){this.m_redraw=r(this.m_redraw,this);this.onPopState=r(this.onPopState,this);this.handleEvent=r(this.handleEvent,this);var t,e,a;this.very_first=true;this.was_popped=false;this.was_modal=false;this.touchEndIsClick=false;this.touchBoundary=10;this.last_path="not_set";this.unloadMsgs={};this.baseUrl=window.document.location.pathname;this.baseId="epic-new-page";this.modalId="epic-new-modal";t=document.createElement("div");t.id=this.baseId;document.body.appendChild(t);e=document.createElement("div");e.id=this.modalId;document.body.appendChild(e);setTimeout(function(t){return function(){return t.onPopState(true)}}(this),0);window.onpopstate=this.onPopState;this.redraw_guard=0;a=m.redraw.strategy;m.redraw=this.m_redraw;m.redraw.strategy=a;this.init();true}a.prototype.handleEvent=function(a){var r,i,n,s,o,u,h,d,l,c,p,w,m,g,_,y,v,b,k,S,I,R;E.log(f,"top",this.redraw_guard,(a!=null?a:window.event).type);if(a==null){a=window.event}k=a.type;if(k==="input"){k="change"}if(k==="mousedown"){if(a.which===1||a.button===1){k="click"}else if(a.which===3||a.button===2){k="rclick"}else{return}}if(k==="keyup"&&a.keyCode===9){return}switch(k){case"keyup":switch(a.keyCode){case t:k="enter";break;case e:k="escape"}break;case"touchstart":b=event.targetTouches[0];this.touchEndIsClick=[b.pageX,b.pageY];return true;case"touchmove":if(this.touchEndIsClick!==false){m=this.touchEndIsClick,I=m[0],R=m[1];b=event.targetTouches[0];if(Math.abs(b.pageX-I)>this.touchBoundary||Math.abs(b.pageY-R)>this.touchBoundary){this.touchEndIsClick=false}}return true;case"touchend":if(this.touchEndIsClick!==false){k="click"}this.touchEndIsClick=false}v=a.target;if(v===window){return false}while(v.tagName!=="BODY"&&!(i=v.getAttribute("data-e-action"))){v=v.parentElement}E.option.event(k,a,v,i);if(!i){return false}n={};r=v.attributes;for(u=o=0,g=r.length;0<=g?o<g:o>g;u=0<=g?++o:--o){if(!("data-e-"===r[u].name.slice(0,7))){continue}if("action"===(l=r[u].name.slice(7))){continue}n[l]=r[u].value}S=v.value;if(v.type==="checkbox"&&v.checked===false){S=false}s=v.files;E.log(f,"event",{type:k,data_action:i,data_params:n,val:S,files:s},v);n.val=S;n._files=s;_=["touches","changedTouches","targetTouches"];for(h=0,d=_.length;h<d;h++){l=_[h];if(l in a){n[l]=a[l]}}c=v.getAttribute("data-params");if(c){y=JSON.parse(c);for(l in y){w=y[l];n[l]=w}}p=E.Extra[E.option.dataAction](k,i,n);if(p){a.preventDefault()}return false};a.prototype.init=function(){var t,e,a,r,i;a=["mousedown","dblclick","keyup","blur","focus","change","input","touchstart","touchmove","touchend"];i=[];for(e=0,r=a.length;e<r;e++){t=a[e];i.push(document.body.addEventListener(t,this.handleEvent,true))}return i};a.prototype.UnloadMessage=function(t,e){var a,r,i;if(e){this.unloadMsgs[t]=e}else{delete this.unloadMsgs[t]}a=function(){var t,e;t=this.unloadMsgs;e=[];for(r in t){i=t[r];e.push(i)}return e}.call(this);a=a.length?a.join("\n"):null;return window.onbeforeunload=function(){return a}};a.prototype.onPopState=function(t){E.log(f,{was_popped:this.was_popped,very_first:this.very_first},true,{state:t===true?"X":t.state});if(t===true||!t.state){if(this.was_popped||!this.very_first){E.action("browser_rehash",{hash:location.hash.substr(1)});return}}this.was_popped=true;if(this.very_first){E.action("browser_hash",{hash:location.hash.substr(1)})}else{if(t.state){E.setModelState(t.state)}m.startComputation();m.endComputation();E.action("browser_navhash",{hash:location.hash.substr(1)})}};a.prototype.m_redraw=function(){this.redraw_guard++;if(this.redraw_guard!==1){E.log(f,"GUARD REDRAW",this.redraw_guard);return}return E.View().run().then(function(t){return function(e){var a,r;r=e[0],a=e[1];E.log(f,"DEFER-R","RESULTS: modal, content",t.redraw_guard,r,a);t.render(r,a);t.redraw_guard--;if(t.redraw_guard!==0){t.redraw_guard=0;return setTimeout(function(){return t.m_redraw()},16)}}}(this)).then(null,function(t){return function(t){return console.error("RenderStrategy$Base m_redraw",t)}}(this))};a.prototype.render=function(t,e){var a;E.log(f,"START RENDER",start,t);if(t){m.render(a=document.getElementById(this.modalId),e)}else{if(this.was_modal){m.render(document.getElementById(this.modalId),[])}m.render(a=document.getElementById(this.baseId),m("div",{},e))}E.log(f,"END RENDER",(new Date).getTime()-start);if(!t){this.handleRenderState()}this.was_modal=t;this.was_popped=false;this.very_first=false};a.prototype.handleRenderState=function(){var t,e,a,r,i,n,s,o,u;s=E.App().getStepPath();u=s.join("/");r=u===this.last_path?"replace":true;E.log(f,{vf:this.very_first,wp:this.was_popped});if(!r){return}a="";n=false;o=E.appFindAttr(s[0],s[1],s[2],"route");if(E.type_oau(o)==="O"&&"model"in o){n=E[o.model]().route(o)}if(typeof o==="string"){n=o}if(n!==false){a=n}i=E.getModelState();if(window.location.protocol!=="file:"){if(this.very_first||r==="replace"){if(typeof(t=window.history).replaceState==="function"){t.replaceState(i,a,"#"+a)}}else if(!this.was_popped&&r===true){if(typeof(e=window.history).pushState==="function"){e.pushState(i,a,"#"+a)}window.document.title=a}}this.last_path=u};return a}();E.Extra.RenderStrategy$Base=a}).call(this);
/*Base/Extra/RestAPI.coffee*/(function(){"use strict";var t;t=function(){function t(t){var e,o,r,n,s;this.opts={port:"",prefix:"",version:"",proto:"//",app_headers:{}};for(e in t){n=t[e];this.opts[e]=n}o=String(this.opts.port);if(o.length){o=":"+o}if(this.opts.prefix.length){r="/"+this.opts.prefix}if(this.opts.version.length){s="/"+this.opts.version}this.route_prefix=""+this.opts.proto+this.opts.host+(o!=null?o:"")+(r!=null?r:"")+(s!=null?s:"")+"/";this.SetToken(false)}t.prototype.GetPrefix=function(){return this.route_prefix};t.prototype.GetToken=function(){return this.token};t.prototype.SetToken=function(t){this.token=t};t.prototype.D_Request=function(t,e,o,r){var n,s,u;n=E.merge({},this.opts.app_headers,r!=null?r:{});u={code:false,text:false,ok:false};s=new Promise(function(r){return function(s,i){var p,a,f,h;h=new XMLHttpRequest;h.onloadend=function(t){var e,o;u.code=h.status;u.text=h.statusText;u.xhr=h;if(h.status===200){u.ok=true}if(!h.responseText.length){u.text="NetworkError";o='{"error":"NETWORK_ERROR"}'}else{o=h.responseText}e=JSON.parse(o);return s({status:u,data:e})};h.open(t,r.route_prefix+e);for(a in n){f=n[a];h.setRequestHeader(a,f)}p=new FormData;for(a in o){f=o[a];p.append(a,f)}return h.send(p)}}(this));return s.then(function(t){console.log(f,t);return t})};t.prototype.D_Get=function(t,e){return this.D_RequestAuth("GET",t,e)};t.prototype.D_Post=function(t,e){return this.D_RequestAuth("POST",t,e)};t.prototype.D_Del=function(t,e){return this.D_RequestAuth("DEL",t,e)};t.prototype.D_Put=function(t,e){return this.D_RequestAuth("PUT",t,e)};t.prototype.D_RequestAuth=function(t,e,o,r){var n,s;s=this.GetToken();if(s===false){setTimeout(function(){return E.action("Request.no_token")},0);return Promise.resolve({status:{code:401,text:"NO_TOKEN",ok:false},data:{error:"TOKEN"}})}n=E.merge({},this.opts.app_headers,r!=null?r:{});n.Authorization=s.token_type+" "+s.access_token;return this.D_Request(t,e,o,n).then(function(t){return function(t){if(t.status.code===401){setTimeout(function(){return E.action("Request.bad_token")},0);return{status:{code:401,text:"BAD_TOKEN",ok:false},data:{error:"TOKEN"}}}return t}}(this))};return t}();E.Extra.RestAPI$Base=t}).call(this);
E.view$Base={
Layout: {
"default":{preloaded:1,can_componentize:false,defer:0,content:function(){return oE.kids([['page',{}]])}}},
Page: {
"default":{preloaded:1,can_componentize:true,defer:0,content:function(){return [{tag:'b',attrs:{},children:['A Base Page']}]}}},
Part: {
}};

